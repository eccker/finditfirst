var CryptoJS=CryptoJS||function(e,g){var a={},b=a.lib={},j=b.Base=function(){function n(){}return{extend:function(p){n.prototype=this;var o=new n;if(p){o.mixIn(p)}if(!o.hasOwnProperty("init")){o.init=function(){o.$super.init.apply(this,arguments)}}o.init.prototype=o;o.$super=this;return o},create:function(){var o=this.extend();o.init.apply(o,arguments);return o},init:function(){},mixIn:function(p){for(var o in p){if(p.hasOwnProperty(o)){this[o]=p[o]}}if(p.hasOwnProperty("toString")){this.toString=p.toString}},clone:function(){return this.init.prototype.extend(this)}}}(),l=b.WordArray=j.extend({init:function(o,n){o=this.words=o||[];if(n!=g){this.sigBytes=n}else{this.sigBytes=4*o.length}},toString:function(n){return(n||h).stringify(this)},concat:function(t){var q=this.words,p=t.words,n=this.sigBytes,s=t.sigBytes;this.clamp();if(n%4){for(var r=0,o;r<s;r++){o=255&p[r>>>2]>>>24-8*(r%4);q[n+r>>>2]|=o<<24-8*((n+r)%4)}}else{for(var r=0;r<s;r+=4){q[n+r>>>2]=p[r>>>2]}}this.sigBytes+=s;return this},clamp:function(){var o=this.words,n=this.sigBytes;o[n>>>2]&=4294967295<<32-8*(n%4);o.length=e.ceil(n/4)},clone:function(){var n=j.clone.call(this);n.words=this.words.slice(0);return n},random:function(p){for(var o=[],n=0;n<p;n+=4){o.push(0|4294967296*e.random())}return new l.init(o,p)}}),m=a.enc={},h=m.Hex={stringify:function(p){for(var r=p.words,o=p.sigBytes,q=[],n=0,s;n<o;n++){s=255&r[n>>>2]>>>24-8*(n%4);q.push((s>>>4).toString(16));q.push((15&s).toString(16))}return q.join("")},parse:function(p){for(var n=p.length,q=[],o=0;o<n;o+=2){q[o>>>3]|=parseInt(p.substr(o,2),16)<<24-4*(o%8)}return new l.init(q,n/2)}},d=m.Latin1={stringify:function(q){for(var r=q.words,p=q.sigBytes,n=[],o=0,s;o<p;o++){s=255&r[o>>>2]>>>24-8*(o%4);n.push(String.fromCharCode(s))}return n.join("")},parse:function(p){for(var n=p.length,q=[],o=0;o<n;o++){q[o>>>2]|=(255&p.charCodeAt(o))<<24-8*(o%4)}return new l.init(q,n)}},c=m.Utf8={stringify:function(n){try{return decodeURIComponent(escape(d.stringify(n)))}catch(o){throw new Error("Malformed UTF-8 data")}},parse:function(n){return d.parse(unescape(encodeURIComponent(n)))}},i=b.BufferedBlockAlgorithm=j.extend({reset:function(){this._data=new l.init;this._nDataBytes=0},_append:function(n){if("string"==typeof n){n=c.parse(n)}this._data.concat(n);this._nDataBytes+=n.sigBytes},_process:function(w){var q=this._data,x=q.words,n=q.sigBytes,t=this.blockSize,u=n/(4*t);if(w){u=e.ceil(u)}else{u=e.max((0|u)-this._minBufferSize,0)}var s=u*t,r=e.min(4*s,n);if(s){for(var p=0;p<s;p+=t){this._doProcessBlock(x,p)}var o=x.splice(0,s);q.sigBytes-=r}return new l.init(o,r)},clone:function(){var n=j.clone.call(this);n._data=this._data.clone();return n},_minBufferSize:0}),f=b.Hasher=i.extend({cfg:j.extend(),init:function(n){this.cfg=this.cfg.extend(n);this.reset()},reset:function(){i.reset.call(this);this._doReset()},update:function(n){this._append(n);this._process();return this},finalize:function(n){if(n){this._append(n)}var o=this._doFinalize();return o},blockSize:512/32,_createHelper:function(n){return function(p,o){return new n.init(o).finalize(p)}},_createHmacHelper:function(n){return function(p,o){return new k.HMAC.init(n,o).finalize(p)}}}),k=a.algo={};return a}(Math);(function(g){var a=CryptoJS,f=a.lib,e=f.Base,h=f.WordArray,a=a.x64={};a.Word=e.extend({init:function(b,c){this.high=b;this.low=c}});a.WordArray=e.extend({init:function(b,c){b=this.words=b||[];this.sigBytes=c!=g?c:8*b.length},toX32:function(){for(var b=this.words,c=b.length,a=[],d=0,e;d<c;d++){e=b[d];a.push(e.high);a.push(e.low)}return h.create(a,this.sigBytes)},clone:function(){for(var b=e.clone.call(this),c=b.words=this.words.slice(0),a=c.length,d=0;d<a;d++)c[d]=c[d].clone();return b}})})();CryptoJS.lib.Cipher||function(u){var g=CryptoJS,f=g.lib,k=f.Base,l=f.WordArray,q=f.BufferedBlockAlgorithm,r=g.enc.Base64,v=g.algo.EvpKDF,n=f.Cipher=q.extend({cfg:k.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?s:j).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?s:j).decrypt(a,b,c,d)}}}});f.StreamCipher=n.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var m=g.mode={},t=function(a,b,c){var d=this._iv;d?this._iv=u:d=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=d[e]},h=(f.BlockCipherMode=k.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();h.Encryptor=h.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;t.call(this,a,b,d);c.encryptBlock(a,b);this._prevBlock=a.slice(b,b+d)}});h.Decryptor=h.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b);t.call(this,a,b,d);this._prevBlock=e}});m=m.CBC=h;h=(g.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],f=0;f<c;f+=4)e.push(d);c=l.create(e,c);a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}};f.BlockCipher=n.extend({cfg:n.cfg.extend({mode:m,padding:h}),reset:function(){n.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var p=f.CipherParams=k.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),m=(g.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?l.create([1398893684,1701076831]).concat(a).concat(b):b).toString(r)},parse:function(a){a=r.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=l.create(b.slice(2,4));b.splice(0,4);a.sigBytes-=16}return p.create({ciphertext:a,salt:c})}},j=f.SerializableCipher=k.extend({cfg:k.extend({format:m}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);b=e.finalize(b);e=e.cfg;return p.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),g=(g.kdf={}).OpenSSL={execute:function(a,b,c,d){d||(d=l.random(8));a=v.create({keySize:b+c}).compute(a,d);c=l.create(a.words.slice(b),4*c);a.sigBytes=4*b;return p.create({key:a,iv:c,salt:d})}},s=f.PasswordBasedCipher=j.extend({cfg:j.cfg.extend({kdf:g}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,a.keySize,a.ivSize);d.iv=c.iv;a=j.encrypt.call(this,a,b,c.key,d);a.mixIn(c);return a},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);d.iv=c.iv;return j.decrypt.call(this,a,b,c.key,d)}})}();(function(){for(var q=CryptoJS,x=q.lib.BlockCipher,r=q.algo,j=[],y=[],z=[],A=[],B=[],C=[],s=[],u=[],v=[],w=[],g=[],k=0;256>k;k++)g[k]=128>k?k<<1:283^k<<1;for(var n=0,l=0,k=0;256>k;k++){var f=l^l<<1^l<<2^l<<3^l<<4,f=99^(f>>>8^255&f);j[n]=f;y[f]=n;var t=g[n],D=g[t],E=g[D],b=257*g[f]^16843008*f;z[n]=b<<24|b>>>8;A[n]=b<<16|b>>>16;B[n]=b<<8|b>>>24;C[n]=b;b=16843009*E^65537*D^257*t^16843008*n;s[f]=b<<24|b>>>8;u[f]=b<<16|b>>>16;v[f]=b<<8|b>>>24;w[f]=b;n?(n=t^g[g[g[E^t]]],l^=g[g[l]]):n=l=1}var F=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=x.extend({_doReset:function(){for(var c=this._key,e=c.words,a=c.sigBytes/4,c=4*((this._nRounds=a+6)+1),b=this._keySchedule=[],h=0;h<c;h++)if(h<a)b[h]=e[h];else{var d=b[h-1];h%a?6<a&&4==h%a&&(d=j[d>>>24]<<24|j[255&d>>>16]<<16|j[255&d>>>8]<<8|j[255&d]):(d=d<<8|d>>>24,d=j[d>>>24]<<24|j[255&d>>>16]<<16|j[255&d>>>8]<<8|j[255&d],d^=F[0|h/a]<<24);b[h]=b[h-a]^d}e=this._invKeySchedule=[];for(a=0;a<c;a++)h=c-a,d=a%4?b[h]:b[h-4],e[a]=4>a||4>=h?d:s[j[d>>>24]]^u[j[255&d>>>16]]^v[j[255&d>>>8]]^w[j[255&d]]},encryptBlock:function(c,e){this._doCryptBlock(c,e,this._keySchedule,z,A,B,C,j)},decryptBlock:function(c,e){var a=c[e+1];c[e+1]=c[e+3];c[e+3]=a;this._doCryptBlock(c,e,this._invKeySchedule,s,u,v,w,y);a=c[e+1];c[e+1]=c[e+3];c[e+3]=a},_doCryptBlock:function(c,e,a,b,h,d,j,m){for(var n=this._nRounds,f=c[e]^a[0],g=c[e+1]^a[1],k=c[e+2]^a[2],p=c[e+3]^a[3],l=4,t=1;t<n;t++)var q=b[f>>>24]^h[255&g>>>16]^d[255&k>>>8]^j[255&p]^a[l++],r=b[g>>>24]^h[255&k>>>16]^d[255&p>>>8]^j[255&f]^a[l++],s=b[k>>>24]^h[255&p>>>16]^d[255&f>>>8]^j[255&g]^a[l++],p=b[p>>>24]^h[255&f>>>16]^d[255&g>>>8]^j[255&k]^a[l++],f=q,g=r,k=s;q=(m[f>>>24]<<24|m[255&g>>>16]<<16|m[255&k>>>8]<<8|m[255&p])^a[l++];r=(m[g>>>24]<<24|m[255&k>>>16]<<16|m[255&p>>>8]<<8|m[255&f])^a[l++];s=(m[k>>>24]<<24|m[255&p>>>16]<<16|m[255&f>>>8]<<8|m[255&g])^a[l++];p=(m[p>>>24]<<24|m[255&f>>>16]<<16|m[255&g>>>8]<<8|m[255&k])^a[l++];c[e]=q;c[e+1]=r;c[e+2]=s;c[e+3]=p},keySize:8});q.AES=x._createHelper(r)})();(function(){function j(b,c){var a=(this._lBlock>>>b^this._rBlock)&c;this._rBlock^=a;this._lBlock^=a<<b}function l(b,c){var a=(this._rBlock>>>b^this._lBlock)&c;this._lBlock^=a;this._rBlock^=a<<b}var h=CryptoJS,e=h.lib,n=e.WordArray,e=e.BlockCipher,g=h.algo,q=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],p=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],r=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],s=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],t=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],m=g.DES=e.extend({_doReset:function(){for(var b=this._key.words,c=[],a=0,f;56>a;a++){f=q[a]-1;c[a]=1&b[f>>>5]>>>31-f%32}b=this._subKeys=[];for(f=0;16>f;f++){for(var d=b[f]=[],e=r[f],a=0;24>a;a++)d[0|a/6]|=c[(p[a]-1+e)%28]<<31-a%6,d[4+(0|a/6)]|=c[28+(p[a+24]-1+e)%28]<<31-a%6;d[0]=d[0]<<1|d[0]>>>31;for(a=1;7>a;a++)d[a]>>>=4*(a-1)+3;d[7]=d[7]<<5|d[7]>>>27}c=this._invSubKeys=[];for(a=0;16>a;a++)c[a]=b[15-a]},encryptBlock:function(b,c){this._doCryptBlock(b,c,this._subKeys)},decryptBlock:function(b,c){this._doCryptBlock(b,c,this._invSubKeys)},_doCryptBlock:function(b,c,a){this._lBlock=b[c];this._rBlock=b[c+1];j.call(this,4,252645135);j.call(this,16,65535);l.call(this,2,858993459);l.call(this,8,16711935);j.call(this,1,1431655765);for(var f=0;16>f;f++){for(var d=a[f],e=this._lBlock,h=this._rBlock,g=0,k=0;8>k;k++)g|=s[k][((h^d[k])&t[k])>>>0];this._lBlock=h;this._rBlock=e^g}a=this._lBlock;this._lBlock=this._rBlock;this._rBlock=a;j.call(this,1,1431655765);l.call(this,8,16711935);l.call(this,2,858993459);j.call(this,16,65535);j.call(this,4,252645135);b[c]=this._lBlock;b[c+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});h.DES=e._createHelper(m);g=g.TripleDES=e.extend({_doReset:function(){var b=this._key.words;this._des1=m.createEncryptor(n.create(b.slice(0,2)));this._des2=m.createEncryptor(n.create(b.slice(2,4)));this._des3=m.createEncryptor(n.create(b.slice(4,6)))},encryptBlock:function(b,c){this._des1.encryptBlock(b,c);this._des2.decryptBlock(b,c);this._des3.encryptBlock(b,c)},decryptBlock:function(b,c){this._des3.decryptBlock(b,c);this._des2.encryptBlock(b,c);this._des1.decryptBlock(b,c)},keySize:6,ivSize:2,blockSize:2});h.TripleDES=e._createHelper(g)})();(function(){var h=CryptoJS,j=h.lib.WordArray;h.enc.Base64={stringify:function(b){var e=b.words,f=b.sigBytes,c=this._map;b.clamp();b=[];for(var a=0;a<f;a+=3)for(var d=(255&e[a>>>2]>>>24-8*(a%4))<<16|(255&e[a+1>>>2]>>>24-8*((a+1)%4))<<8|255&e[a+2>>>2]>>>24-8*((a+2)%4),g=0;4>g&&a+.75*g<f;g++)b.push(c.charAt(63&d>>>6*(3-g)));if(e=c.charAt(64))for(;b.length%4;)b.push(e);return b.join("")},parse:function(b){var e=b.length,f=this._map,c=f.charAt(64);c&&(c=b.indexOf(c),-1!=c&&(e=c));for(var c=[],a=0,d=0;d<e;d++)if(d%4){var g=f.indexOf(b.charAt(d-1))<<2*(d%4),h=f.indexOf(b.charAt(d))>>>6-2*(d%4);c[a>>>2]|=(g|h)<<24-8*(a%4);a++}return j.create(c,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(E){function h(a,f,g,j,p,h,k){a=a+(f&g|~f&j)+p+k;return(a<<h|a>>>32-h)+f}function k(a,f,g,j,p,h,k){a=a+(f&j|g&~j)+p+k;return(a<<h|a>>>32-h)+f}function l(a,f,g,j,h,k,l){a=a+(f^g^j)+h+l;return(a<<k|a>>>32-k)+f}function n(a,f,g,j,h,k,l){a=a+(g^(f|~j))+h+l;return(a<<k|a>>>32-k)+f}for(var r=CryptoJS,q=r.lib,F=q.WordArray,s=q.Hasher,q=r.algo,a=[],t=0;64>t;t++)a[t]=0|4294967296*E.abs(E.sin(t+1));q=q.MD5=s.extend({_doReset:function(){this._hash=new F.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(m,f){for(var g=0;16>g;g++){var j=f+g,p=m[j];m[j]=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8)}var g=this._hash.words,j=m[f+0],p=m[f+1],q=m[f+2],r=m[f+3],s=m[f+4],t=m[f+5],u=m[f+6],v=m[f+7],w=m[f+8],x=m[f+9],y=m[f+10],z=m[f+11],A=m[f+12],B=m[f+13],C=m[f+14],D=m[f+15],b=g[0],c=g[1],d=g[2],e=g[3],b=h(b,c,d,e,j,7,a[0]),e=h(e,b,c,d,p,12,a[1]),d=h(d,e,b,c,q,17,a[2]),c=h(c,d,e,b,r,22,a[3]),b=h(b,c,d,e,s,7,a[4]),e=h(e,b,c,d,t,12,a[5]),d=h(d,e,b,c,u,17,a[6]),c=h(c,d,e,b,v,22,a[7]),b=h(b,c,d,e,w,7,a[8]),e=h(e,b,c,d,x,12,a[9]),d=h(d,e,b,c,y,17,a[10]),c=h(c,d,e,b,z,22,a[11]),b=h(b,c,d,e,A,7,a[12]),e=h(e,b,c,d,B,12,a[13]),d=h(d,e,b,c,C,17,a[14]),c=h(c,d,e,b,D,22,a[15]),b=k(b,c,d,e,p,5,a[16]),e=k(e,b,c,d,u,9,a[17]),d=k(d,e,b,c,z,14,a[18]),c=k(c,d,e,b,j,20,a[19]),b=k(b,c,d,e,t,5,a[20]),e=k(e,b,c,d,y,9,a[21]),d=k(d,e,b,c,D,14,a[22]),c=k(c,d,e,b,s,20,a[23]),b=k(b,c,d,e,x,5,a[24]),e=k(e,b,c,d,C,9,a[25]),d=k(d,e,b,c,r,14,a[26]),c=k(c,d,e,b,w,20,a[27]),b=k(b,c,d,e,B,5,a[28]),e=k(e,b,c,d,q,9,a[29]),d=k(d,e,b,c,v,14,a[30]),c=k(c,d,e,b,A,20,a[31]),b=l(b,c,d,e,t,4,a[32]),e=l(e,b,c,d,w,11,a[33]),d=l(d,e,b,c,z,16,a[34]),c=l(c,d,e,b,C,23,a[35]),b=l(b,c,d,e,p,4,a[36]),e=l(e,b,c,d,s,11,a[37]),d=l(d,e,b,c,v,16,a[38]),c=l(c,d,e,b,y,23,a[39]),b=l(b,c,d,e,B,4,a[40]),e=l(e,b,c,d,j,11,a[41]),d=l(d,e,b,c,r,16,a[42]),c=l(c,d,e,b,u,23,a[43]),b=l(b,c,d,e,x,4,a[44]),e=l(e,b,c,d,A,11,a[45]),d=l(d,e,b,c,D,16,a[46]),c=l(c,d,e,b,q,23,a[47]),b=n(b,c,d,e,j,6,a[48]),e=n(e,b,c,d,v,10,a[49]),d=n(d,e,b,c,C,15,a[50]),c=n(c,d,e,b,t,21,a[51]),b=n(b,c,d,e,A,6,a[52]),e=n(e,b,c,d,r,10,a[53]),d=n(d,e,b,c,y,15,a[54]),c=n(c,d,e,b,p,21,a[55]),b=n(b,c,d,e,w,6,a[56]),e=n(e,b,c,d,D,10,a[57]),d=n(d,e,b,c,u,15,a[58]),c=n(c,d,e,b,B,21,a[59]),b=n(b,c,d,e,s,6,a[60]),e=n(e,b,c,d,z,10,a[61]),d=n(d,e,b,c,q,15,a[62]),c=n(c,d,e,b,x,21,a[63]);g[0]=0|g[0]+b;g[1]=0|g[1]+c;g[2]=0|g[2]+d;g[3]=0|g[3]+e},_doFinalize:function(){var a=this._data,f=a.words,g=8*this._nDataBytes,j=8*a.sigBytes;f[j>>>5]|=128<<24-j%32;var h=E.floor(g/4294967296);f[(j+64>>>9<<4)+15]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8);f[(j+64>>>9<<4)+14]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8);a.sigBytes=4*(f.length+1);this._process();a=this._hash;f=a.words;for(g=0;4>g;g++)j=f[g],f[g]=16711935&(j<<8|j>>>24)|4278255360&(j<<24|j>>>8);return a},clone:function(){var a=s.clone.call(this);a._hash=this._hash.clone();return a}});r.MD5=s._createHelper(q);r.HmacMD5=s._createHmacHelper(q)})(Math);(function(){var k=CryptoJS,b=k.lib,m=b.WordArray,l=b.Hasher,d=[],b=k.algo.SHA1=l.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(n,p){for(var a=this._hash.words,e=a[0],f=a[1],h=a[2],j=a[3],b=a[4],c=0;80>c;c++){if(16>c)d[c]=0|n[p+c];else{var g=d[c-3]^d[c-8]^d[c-14]^d[c-16];d[c]=g<<1|g>>>31}g=(e<<5|e>>>27)+b+d[c];g=20>c?g+((f&h|~f&j)+1518500249):40>c?g+((f^h^j)+1859775393):60>c?g+((f&h|f&j|h&j)-1894007588):g+((f^h^j)-899497514);b=j;j=h;h=f<<30|f>>>2;f=e;e=g}a[0]=0|a[0]+e;a[1]=0|a[1]+f;a[2]=0|a[2]+h;a[3]=0|a[3]+j;a[4]=0|a[4]+b},_doFinalize:function(){var b=this._data,d=b.words,a=8*this._nDataBytes,e=8*b.sigBytes;d[e>>>5]|=128<<24-e%32;d[(e+64>>>9<<4)+14]=Math.floor(a/4294967296);d[(e+64>>>9<<4)+15]=a;b.sigBytes=4*d.length;this._process();return this._hash},clone:function(){var b=l.clone.call(this);b._hash=this._hash.clone();return b}});k.SHA1=l._createHelper(b);k.HmacSHA1=l._createHmacHelper(b)})();(function(k){for(var g=CryptoJS,h=g.lib,v=h.WordArray,j=h.Hasher,h=g.algo,s=[],t=[],u=function(q){return 0|4294967296*(q-(0|q))},l=2,b=0;64>b;){var d;a:{d=l;for(var w=k.sqrt(d),r=2;r<=w;r++)if(!(d%r)){d=!1;break a}d=!0}d&&(8>b&&(s[b]=u(k.pow(l,.5))),t[b]=u(k.pow(l,1/3)),b++);l++}var n=[],h=h.SHA256=j.extend({_doReset:function(){this._hash=new v.init(s.slice(0))},_doProcessBlock:function(q,h){for(var a=this._hash.words,c=a[0],d=a[1],b=a[2],k=a[3],f=a[4],g=a[5],j=a[6],l=a[7],e=0;64>e;e++){if(16>e)n[e]=0|q[h+e];else{var m=n[e-15],p=n[e-2];n[e]=((m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3)+n[e-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+n[e-16]}m=l+((f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25))+(f&g^~f&j)+t[e]+n[e];p=((c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22))+(c&d^c&b^d&b);l=j;j=g;g=f;f=0|k+m;k=b;b=d;d=c;c=0|m+p}a[0]=0|a[0]+c;a[1]=0|a[1]+d;a[2]=0|a[2]+b;a[3]=0|a[3]+k;a[4]=0|a[4]+f;a[5]=0|a[5]+g;a[6]=0|a[6]+j;a[7]=0|a[7]+l},_doFinalize:function(){var d=this._data,b=d.words,a=8*this._nDataBytes,c=8*d.sigBytes;b[c>>>5]|=128<<24-c%32;b[(c+64>>>9<<4)+14]=k.floor(a/4294967296);b[(c+64>>>9<<4)+15]=a;d.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var b=j.clone.call(this);b._hash=this._hash.clone();return b}});g.SHA256=j._createHelper(h);g.HmacSHA256=j._createHmacHelper(h)})(Math);(function(){var b=CryptoJS,d=b.lib.WordArray,a=b.algo,c=a.SHA256,a=a.SHA224=c.extend({_doReset:function(){this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=c._doFinalize.call(this);a.sigBytes-=4;return a}});b.SHA224=c._createHelper(a);b.HmacSHA224=c._createHmacHelper(a)})();(function(){function a(){return d.create.apply(d,arguments)}for(var n=CryptoJS,r=n.lib.Hasher,e=n.x64,d=e.Word,T=e.WordArray,e=n.algo,ea=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],v=[],w=0;80>w;w++)v[w]=a();e=e.SHA512=r.extend({_doReset:function(){this._hash=new T.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])},_doProcessBlock:function(a,d){for(var f=this._hash.words,F=f[0],e=f[1],n=f[2],r=f[3],G=f[4],H=f[5],I=f[6],f=f[7],w=F.high,J=F.low,X=e.high,K=e.low,Y=n.high,L=n.low,Z=r.high,M=r.low,$=G.high,N=G.low,aa=H.high,O=H.low,ba=I.high,P=I.low,ca=f.high,Q=f.low,k=w,g=J,z=X,x=K,A=Y,y=L,U=Z,B=M,l=$,h=N,R=aa,C=O,S=ba,D=P,V=ca,E=Q,m=0,s;80>m;m++){s=v[m];if(16>m)var j=s.high=0|a[d+2*m],b=s.low=0|a[d+2*m+1];else{var j=v[m-15],b=j.high,p=j.low,j=(b>>>1|p<<31)^(b>>>8|p<<24)^b>>>7,p=(p>>>1|b<<31)^(p>>>8|b<<24)^(p>>>7|b<<25),u=v[m-2],b=u.high,c=u.low,u=(b>>>19|c<<13)^(b<<3|c>>>29)^b>>>6,c=(c>>>19|b<<13)^(c<<3|b>>>29)^(c>>>6|b<<26),b=v[m-7],W=b.high,t=v[m-16],q=t.high,t=t.low,b=p+b.low,j=j+W+(b>>>0<p>>>0?1:0),b=b+c,j=j+u+(b>>>0<c>>>0?1:0),b=b+t,j=j+q+(b>>>0<t>>>0?1:0);s.high=j;s.low=b}var W=l&R^~l&S,t=h&C^~h&D,s=k&z^k&A^z&A,T=g&x^g&y^x&y,p=(k>>>28|g<<4)^(k<<30|g>>>2)^(k<<25|g>>>7),u=(g>>>28|k<<4)^(g<<30|k>>>2)^(g<<25|k>>>7),c=ea[m],fa=c.high,da=c.low,c=E+((h>>>14|l<<18)^(h>>>18|l<<14)^(h<<23|l>>>9)),q=V+((l>>>14|h<<18)^(l>>>18|h<<14)^(l<<23|h>>>9))+(c>>>0<E>>>0?1:0),c=c+t,q=q+W+(c>>>0<t>>>0?1:0),c=c+da,q=q+fa+(c>>>0<da>>>0?1:0),c=c+b,q=q+j+(c>>>0<b>>>0?1:0),b=u+T,s=p+s+(b>>>0<u>>>0?1:0),V=S,E=D,S=R,D=C,R=l,C=h,h=0|B+c,l=0|U+q+(h>>>0<B>>>0?1:0),U=A,B=y,A=z,y=x,z=k,x=g,g=0|c+b,k=0|q+s+(g>>>0<c>>>0?1:0)}J=F.low=J+g;F.high=w+k+(J>>>0<g>>>0?1:0);K=e.low=K+x;e.high=X+z+(K>>>0<x>>>0?1:0);L=n.low=L+y;n.high=Y+A+(L>>>0<y>>>0?1:0);M=r.low=M+B;r.high=Z+U+(M>>>0<B>>>0?1:0);N=G.low=N+h;G.high=$+l+(N>>>0<h>>>0?1:0);O=H.low=O+C;H.high=aa+R+(O>>>0<C>>>0?1:0);P=I.low=P+D;I.high=ba+S+(P>>>0<D>>>0?1:0);Q=f.low=Q+E;f.high=ca+V+(Q>>>0<E>>>0?1:0)},_doFinalize:function(){var a=this._data,d=a.words,f=8*this._nDataBytes,e=8*a.sigBytes;d[e>>>5]|=128<<24-e%32;d[(e+128>>>10<<5)+30]=Math.floor(f/4294967296);d[(e+128>>>10<<5)+31]=f;a.sigBytes=4*d.length;this._process();return this._hash.toX32()},clone:function(){var a=r.clone.call(this);a._hash=this._hash.clone();return a},blockSize:32});n.SHA512=r._createHelper(e);n.HmacSHA512=r._createHmacHelper(e)})();(function(){var c=CryptoJS,a=c.x64,b=a.Word,e=a.WordArray,a=c.algo,d=a.SHA512,a=a.SHA384=d.extend({_doReset:function(){this._hash=new e.init([new b.init(3418070365,3238371032),new b.init(1654270250,914150663),new b.init(2438529370,812702999),new b.init(355462360,4144912697),new b.init(1731405415,4290775857),new b.init(2394180231,1750603025),new b.init(3675008525,1694076839),new b.init(1203062813,3204075428)])},_doFinalize:function(){var a=d._doFinalize.call(this);a.sigBytes-=16;return a}});c.SHA384=d._createHelper(a);c.HmacSHA384=d._createHmacHelper(a)})();(function(){var q=CryptoJS,d=q.lib,n=d.WordArray,p=d.Hasher,d=q.algo,x=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),y=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),z=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),A=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),B=n.create([0,1518500249,1859775393,2400959708,2840853838]),C=n.create([1352829926,1548603684,1836072691,2053994217,0]),d=d.RIPEMD160=p.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,v){for(var b=0;16>b;b++){var c=v+b,f=e[c];e[c]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}var c=this._hash.words,f=B.words,d=C.words,n=x.words,q=y.words,p=z.words,w=A.words,t,g,h,j,r,u,k,l,m,s;u=t=c[0];k=g=c[1];l=h=c[2];m=j=c[3];s=r=c[4];for(var a,b=0;80>b;b+=1)a=0|t+e[v+n[b]],a=16>b?a+((g^h^j)+f[0]):32>b?a+((g&h|~g&j)+f[1]):48>b?a+(((g|~h)^j)+f[2]):64>b?a+((g&j|h&~j)+f[3]):a+((g^(h|~j))+f[4]),a|=0,a=a<<p[b]|a>>>32-p[b],a=0|a+r,t=r,r=j,j=h<<10|h>>>22,h=g,g=a,a=0|u+e[v+q[b]],a=16>b?a+((k^(l|~m))+d[0]):32>b?a+((k&m|l&~m)+d[1]):48>b?a+(((k|~l)^m)+d[2]):64>b?a+((k&l|~k&m)+d[3]):a+((k^l^m)+d[4]),a|=0,a=a<<w[b]|a>>>32-w[b],a=0|a+s,u=s,s=m,m=l<<10|l>>>22,l=k,k=a;a=0|c[1]+h+m;c[1]=0|c[2]+j+s;c[2]=0|c[3]+r+u;c[3]=0|c[4]+t+k;c[4]=0|c[0]+g+l;c[0]=a},_doFinalize:function(){var e=this._data,d=e.words,b=8*this._nDataBytes,c=8*e.sigBytes;d[c>>>5]|=128<<24-c%32;d[(c+64>>>9<<4)+14]=16711935&(b<<8|b>>>24)|4278255360&(b<<24|b>>>8);e.sigBytes=4*(d.length+1);this._process();e=this._hash;d=e.words;for(b=0;5>b;b++)c=d[b],d[b]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8);return e},clone:function(){var d=p.clone.call(this);d._hash=this._hash.clone();return d}});q.RIPEMD160=p._createHelper(d);q.HmacRIPEMD160=p._createHmacHelper(d)})(Math);(function(){var c=CryptoJS,k=c.enc.Utf8;c.algo.HMAC=c.lib.Base.extend({init:function(a,b){a=this._hasher=new a.init;"string"==typeof b&&(b=k.parse(b));var c=a.blockSize,e=4*c;b.sigBytes>e&&(b=a.finalize(b));b.clamp();for(var f=this._oKey=b.clone(),g=this._iKey=b.clone(),h=f.words,j=g.words,d=0;d<c;d++)h[d]^=1549556828,j[d]^=909522486;f.sigBytes=g.sigBytes=e;this.reset()},reset:function(){var a=this._hasher;a.reset();a.update(this._iKey)},update:function(a){this._hasher.update(a);return this},finalize:function(a){var b=this._hasher;a=b.finalize(a);b.reset();return b.finalize(this._oKey.clone().concat(a))}})})();(function(){var b=CryptoJS,a=b.lib,d=a.Base,m=a.WordArray,a=b.algo,q=a.HMAC,l=a.PBKDF2=d.extend({cfg:d.extend({keySize:4,hasher:a.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,f=q.create(c.hasher,a),g=m.create(),d=m.create([1]),l=g.words,r=d.words,n=c.keySize,c=c.iterations,h;l.length<n;){h=f.update(b).finalize(d);f.reset();for(var j=h.words,s=j.length,k=h,p=1;p<c;p++){k=f.finalize(k);f.reset();for(var t=k.words,e=0;e<s;e++)j[e]^=t[e]}g.concat(h);r[0]++}g.sigBytes=4*n;return g}});b.PBKDF2=function(a,b,c){return l.create(c).compute(a,b)}})();var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=";function hex2b64(d){var b,e,a="";for(b=0;b+3<=d.length;b+=3){e=parseInt(d.substring(b,b+3),16);a+=b64map.charAt(e>>6)+b64map.charAt(63&e)}if(b+1==d.length){e=parseInt(d.substring(b,b+1),16);a+=b64map.charAt(e<<2)}else{if(b+2==d.length){e=parseInt(d.substring(b,b+2),16);a+=b64map.charAt(e>>2)+b64map.charAt((3&e)<<4)}}if(b64pad){while(0<(3&a.length)){a+=b64pad}}return a}function b64tohex(f){var d="",e,b=0,c,a;for(e=0;e<f.length;++e){if(f.charAt(e)==b64pad){break}a=b64map.indexOf(f.charAt(e));if(0>a){continue}if(0==b){d+=int2char(a>>2);c=3&a;b=1}else{if(1==b){d+=int2char(c<<2|a>>4);c=15&a;b=2}else{if(2==b){d+=int2char(c);d+=int2char(a>>2);c=3&a;b=3}else{d+=int2char(c<<2|a>>4);d+=int2char(15&a);b=0}}}}if(1==b){d+=int2char(c<<2)}return d}function b64toBA(e){var d=b64tohex(e),c,b=[];for(c=0;2*c<d.length;++c){b[c]=parseInt(d.substring(2*c,2*c+2),16)}return b}var dbits,canary=244837814094590,j_lm=15715070==(16777215&canary);function BigInteger(e,d,f){if(null!=e){if("number"==typeof e){this.fromNumber(e,d,f)}else{if(null==d&&"string"!=typeof e){this.fromString(e,256)}else{this.fromString(e,d)}}}}function nbi(){return new BigInteger(null)}function am1(f,a,b,e,h,g){while(0<=--g){var d=a*this[f++]+b[e]+h;h=Math.floor(d/67108864);b[e++]=67108863&d}return h}function am2(f,q,r,e,o,a){var k=32767&q,p=q>>15;while(0<=--a){var d=32767&this[f],g=this[f++]>>15,b=p*d+g*k;d=k*d+((32767&b)<<15)+r[e]+(1073741823&o);o=(d>>>30)+(b>>>15)+p*g+(o>>>30);r[e++]=1073741823&d}return o}function am3(f,q,r,e,o,a){var k=16383&q,p=q>>14;while(0<=--a){var d=16383&this[f],g=this[f++]>>14,b=p*d+g*k;d=k*d+((16383&b)<<14)+r[e]+o;o=(d>>28)+(b>>14)+p*g;r[e++]=268435455&d}return o}if(j_lm&&"Microsoft Internet Explorer"==navigator.appName){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&"Netscape"!=navigator.appName){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=4503599627370496;BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;rr="0".charCodeAt(0);for(vv=0;9>=vv;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;36>vv;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;36>vv;++vv){BI_RC[rr++]=vv}function int2char(a){return BI_RM.charAt(a)}function intAt(b,a){var d=BI_RC[b.charCodeAt(a)];return null==d?-1:d}function bnpCopyTo(b){for(var a=this.t-1;0<=a;--a){b[a]=this[a]}b.t=this.t;b.s=this.s}function bnpFromInt(a){this.t=1;this.s=0>a?-1:0;if(0<a){this[0]=a}else{if(-1>a){this[0]=a+this.DV}else{this.t=0}}}function nbv(a){var b=nbi();b.fromInt(a);return b}function bnpFromString(h,c){var e;if(16==c){e=4}else{if(8==c){e=3}else{if(256==c){e=8}else{if(2==c){e=1}else{if(32==c){e=5}else{if(4==c){e=2}else{this.fromRadix(h,c);return}}}}}}this.t=0;this.s=0;var g=h.length,d=!1,f=0;while(0<=--g){var a=8==e?255&h[g]:intAt(h,g);if(0>a){if("-"==h.charAt(g)){d=!0}continue}d=!1;if(0==f){this[this.t++]=a}else{if(f+e>this.DB){this[this.t-1]|=(a&(1<<this.DB-f)-1)<<f;this[this.t++]=a>>this.DB-f}else{this[this.t-1]|=a<<f}}f+=e;if(f>=this.DB){f-=this.DB}}if(8==e&&0!=(128&h[0])){this.s=-1;if(0<f){this[this.t-1]|=(1<<this.DB-f)-1<<f}}this.clamp();if(d){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var a=this.s&this.DM;while(0<this.t&&this[this.t-1]==a){--this.t}}function bnToString(c){if(0>this.s){return"-"+this.negate().toString(c)}var e;if(16==c){e=4}else{if(8==c){e=3}else{if(2==c){e=1}else{if(32==c){e=5}else{if(4==c){e=2}else{return this.toRadix(c)}}}}}var g=(1<<e)-1,l,a=!1,h="",f=this.t,j=this.DB-f*this.DB%e;if(0<f--){if(j<this.DB&&0<(l=this[f]>>j)){a=!0;h=int2char(l)}while(0<=f){if(j<e){l=(this[f]&(1<<j)-1)<<e-j;l|=this[--f]>>(j+=this.DB-e)}else{l=this[f]>>(j-=e)&g;if(0>=j){j+=this.DB;--f}}if(0<l){a=!0}if(a){h+=int2char(l)}}}return a?h:"0"}function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(b){var d=this.s-b.s;if(0!=d){return d}var c=this.t;d=c-b.t;if(0!=d){return 0>this.s?-d:d}while(0<=--c){if(0!=(d=this[c]-b[c])){return d}}return 0}function nbits(a){var c=1,b;if(0!=(b=a>>>16)){a=b;c+=16}if(0!=(b=a>>8)){a=b;c+=8}if(0!=(b=a>>4)){a=b;c+=4}if(0!=(b=a>>2)){a=b;c+=2}if(0!=(b=a>>1)){a=b;c+=1}return c}function bnBitLength(){if(0>=this.t){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(c,b){var a;for(a=this.t-1;0<=a;--a){b[a+c]=this[a]}for(a=c-1;0<=a;--a){b[a]=0}b.t=this.t+c;b.s=this.s}function bnpDRShiftTo(c,b){for(var a=c;a<this.t;++a){b[a-c]=this[a]}b.t=Math.max(this.t-c,0);b.s=this.s}function bnpLShiftTo(j,e){var b=j%this.DB,a=this.DB-b,f=Math.floor(j/this.DB),h=this.s<<b&this.DM,d;for(d=this.t-1;0<=d;--d){e[d+f+1]=this[d]>>a|h;h=(this[d]&(1<<a)-1)<<b}for(d=f-1;0<=d;--d){e[d]=0}e[f]=h;e.t=this.t+f+1;e.s=this.s;e.clamp()}function bnpRShiftTo(g,d){d.s=this.s;var e=Math.floor(g/this.DB);if(e>=this.t){d.t=0;return}var b=g%this.DB,a=this.DB-b,f=(1<<b)-1;d[0]=this[e]>>b;for(var c=e+1;c<this.t;++c){d[c-e-1]|=(this[c]&f)<<a;d[c-e]=this[c]>>b}if(0<b){d[this.t-e-1]|=(this.s&f)<<a}d.t=this.t-e;d.clamp()}function bnpSubTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]-d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g-=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g-=d[e];f[e++]=g&this.DM;g>>=this.DB}g-=d.s}f.s=0>g?-1:0;if(-1>g){f[e++]=this.DV+g}else{if(0<g){f[e++]=g}}f.t=e;f.clamp()}function bnpMultiplyTo(c,e){var b=this.abs(),f=c.abs(),d=b.t;e.t=d+f.t;while(0<=--d){e[d]=0}for(d=0;d<f.t;++d){e[d+b.t]=b.am(0,f[d],e,d,0,b.t)}e.s=0;e.clamp();if(this.s!=c.s){BigInteger.ZERO.subTo(e,e)}}function bnpSquareTo(d){var a=this.abs(),b=d.t=2*a.t;while(0<=--b){d[b]=0}for(b=0;b<a.t-1;++b){var e=a.am(b,a[b],d,2*b,0,1);if((d[b+a.t]+=a.am(b+1,2*a[b],d,2*b+1,e,a.t-b-1))>=a.DV){d[b+a.t]-=a.DV;d[b+a.t+1]=1}}if(0<d.t){d[d.t-1]+=a.am(b,a[b],d,2*b,0,1)}d.s=0;d.clamp()}function bnpDivRemTo(n,h,g){var w=n.abs();if(0>=w.t){return}var k=this.abs();if(k.t<w.t){if(null!=h){h.fromInt(0)}if(null!=g){this.copyTo(g)}return}if(null==g){g=nbi()}var d=nbi(),a=this.s,l=n.s,v=this.DB-nbits(w[w.t-1]);if(0<v){w.lShiftTo(v,d);k.lShiftTo(v,g)}else{w.copyTo(d);k.copyTo(g)}var p=d.t,b=d[p-1];if(0==b){return}var o=b*(1<<this.F1)+(1<p?d[p-2]>>this.F2:0),A=this.FV/o,z=(1<<this.F1)/o,x=1<<this.F2,u=g.t,s=u-p,f=null==h?nbi():h;d.dlShiftTo(s,f);if(0<=g.compareTo(f)){g[g.t++]=1;g.subTo(f,g)}BigInteger.ONE.dlShiftTo(p,f);f.subTo(d,d);while(d.t<p){d[d.t++]=0}while(0<=--s){var c=g[--u]==b?this.DM:Math.floor(g[u]*A+(g[u-1]+x)*z);if((g[u]+=d.am(0,c,g,s,0,p))<c){d.dlShiftTo(s,f);g.subTo(f,g);while(g[u]<--c){g.subTo(f,g)}}}if(null!=h){g.drShiftTo(p,h);if(a!=l){BigInteger.ZERO.subTo(h,h)}}g.t=p;g.clamp();if(0<v){g.rShiftTo(v,g)}if(0>a){BigInteger.ZERO.subTo(g,g)}}function bnMod(b){var c=nbi();this.abs().divRemTo(b,null,c);if(0>this.s&&0<c.compareTo(BigInteger.ZERO)){b.subTo(c,c)}return c}function Classic(a){this.m=a}function cConvert(a){if(0>a.s||0<=a.compareTo(this.m)){return a.mod(this.m)}else{return a}}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(1>this.t){return 0}var a=this[0];if(0==(1&a)){return 0}var b=3&a;b=15&b*(2-(15&a)*b);b=255&b*(2-(255&a)*b);b=65535&b*(2-(65535&(65535&a)*b));b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=32767&this.mp;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);if(0>a.s&&0<b.compareTo(BigInteger.ZERO)){this.m.subTo(b,b)}return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}function montReduce(a){while(a.t<=this.mt2){a[a.t++]=0}for(var c=0;c<this.m.t;++c){var b=32767&a[c],d=b*this.mpl+((b*this.mph+(a[c]>>15)*this.mpl&this.um)<<15)&a.DM;b=c+this.m.t;a[b]+=this.m.am(0,d,a,c,0,this.m.t);while(a[b]>=a.DV){a[b]-=a.DV;a[++b]++}}a.clamp();a.drShiftTo(this.m.t,a);if(0<=a.compareTo(this.m)){a.subTo(this.m,a)}}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?1&this[0]:this.s)}function bnpExp(h,j){if(4294967295<h||1>h){return BigInteger.ONE}var f=nbi(),a=nbi(),d=j.convert(this),c=nbits(h)-1;d.copyTo(f);while(0<=--c){j.sqrTo(f,a);if(0<(h&1<<c)){j.mulTo(a,d,f)}else{var b=f;f=a;a=b}}return j.revert(f)}function bnModPowInt(b,a){var c;if(256>b||a.isEven()){c=new Classic(a)}else{c=new Montgomery(a)}return this.exp(b,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var a=nbi();this.copyTo(a);return a}function bnIntValue(){if(0>this.s){if(1==this.t){return this[0]-this.DV}else{if(0==this.t){return-1}}}else{if(1==this.t){return this[0]}else{if(0==this.t){return 0}}}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){if(0>this.s){return-1}else{if(0>=this.t||1==this.t&&0>=this[0]){return 0}else{return 1}}}function bnpToRadix(c){if(null==c){c=10}if(0==this.signum()||2>c||36<c){return"0"}var f=this.chunkSize(c),e=Math.pow(c,f),i=nbv(e),j=nbi(),h=nbi(),g="";this.divRemTo(i,j,h);while(0<j.signum()){g=(e+h.intValue()).toString(c).substr(1)+g;j.divRemTo(i,j,h)}return h.intValue().toString(c)+g}function bnpFromRadix(m,h){var _Mathpow=Math.pow;this.fromInt(0);if(null==h){h=10}for(var f=this.chunkSize(h),g=_Mathpow(h,f),e=!1,a=0,l=0,c=0,k;c<m.length;++c){k=intAt(m,c);if(0>k){if("-"==m.charAt(c)&&0==this.signum()){e=!0}continue}l=h*l+k;if(++a>=f){this.dMultiply(g);this.dAddOffset(l,0);a=0;l=0}}if(0<a){this.dMultiply(_Mathpow(h,a));this.dAddOffset(l,0)}if(e){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(f,e,h){if("number"==typeof e){if(2>f){this.fromInt(1)}else{this.fromNumber(f,h);if(!this.testBit(f-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>f){this.subTo(BigInteger.ONE.shiftLeft(f-1),this)}}}}else{var d=[],g=7&f;d.length=(f>>3)+1;e.nextBytes(d);if(0<g){d[0]&=(1<<g)-1}else{d[0]=0}this.fromString(d,256)}}function bnToByteArray(){var b=this.t,c=[];c[0]=this.s;var e=this.DB-b*this.DB%8,f,a=0;if(0<b--){if(e<this.DB&&(f=this[b]>>e)!=(this.s&this.DM)>>e){c[a++]=f|this.s<<this.DB-e}while(0<=b){if(8>e){f=(this[b]&(1<<e)-1)<<8-e;f|=this[--b]>>(e+=this.DB-8)}else{f=255&this[b]>>(e-=8);if(0>=e){e+=this.DB;--b}}if(0!=(128&f)){f|=-256}if(0==a&&(128&this.s)!=(128&f)){++a}if(0<a||f!=this.s){c[a++]=f}}}return c}function bnEquals(b){return 0==this.compareTo(b)}function bnMin(b){return 0>this.compareTo(b)?this:b}function bnMax(b){return 0<this.compareTo(b)?this:b}function bnpBitwiseTo(c,h,e){var d,g,b=Math.min(c.t,this.t);for(d=0;d<b;++d){e[d]=h(this[d],c[d])}if(c.t<this.t){g=c.s&this.DM;for(d=b;d<this.t;++d){e[d]=h(this[d],g)}e.t=this.t}else{g=this.s&this.DM;for(d=b;d<c.t;++d){e[d]=h(g,c[d])}e.t=c.t}e.s=h(this.s,c.s);e.clamp()}function op_and(a,b){return a&b}function bnAnd(b){var c=nbi();this.bitwiseTo(b,op_and,c);return c}function op_or(a,b){return a|b}function bnOr(b){var c=nbi();this.bitwiseTo(b,op_or,c);return c}function op_xor(a,b){return a^b}function bnXor(b){var c=nbi();this.bitwiseTo(b,op_xor,c);return c}function op_andnot(a,b){return a&~b}function bnAndNot(b){var c=nbi();this.bitwiseTo(b,op_andnot,c);return c}function bnNot(){for(var b=nbi(),a=0;a<this.t;++a){b[a]=this.DM&~this[a]}b.t=this.t;b.s=~this.s;return b}function bnShiftLeft(b){var a=nbi();if(0>b){this.rShiftTo(-b,a)}else{this.lShiftTo(b,a)}return a}function bnShiftRight(b){var a=nbi();if(0>b){this.lShiftTo(-b,a)}else{this.rShiftTo(b,a)}return a}function lbit(a){if(0==a){return-1}var b=0;if(0==(65535&a)){a>>=16;b+=16}if(0==(255&a)){a>>=8;b+=8}if(0==(15&a)){a>>=4;b+=4}if(0==(3&a)){a>>=2;b+=2}if(0==(1&a)){++b}return b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a){if(0!=this[a]){return a*this.DB+lbit(this[a])}}if(0>this.s){return this.t*this.DB}return-1}function cbit(a){var b=0;while(0!=a){a&=a-1;++b}return b}function bnBitCount(){for(var c=0,a=this.s&this.DM,b=0;b<this.t;++b){c+=cbit(this[b]^a)}return c}function bnTestBit(b){var a=Math.floor(b/this.DB);if(a>=this.t){return 0!=this.s}return 0!=(this[a]&1<<b%this.DB)}function bnpChangeBit(c,b){var a=BigInteger.ONE.shiftLeft(c);this.bitwiseTo(a,b,a);return a}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]+d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g+=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g+=d[e];f[e++]=g&this.DM;g>>=this.DB}g+=d.s}f.s=0>g?-1:0;if(0<g){f[e++]=g}else{if(-1>g){f[e++]=this.DV+g}}f.t=e;f.clamp()}function bnAdd(b){var c=nbi();this.addTo(b,c);return c}function bnSubtract(b){var c=nbi();this.subTo(b,c);return c}function bnMultiply(b){var c=nbi();this.multiplyTo(b,c);return c}function bnSquare(){var a=nbi();this.squareTo(a);return a}function bnDivide(b){var c=nbi();this.divRemTo(b,c,null);return c}function bnRemainder(b){var c=nbi();this.divRemTo(b,null,c);return c}function bnDivideAndRemainder(b){var d=nbi(),c=nbi();this.divRemTo(b,d,c);return[d,c]}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(b,a){if(0==b){return}while(this.t<=a){this[this.t++]=0}this[a]+=b;while(this[a]>=this.DV){this[a]-=this.DV;if(++a>=this.t){this[this.t++]=0}++this[a]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,c,b){a.multiplyTo(c,b)}function nSqrTo(a,b){a.squareTo(b)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(a){return this.exp(a,new NullExp)}function bnpMultiplyLowerTo(b,f,e){var _Mathmin=Math.min,d=_Mathmin(this.t+b.t,f);e.s=0;e.t=d;while(0<d){e[--d]=0}var c;for(c=e.t-this.t;d<c;++d){e[d+this.t]=this.am(0,b[d],e,d,0,this.t)}for(c=_Mathmin(b.t,f);d<c;++d){this.am(0,b[d],e,d,0,f-d)}e.clamp()}function bnpMultiplyUpperTo(b,e,d){--e;var c=d.t=this.t+b.t-e;d.s=0;while(0<=--c){d[c]=0}for(c=Math.max(e-this.t,0);c<b.t;++c){d[this.t+c-e]=this.am(e-c,b[c],d,0,0,this.t+c-e)}d.clamp();d.drShiftTo(1,d)}function Barrett(a){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function barrettConvert(a){if(0>a.s||a.t>2*this.m.t){return a.mod(this.m)}else{if(0>a.compareTo(this.m)){return a}else{var b=nbi();a.copyTo(b);this.reduce(b);return b}}}function barrettRevert(a){return a}function barrettReduce(a){a.drShiftTo(this.m.t-1,this.r2);if(a.t>this.m.t+1){a.t=this.m.t+1;a.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(0>a.compareTo(this.r2)){a.dAddOffset(1,this.m.t+1)}a.subTo(this.r2,a);while(0<=a.compareTo(this.m)){a.subTo(this.m,a)}}function barrettSqrTo(a,b){a.squareTo(b);this.reduce(b)}function barrettMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(q,f){var o=q.bitLength(),h,b=nbv(1),v;if(0>=o){return b}else{if(18>o){h=1}else{if(48>o){h=3}else{if(144>o){h=4}else{if(768>o){h=5}else{h=6}}}}}if(8>o){v=new Classic(f)}else{if(f.isEven()){v=new Barrett(f)}else{v=new Montgomery(f)}}var p=[],d=3,s=h-1,a=(1<<h)-1;p[1]=v.convert(this);if(1<h){var A=nbi();v.sqrTo(p[1],A);while(d<=a){p[d]=nbi();v.mulTo(A,p[d-2],p[d]);d+=2}}var l=q.t-1,x,u=!0,c=nbi(),y;o=nbits(q[l])-1;while(0<=l){if(o>=s){x=q[l]>>o-s&a}else{x=(q[l]&(1<<o+1)-1)<<s-o;if(0<l){x|=q[l-1]>>this.DB+o-s}}d=h;while(0==(1&x)){x>>=1;--d}if(0>(o-=d)){o+=this.DB;--l}if(u){p[x].copyTo(b);u=!1}else{while(1<d){v.sqrTo(b,c);v.sqrTo(c,b);d-=2}if(0<d){v.sqrTo(b,c)}else{y=b;b=c;c=y}v.mulTo(c,p[x],b)}while(0<=l&&0==(q[l]&1<<o)){v.sqrTo(b,c);y=b;b=c;c=y;if(0>--o){o=this.DB-1;--l}}}return v.revert(b)}function bnGCD(c){var b=0>this.s?this.negate():this.clone(),h=0>c.s?c.negate():c.clone();if(0>b.compareTo(h)){var e=b;b=h;h=e}var d=b.getLowestSetBit(),f=h.getLowestSetBit();if(0>f){return b}if(d<f){f=d}if(0<f){b.rShiftTo(f,b);h.rShiftTo(f,h)}while(0<b.signum()){if(0<(d=b.getLowestSetBit())){b.rShiftTo(d,b)}if(0<(d=h.getLowestSetBit())){h.rShiftTo(d,h)}if(0<=b.compareTo(h)){b.subTo(h,b);b.rShiftTo(1,b)}else{h.subTo(b,h);h.rShiftTo(1,h)}}if(0<f){h.lShiftTo(f,h)}return h}function bnpModInt(e){if(0>=e){return 0}var c=this.DV%e,b=0>this.s?e-1:0;if(0<this.t){if(0==c){b=this[0]%e}else{for(var a=this.t-1;0<=a;--a){b=(c*b+this[a])%e}}}return b}function bnModInverse(f){var j=f.isEven();if(this.isEven()&&j||0==f.signum()){return BigInteger.ZERO}var i=f.clone(),h=this.clone(),g=nbv(1),e=nbv(0),l=nbv(0),k=nbv(1);while(0!=i.signum()){while(i.isEven()){i.rShiftTo(1,i);if(j){if(!g.isEven()||!e.isEven()){g.addTo(this,g);e.subTo(f,e)}g.rShiftTo(1,g)}else{if(!e.isEven()){e.subTo(f,e)}}e.rShiftTo(1,e)}while(h.isEven()){h.rShiftTo(1,h);if(j){if(!l.isEven()||!k.isEven()){l.addTo(this,l);k.subTo(f,k)}l.rShiftTo(1,l)}else{if(!k.isEven()){k.subTo(f,k)}}k.rShiftTo(1,k)}if(0<=i.compareTo(h)){i.subTo(h,i);if(j){g.subTo(l,g)}e.subTo(k,e)}else{h.subTo(i,h);if(j){l.subTo(g,l)}k.subTo(e,k)}}if(0!=h.compareTo(BigInteger.ONE)){return BigInteger.ZERO}if(0<=k.compareTo(f)){return k.subtract(f)}if(0>k.signum()){k.addTo(f,k)}else{return k}if(0>k.signum()){return k.add(f)}else{return k}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var d,b=this.abs();if(1==b.t&&b[0]<=lowprimes[lowprimes.length-1]){for(d=0;d<lowprimes.length;++d){if(b[0]==lowprimes[d]){return!0}}return!1}if(b.isEven()){return!1}d=1;while(d<lowprimes.length){var a=lowprimes[d],c=d+1;while(c<lowprimes.length&&a<lplim){a*=lowprimes[c++]}a=b.modInt(a);while(d<c){if(0==a%lowprimes[d++]){return!1}}}return b.millerRabin(e)}function bnpMillerRabin(f){var g=this.subtract(BigInteger.ONE),c=g.getLowestSetBit();if(0>=c){return!1}var h=g.shiftRight(c);f=f+1>>1;if(f>lowprimes.length){f=lowprimes.length}for(var b=nbi(),e=0;e<f;++e){b.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var l=b.modPow(h,this);if(0!=l.compareTo(BigInteger.ONE)&&0!=l.compareTo(g)){var d=1;while(d++<c&&0!=l.compareTo(g)){l=l.modPowInt(2,this);if(0==l.compareTo(BigInteger.ONE)){return!1}}if(0!=l.compareTo(g)){return!1}}}return!0}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;function Arcfour(){this.i=0;this.j=0;this.S=[]}function ARC4init(d){var c,a,b;for(c=0;256>c;++c){this.S[c]=c}a=0;for(c=0;256>c;++c){a=255&a+this.S[c]+d[c%d.length];b=this.S[c];this.S[c]=this.S[a];this.S[a]=b}this.i=0;this.j=0}function ARC4next(){var a;this.i=255&this.i+1;this.j=255&this.j+this.S[this.i];a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[255&a+this.S[this.i]]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var rng_psize=256,rng_state,rng_pool,rng_pptr;function rng_seed_int(a){rng_pool[rng_pptr++]^=255&a;rng_pool[rng_pptr++]^=255&a>>8;rng_pool[rng_pptr++]^=255&a>>16;rng_pool[rng_pptr++]^=255&a>>24;if(rng_pptr>=rng_psize){rng_pptr-=rng_psize}}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(null==rng_pool){rng_pool=[];rng_pptr=0;var t;if(window!==void 0&&(window.crypto!==void 0||window.msCrypto!==void 0)){var crypto=window.crypto||window.msCrypto;if(crypto.getRandomValues){var ua=new Uint8Array(32);crypto.getRandomValues(ua);for(t=0;32>t;++t){rng_pool[rng_pptr++]=ua[t]}}else{if("Netscape"==navigator.appName&&"5">navigator.appVersion){var z=window.crypto.random(32);for(t=0;t<z.length;++t){rng_pool[rng_pptr++]=255&z.charCodeAt(t)}}}}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=255&t}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(null==rng_state){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr){rng_pool[rng_pptr]=0}rng_pptr=0}return rng_state.next()}function rng_get_bytes(b){var a;for(a=0;a<b.length;++a){b[a]=rng_get_byte()}}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function parseBigInt(b,a){return new BigInteger(b,a)}function linebrk(c,d){var a="",b=0;while(b+d<c.length){a+=c.substring(b,b+d)+"\n";b+=d}return a+c.substring(b,c.length)}function byte2Hex(a){if(16>a){return"0"+a.toString(16)}else{return a.toString(16)}}function pkcs1pad2(e,h){if(h<e.length+11){throw"Message too long for RSA"}var g=[],d=e.length-1;while(0<=d&&0<h){var f=e.charCodeAt(d--);if(128>f){g[--h]=f}else{if(127<f&&2048>f){g[--h]=128|63&f;g[--h]=192|f>>6}else{g[--h]=128|63&f;g[--h]=128|63&f>>6;g[--h]=224|f>>12}}}g[--h]=0;var b=new SecureRandom,a=[];while(2<h){a[0]=0;while(0==a[0]){b.nextBytes(a)}g[--h]=a[0]}g[--h]=2;g[--h]=0;return new BigInteger(g)}function oaep_mgf1_arr(c,a,e){var b="",d=0;while(b.length<a){b+=e(String.fromCharCode.apply(String,c.concat([(4278190080&d)>>24,(16711680&d)>>16,(65280&d)>>8,255&d])));d+=1}return b}function oaep_pad(q,a,f,l){var c=KJUR.crypto.MessageDigest,o=KJUR.crypto.Util,b=null;if(!f){f="sha1"}if("string"===typeof f){b=c.getCanonicalAlgName(f);l=c.getHashLength(b);f=function(i){return hextorstr(o.hashHex(rstrtohex(i),b))}}if(q.length+2*l+2>a){throw"Message too long for RSA"}var k="",e;for(e=0;e<a-q.length-2*l-2;e+=1){k+="\0"}var h=f("")+k+"\x01"+q,g=Array(l);new SecureRandom().nextBytes(g);var j=oaep_mgf1_arr(g,h.length,f),p=[];for(e=0;e<h.length;e+=1){p[e]=h.charCodeAt(e)^j.charCodeAt(e)}var m=oaep_mgf1_arr(p,g.length,f),d=[0];for(e=0;e<g.length;e+=1){d[e+1]=g[e]^m.charCodeAt(e)}return new BigInteger(d.concat(p))}function RSAKey(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function RSASetPublic(b,a){this.isPublic=!0;this.isPrivate=!1;if("string"!==typeof b){this.n=b;this.e=a}else{if(null!=b&&null!=a&&0<b.length&&0<a.length){this.n=parseBigInt(b,16);this.e=parseInt(a,16)}else{throw"Invalid RSA public key"}}}function RSADoPublic(a){return a.modPowInt(this.e,this.n)}function RSAEncrypt(d){var a=pkcs1pad2(d,this.n.bitLength()+7>>3);if(null==a){return null}var e=this.doPublic(a);if(null==e){return null}var b=e.toString(16);if(0==(1&b.length)){return b}else{return"0"+b}}function RSAEncryptOAEP(f,e,b){var a=oaep_pad(f,this.n.bitLength()+7>>3,e,b);if(null==a){return null}var g=this.doPublic(a);if(null==g){return null}var d=g.toString(16);if(0==(1&d.length)){return d}else{return"0"+d}}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";function pkcs1unpad2(g,j){var _StringfromCharCode=String.fromCharCode,a=g.toByteArray(),f=0;while(f<a.length&&0==a[f]){++f}if(a.length-f!=j-1||2!=a[f]){return null}++f;while(0!=a[f]){if(++f>=a.length){return null}}var e="";while(++f<a.length){var h=255&a[f];if(128>h){e+=_StringfromCharCode(h)}else{if(191<h&&224>h){e+=_StringfromCharCode((31&h)<<6|63&a[f+1]);++f}else{e+=_StringfromCharCode((15&h)<<12|(63&a[f+1])<<6|63&a[f+2]);f+=2}}}return e}function oaep_mgf1_str(c,a,e){var b="",d=0;while(b.length<a){b+=e(c+String.fromCharCode.apply(String,[(4278190080&d)>>24,(16711680&d)>>16,(65280&d)>>8,255&d]));d+=1}return b}function oaep_unpad(o,b,g,p){var _StringfromCharCode2=String.fromCharCode,e=KJUR.crypto.MessageDigest,r=KJUR.crypto.Util,c=null;if(!g){g="sha1"}if("string"===typeof g){c=e.getCanonicalAlgName(g);p=e.getHashLength(c);g=function(d){return hextorstr(r.hashHex(rstrtohex(d),c))}}o=o.toByteArray();var h;for(h=0;h<o.length;h+=1){o[h]&=255}while(o.length<b){o.unshift(0)}o=_StringfromCharCode2.apply(String,o);if(o.length<2*p+2){throw"Cipher too short"}var f=o.substr(1,p),s=o.substr(p+1),q=oaep_mgf1_str(s,p,g),k=[],h;for(h=0;h<f.length;h+=1){k[h]=f.charCodeAt(h)^q.charCodeAt(h)}var l=oaep_mgf1_str(_StringfromCharCode2.apply(String,k),o.length-p,g),j=[];for(h=0;h<s.length;h+=1){j[h]=s.charCodeAt(h)^l.charCodeAt(h)}j=_StringfromCharCode2.apply(String,j);if(j.substr(0,p)!==g("")){throw"Hash mismatch"}j=j.substr(p);var a=j.indexOf("\x01"),m=-1!=a?j.substr(0,a).lastIndexOf("\0"):-1;if(m+1!=a){throw"Malformed data"}return j.substr(a+1)}function RSASetPrivate(c,a,b){this.isPrivate=!0;if("string"!==typeof c){this.n=c;this.e=a;this.d=b}else{if(null!=c&&null!=a&&0<c.length&&0<a.length){this.n=parseBigInt(c,16);this.e=parseInt(a,16);this.d=parseBigInt(b,16)}else{throw"Invalid RSA private key"}}}function RSASetPrivateEx(g,d,e,c,b,a,h,f){this.isPrivate=!0;this.isPublic=!1;if(null==g){throw"RSASetPrivateEx N == null"}if(null==d){throw"RSASetPrivateEx E == null"}if(0==g.length){throw"RSASetPrivateEx N.length == 0"}if(0==d.length){throw"RSASetPrivateEx E.length == 0"}if(null!=g&&null!=d&&0<g.length&&0<d.length){this.n=parseBigInt(g,16);this.e=parseInt(d,16);this.d=parseBigInt(e,16);this.p=parseBigInt(c,16);this.q=parseBigInt(b,16);this.dmp1=parseBigInt(a,16);this.dmq1=parseBigInt(h,16);this.coeff=parseBigInt(f,16)}else{throw"Invalid RSA private key in RSASetPrivateEx"}}function RSAGenerate(b,i){var a=new SecureRandom,f=b>>1;this.e=parseInt(i,16);var c=new BigInteger(i,16);for(;;){for(;;){this.p=new BigInteger(b-f,1,a);if(0==this.p.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(f,1,a);if(0==this.q.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)&&this.q.isProbablePrime(10)){break}}if(0>=this.p.compareTo(this.q)){var h=this.p;this.p=this.q;this.q=h}var g=this.p.subtract(BigInteger.ONE),d=this.q.subtract(BigInteger.ONE),e=g.multiply(d);if(0==e.gcd(c).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q);if(this.n.bitLength()==b){this.d=c.modInverse(e);this.dmp1=this.d.mod(g);this.dmq1=this.d.mod(d);this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function RSADoPrivate(a){if(null==this.p||null==this.q){return a.modPow(this.d,this.n)}var c=a.mod(this.p).modPow(this.dmp1,this.p),b=a.mod(this.q).modPow(this.dmq1,this.q);while(0>c.compareTo(b)){c=c.add(this.p)}return c.subtract(b).multiply(this.coeff).mod(this.p).multiply(this.q).add(b)}function RSADecrypt(b){if(b.length!=Math.ceil(this.n.bitLength()/4)){throw new Error("wrong ctext length")}var d=parseBigInt(b,16),a=this.doPrivate(d);if(null==a){return null}return pkcs1unpad2(a,this.n.bitLength()+7>>3)}function RSADecryptOAEP(e,d,b){if(e.length!=Math.ceil(this.n.bitLength()/4)){throw new Error("wrong ctext length")}var f=parseBigInt(e,16),a=this.doPrivate(f);if(null==a){return null}return oaep_unpad(a,this.n.bitLength()+7>>3,d,b)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;function ECFieldElementFp(b,a){this.x=a;this.q=b}function feFpEquals(a){if(a==this){return!0}return this.q.equals(a.q)&&this.x.equals(a.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(a){return new ECFieldElementFp(this.q,this.x.add(a.toBigInteger()).mod(this.q))}function feFpSubtract(a){return new ECFieldElementFp(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}function feFpMultiply(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(c,a,d,b){this.curve=c;this.x=a;this.y=d;if(null==b){this.z=BigInteger.ONE}else{this.z=b}this.zinv=null}function pointFpGetX(){if(null==this.zinv){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){if(null==this.zinv){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(a){if(a==this){return!0}if(this.isInfinity()){return a.isInfinity()}if(a.isInfinity()){return this.isInfinity()}var c,b;c=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q);if(!c.equals(BigInteger.ZERO)){return!1}b=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);return b.equals(BigInteger.ZERO)}function pointFpIsInfinity(){if(null==this.x&&null==this.y){return!0}return this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(l){if(this.isInfinity()){return l}if(l.isInfinity()){return this}var p=l.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(l.z)).mod(this.curve.q),o=l.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(l.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(o)){if(BigInteger.ZERO.equals(p)){return this.twice()}return this.curve.getInfinity()}var j=new BigInteger("3"),e=this.x.toBigInteger(),n=this.y.toBigInteger(),c=l.x.toBigInteger(),k=l.y.toBigInteger(),m=o.square(),i=m.multiply(o),d=e.multiply(m),g=p.square().multiply(this.z),a=g.subtract(d.shiftLeft(1)).multiply(l.z).subtract(i).multiply(o).mod(this.curve.q),h=d.multiply(j).multiply(p).subtract(n.multiply(i)).subtract(g.multiply(p)).multiply(l.z).add(p.multiply(i)).mod(this.curve.q),f=i.multiply(this.z).multiply(l.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),f)}function pointFpTwice(){if(this.isInfinity()){return this}if(0==this.y.toBigInteger().signum()){return this.curve.getInfinity()}var g=new BigInteger("3"),c=this.x.toBigInteger(),h=this.y.toBigInteger(),e=h.multiply(this.z),j=e.multiply(h).mod(this.curve.q),i=this.curve.a.toBigInteger(),k=c.square().multiply(g);if(!BigInteger.ZERO.equals(i)){k=k.add(this.z.square().multiply(i))}k=k.mod(this.curve.q);var b=k.square().subtract(c.shiftLeft(3).multiply(j)).shiftLeft(1).multiply(e).mod(this.curve.q),f=k.multiply(g).multiply(c).subtract(j.shiftLeft(1)).shiftLeft(2).multiply(j).subtract(k.square().multiply(k)).mod(this.curve.q),d=e.square().multiply(e).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(b),this.curve.fromBigInteger(f),d)}function pointFpMultiply(d){if(this.isInfinity()){return this}if(0==d.signum()){return this.curve.getInfinity()}var m=d,l=m.multiply(new BigInteger("3")),b=this.negate(),j=this,q=this.curve.q.subtract(d),o=q.multiply(new BigInteger("3")),c=new ECPointFp(this.curve,this.x,this.y),a=c.negate(),g;for(g=l.bitLength()-2;0<g;--g){j=j.twice();var n=l.testBit(g),f=m.testBit(g);if(n!=f){j=j.add(n?this:b)}}for(g=o.bitLength()-2;0<g;--g){c=c.twice();var p=o.testBit(g),r=q.testBit(g);if(p!=r){c=c.add(p?c:a)}}return j}function pointFpMultiplyTwo(c,a,b){var d;if(c.bitLength()>b.bitLength()){d=c.bitLength()-1}else{d=b.bitLength()-1}var f=this.curve.getInfinity(),e=this.add(a);while(0<=d){f=f.twice();if(c.testBit(d)){if(b.testBit(d)){f=f.add(e)}else{f=f.add(this)}}else{if(b.testBit(d)){f=f.add(a)}}--d}return f}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(e,d,c){this.q=e;this.a=this.fromBigInteger(d);this.b=this.fromBigInteger(c);this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(a){if(a==this){return!0}return this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(a){return new ECFieldElementFp(this.q,a)}function curveFpDecodePointHex(d){switch(parseInt(d.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var a=(d.length-2)/2,c=d.substr(2,a),b=d.substr(a+2,a);return new ECPointFp(this,this.fromBigInteger(new BigInteger(c,16)),this.fromBigInteger(new BigInteger(b,16)));default:return null;}}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ECPointFp.prototype.getEncoded=function(c){var d=function(h,f){var g=h.toByteArrayUnsigned();if(f<g.length){g=g.slice(g.length-f)}else{while(f>g.length){g.unshift(0)}}return g},a=this.getX().toBigInteger(),e=this.getY().toBigInteger(),b=d(a,32);if(c){if(e.isEven()){b.unshift(2)}else{b.unshift(3)}}else{b.unshift(4);b=b.concat(d(e,32))}return b};ECPointFp.decodeFrom=function(g,c){var f=c[0],e=c.length-1,d=c.slice(1,1+e/2),b=c.slice(1+e/2,1+e);d.unshift(0);b.unshift(0);var a=new BigInteger(d),h=new BigInteger(b);return new ECPointFp(g,g.fromBigInteger(a),g.fromBigInteger(h))};ECPointFp.decodeFromHex=function(g,c){var f=c.substr(0,2),e=c.length-2,d=c.substr(2,e/2),b=c.substr(2+e/2,e/2),a=new BigInteger(d,16),h=new BigInteger(b,16);return new ECPointFp(g,g.fromBigInteger(a),g.fromBigInteger(h))};ECPointFp.prototype.add2D=function(c){if(this.isInfinity()){return c}if(c.isInfinity()){return this}if(this.x.equals(c.x)){if(this.y.equals(c.y)){return this.twice()}return this.curve.getInfinity()}var g=c.x.subtract(this.x),e=c.y.subtract(this.y),a=e.divide(g),d=a.square().subtract(this.x).subtract(c.x),f=a.multiply(this.x.subtract(d)).subtract(this.y);return new ECPointFp(this.curve,d,f)};ECPointFp.prototype.twice2D=function(){if(this.isInfinity()){return this}if(0==this.y.toBigInteger().signum()){return this.curve.getInfinity()}var b=this.curve.fromBigInteger(BigInteger.valueOf(2)),e=this.curve.fromBigInteger(BigInteger.valueOf(3)),a=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(b)),c=a.square().subtract(this.x.multiply(b)),d=a.multiply(this.x.subtract(c)).subtract(this.y);return new ECPointFp(this.curve,c,d)};ECPointFp.prototype.multiply2D=function(b){if(this.isInfinity()){return this}if(0==b.signum()){return this.curve.getInfinity()}var g=b,f=g.multiply(new BigInteger("3")),l=this.negate(),d=this,c;for(c=f.bitLength()-2;0<c;--c){d=d.twice();var a=f.testBit(c),j=g.testBit(c);if(a!=j){d=d.add2D(a?this:l)}}return d};ECPointFp.prototype.isOnCurve=function(){var d=this.getX().toBigInteger(),i=this.getY().toBigInteger(),f=this.curve.getA().toBigInteger(),c=this.curve.getB().toBigInteger(),h=this.curve.getQ(),e=i.multiply(i).mod(h),g=d.multiply(d).multiply(d).add(f.multiply(d)).add(c).mod(h);return e.equals(g)};ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ECPointFp.prototype.validate=function(){var c=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var a=this.getX().toBigInteger(),b=this.getY().toBigInteger();if(0>a.compareTo(BigInteger.ONE)||0<a.compareTo(c.subtract(BigInteger.ONE))){throw new Error("x coordinate out of bounds")}if(0>b.compareTo(BigInteger.ONE)||0<b.compareTo(c.subtract(BigInteger.ONE))){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(c).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return!0};var jsonParse=function(){var d=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+"(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)"+"|"+("(?:\""+"(?:[^\\0-\\x08\\x0a-\\x1f\"\\\\]|\\\\(?:[\"/\\\\bfnrt]|u[0-9A-Fa-f]{4}))"+"*\")")+")","g"),k=/\\(?:([^u])|u(.{4}))/g,g={'"':"\"","/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function h(l,m,n){return m?g[m]:String.fromCharCode(parseInt(n,16))}var c=new String(""),f={"{":Object,"[":Array},b=Object.hasOwnProperty;return function(u,q){var p=u.match(d),x,v=p[0],l=!1;if("{"===v){x={}}else{if("["===v){x=[]}else{x=[];l=!0}}for(var t,r=[x],o=1-l,m=p.length;o<m;++o){v=p[o];var w;switch(v.charCodeAt(0)){default:w=r[0];w[t||w.length]=+v;t=void 0;break;case 34:v=v.substring(1,v.length-1);if(-1!==v.indexOf("\\")){v=v.replace(k,h)}w=r[0];if(!t){if(w instanceof Array){t=w.length}else{t=v||c;break}}w[t]=v;t=void 0;break;case 91:w=r[0];r.unshift(w[t||w.length]=[]);t=void 0;break;case 93:r.shift();break;case 102:w=r[0];w[t||w.length]=!1;t=void 0;break;case 110:w=r[0];w[t||w.length]=null;t=void 0;break;case 116:w=r[0];w[t||w.length]=!0;t=void 0;break;case 123:w=r[0];r.unshift(w[t||w.length]={});t=void 0;break;case 125:r.shift();break;}}if(l){if(1!==r.length){throw new Error}x=x[0]}else{if(r.length){throw new Error}}if(q){var s=function(C,B){var D=C[B];if(D&&"object"===typeof D){var n=null;for(var z in D){if(b.call(D,z)&&D!==C){var y=s(D,z);if(void 0!==y){D[z]=y}else{if(!n){n=[]}n.push(z)}}}if(n){for(var A=n.length;0<=--A;){delete D[n[A]]}}}return q.call(C,B,D)};x=s({"":x},"")}return x}}();if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.asn1||!KJUR.asn1){KJUR.asn1={}}KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var b=a.toString(16);if(1==b.length%2){b="0"+b}return b};this.bigIntToMinTwosComplementsHex=function(j){var f=j.toString(16);if("-"!=f.substr(0,1)){if(1==f.length%2){f="0"+f}else{if(!f.match(/^[0-7]/)){f="00"+f}}}else{var a=f.substr(1),e=a.length;if(1==e%2){e+=1}else{if(!f.match(/^[0-7]/)){e+=2}}for(var g="",d=0;d<e;d++){g+="f"}var c=new BigInteger(g,16),b=c.xor(j).add(BigInteger.ONE);f=b.toString(16).replace(/^-/,"")}return f};this.getPEMStringFromHex=function(a,b){return hextopem(a,b)};this.newObject=function(k){var F=KJUR,o=F.asn1,v=o.ASN1Object,B=o.DERBoolean,e=o.DERInteger,t=o.DERBitString,h=o.DEROctetString,x=o.DERNull,y=o.DERObjectIdentifier,m=o.DEREnumerated,g=o.DERUTF8String,f=o.DERNumericString,A=o.DERPrintableString,w=o.DERTeletexString,q=o.DERIA5String,E=o.DERUTCTime,j=o.DERGeneralizedTime,b=o.DERVisibleString,l=o.DERBMPString,n=o.DERSequence,c=o.DERSet,s=o.DERTaggedObject,p=o.ASN1Util.newObject;if(k instanceof o.ASN1Object){return k}var u=Object.keys(k);if(1!=u.length){throw new Error("key of param shall be only one.")}var H=u[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+H+":")){throw new Error("undefined key: "+H)}if("bool"==H){return new B(k[H])}if("int"==H){return new e(k[H])}if("bitstr"==H){return new t(k[H])}if("octstr"==H){return new h(k[H])}if("null"==H){return new x(k[H])}if("oid"==H){return new y(k[H])}if("enum"==H){return new m(k[H])}if("utf8str"==H){return new g(k[H])}if("numstr"==H){return new f(k[H])}if("prnstr"==H){return new A(k[H])}if("telstr"==H){return new w(k[H])}if("ia5str"==H){return new q(k[H])}if("utctime"==H){return new E(k[H])}if("gentime"==H){return new j(k[H])}if("visstr"==H){return new b(k[H])}if("bmpstr"==H){return new l(k[H])}if("asn1"==H){return new v(k[H])}if("seq"==H){for(var d=k[H],G=[],z=0,D;z<d.length;z++){D=p(d[z]);G.push(D)}return new n({array:G})}if("set"==H){for(var d=k[H],G=[],z=0,D;z<d.length;z++){D=p(d[z]);G.push(D)}return new c({array:G})}if("tag"==H){var C=k[H];if("[object Array]"===Object.prototype.toString.call(C)&&3==C.length){var r=p(C[2]);return new s({tag:C[0],explicit:C[1],obj:r})}else{return new s(C)}}};this.jsonToASN1HEX=function(b){var a=this.newObject(b);return a.getEncodedHex()}};KJUR.asn1.ASN1Util.oidHexToInt=function(a){for(var j="",k=parseInt(a.substr(0,2),16),d=Math.floor(k/40),j=d+"."+k%40,e="",f=2;f<a.length;f+=2){var g=parseInt(a.substr(f,2),16),h=("00000000"+g.toString(2)).slice(-8);e=e+h.substr(1,7);if("0"==h.substr(0,1)){var b=new BigInteger(e,2);j=j+"."+b.toString(10);e=""}}return j};KJUR.asn1.ASN1Util.oidIntToHex=function(f){var e=function(a){var k=a.toString(16);if(1==k.length){k="0"+k}return k},d=function(o){var n="",k=new BigInteger(o,10),a=k.toString(2),l=7-a.length%7;if(7==l){l=0}for(var q="",m=0;m<l;m++){q+="0"}a=q+a;for(var m=0,p;m<a.length-1;m+=7){p=a.substr(m,7);if(m!=a.length-7){p="1"+p}n+=e(parseInt(p,2))}return n};if(!f.match(/^[0-9.]+$/)){throw"malformed oid string: "+f}var g="",b=f.split("."),j=40*parseInt(b[0])+parseInt(b[1]);g+=e(j);b.splice(0,2);for(var c=0;c<b.length;c++){g+=d(b[c])}return g};KJUR.asn1.ASN1Object=function(e){this.params=null;this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV){throw new Error("this.hV is null or undefined")}if(1==this.hV.length%2){throw new Error("value hex must be even length: n="+"".length+",v="+this.hV)}var j=this.hV.length/2,i=j.toString(16);if(1==i.length%2){i="0"+i}if(128>j){return i}else{var h=i.length/2;if(15<h){throw"ASN.1 length too long to represent by 8x: n = "+j.toString(16)}return(128+h).toString(16)+i}};this.getEncodedHex=function(){if(null==this.hTLV||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=!1}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""};this.setByParam=function(g){this.params=g};if(e!=void 0){if(e.tlv!=void 0){this.hTLV=e.tlv;this.isModified=!1}}};KJUR.asn1.DERAbstractString=function(c){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s};this.setString=function(d){this.hTLV=null;this.isModified=!0;this.s=d;this.hV=utf8tohex(this.s).toLowerCase()};this.setStringHex=function(d){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=d};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof c){if("string"==typeof c){this.setString(c)}else{if("undefined"!=typeof c.str){this.setString(c.str)}else{if("undefined"!=typeof c.hex){this.setStringHex(c.hex)}}}}};extendClass(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractTime=function(){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(g){var e=g.getTime()+6e4*g.getTimezoneOffset(),f=new Date(e);return f};this.formatDate=function(m,o,e){var g=this.zeroPadding,n=this.localDateToUTC(m),p=n.getFullYear()+"";if("utc"==o){p=p.substr(2,2)}var l=g(n.getMonth()+1+"",2),q=g(n.getDate()+"",2),h=g(n.getHours()+"",2),i=g(n.getMinutes()+"",2),j=g(n.getSeconds()+"",2),r=p+l+q+h+i+j;if(!0===e){var f=n.getMilliseconds();if(0!=f){var k=g(f+"",3);k=k.replace(/[0]+$/,"");r=r+"."+k}}return r+"Z"};this.zeroPadding=function(e,d){if(e.length>=d){return e}return Array(d-e.length+1).join("0")+e};this.getString=function(){return this.s};this.setString=function(d){this.hTLV=null;this.isModified=!0;this.s=d;this.hV=stohex(d)};this.setByDateValue=function(h,j,e,d,f,g){var i=new Date(Date.UTC(h,j-1,e,d,f,g,0));this.setByDate(i)};this.getFreshValueHex=function(){return this.hV}};extendClass(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractStructured=function(b){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(c){this.hTLV=null;this.isModified=!0;this.asn1Array=c};this.appendASN1Object=function(c){this.hTLV=null;this.isModified=!0;this.asn1Array.push(c)};this.asn1Array=[];if("undefined"!=typeof b){if("undefined"!=typeof b.array){this.asn1Array=b.array}}};extendClass(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object);KJUR.asn1.DERBoolean=function(a){KJUR.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";if(!1==a){this.hTLV="010100"}else{this.hTLV="0101ff"}};extendClass(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object);KJUR.asn1.DERInteger=function(a){KJUR.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(b){this.hTLV=null;this.isModified=!0;this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(b)};this.setByInteger=function(c){var b=new BigInteger(c+"",10);this.setByBigInteger(b)};this.setValueHex=function(b){this.hV=b};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof a){if("undefined"!=typeof a.bigint){this.setByBigInteger(a.bigint)}else{if("undefined"!=typeof a.int){this.setByInteger(a.int)}else{if("number"==typeof a){this.setByInteger(a)}else{if("undefined"!=typeof a.hex){this.setValueHex(a.hex)}}}}}};extendClass(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object);KJUR.asn1.DERBitString=function(b){if(b!==void 0&&"undefined"!==typeof b.obj){var a=KJUR.asn1.ASN1Util.newObject(b.obj);b.hex="00"+a.getEncodedHex()}KJUR.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(c){this.hTLV=null;this.isModified=!0;this.hV=c};this.setUnusedBitsAndHexValue=function(c,e){if(0>c||7<c){throw"unused bits shall be from 0 to 7: u = "+c}this.hTLV=null;this.isModified=!0;this.hV="0"+c+e};this.setByBinaryString=function(e){e=e.replace(/0+$/,"");var f=8-e.length%8;if(8==f){f=0}for(var g=0;g<=f;g++){e+="0"}for(var j="",g=0;g<e.length-1;g+=8){var d=e.substr(g,8),c=parseInt(d,2).toString(16);if(1==c.length){c="0"+c}j+=c}this.hTLV=null;this.isModified=!0;this.hV="0"+f+j};this.setByBooleanArray=function(e){for(var d="",c=0;c<e.length;c++){if(!0==e[c]){d+="1"}else{d+="0"}}this.setByBinaryString(d)};this.newFalseArray=function(e){for(var c=Array(e),d=0;d<e;d++){c[d]=!1}return c};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof b){if("string"==typeof b&&b.toLowerCase().match(/^[0-9a-f]+$/)){this.setHexValueIncludingUnusedBits(b)}else{if("undefined"!=typeof b.hex){this.setHexValueIncludingUnusedBits(b.hex)}else{if("undefined"!=typeof b.bin){this.setByBinaryString(b.bin)}else{if("undefined"!=typeof b.array){this.setByBooleanArray(b.array)}}}}}};extendClass(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object);KJUR.asn1.DEROctetString=function(b){if(b!==void 0&&"undefined"!==typeof b.obj){var a=KJUR.asn1.ASN1Util.newObject(b.obj);b.hex=a.getEncodedHex()}KJUR.asn1.DEROctetString.superclass.constructor.call(this,b);this.hT="04"};extendClass(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};extendClass(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object);KJUR.asn1.DERObjectIdentifier=function(a){KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(b){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=b};this.setValueOidString=function(b){var c=oidtohex(b);if(null==c){throw new Error("malformed oid string: "+b)}this.hTLV=null;this.isModified=!0;this.s=null;this.hV=c};this.setValueName=function(c){var b=KJUR.asn1.x509.OID.name2oid(c);if(""!==b){this.setValueOidString(b)}else{throw new Error("DERObjectIdentifier oidName undefined: "+c)}};this.setValueNameOrOid=function(b){if(b.match(/^[0-2].[0-9.]+$/)){this.setValueOidString(b)}else{this.setValueName(b)}};this.getFreshValueHex=function(){return this.hV};this.setByParam=function(b){if("string"===typeof b){this.setValueNameOrOid(b)}else{if(b.oid!==void 0){this.setValueNameOrOid(b.oid)}else{if(b.name!==void 0){this.setValueNameOrOid(b.name)}else{if(b.hex!==void 0){this.setValueHex(b.hex)}}}}};if(a!==void 0){this.setByParam(a)}};extendClass(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.DEREnumerated=function(a){KJUR.asn1.DEREnumerated.superclass.constructor.call(this);this.hT="0a";this.setByBigInteger=function(b){this.hTLV=null;this.isModified=!0;this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(b)};this.setByInteger=function(c){var b=new BigInteger(c+"",10);this.setByBigInteger(b)};this.setValueHex=function(b){this.hV=b};this.getFreshValueHex=function(){return this.hV};if("undefined"!=typeof a){if("undefined"!=typeof a.int){this.setByInteger(a.int)}else{if("number"==typeof a){this.setByInteger(a)}else{if("undefined"!=typeof a.hex){this.setValueHex(a.hex)}}}}};extendClass(KJUR.asn1.DEREnumerated,KJUR.asn1.ASN1Object);KJUR.asn1.DERUTF8String=function(a){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,a);this.hT="0c"};extendClass(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNumericString=function(a){KJUR.asn1.DERNumericString.superclass.constructor.call(this,a);this.hT="12"};extendClass(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERPrintableString=function(a){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,a);this.hT="13"};extendClass(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERTeletexString=function(a){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,a);this.hT="14"};extendClass(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERIA5String=function(a){KJUR.asn1.DERIA5String.superclass.constructor.call(this,a);this.hT="16"};extendClass(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERVisibleString=function(a){KJUR.asn1.DERIA5String.superclass.constructor.call(this,a);this.hT="1a"};extendClass(KJUR.asn1.DERVisibleString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERBMPString=function(a){KJUR.asn1.DERBMPString.superclass.constructor.call(this,a);this.hT="1e"};extendClass(KJUR.asn1.DERBMPString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERUTCTime=function(a){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,a);this.hT="17";this.setByDate=function(b){this.hTLV=null;this.isModified=!0;this.date=b;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};this.getFreshValueHex=function(){if("undefined"==typeof this.date&&"undefined"==typeof this.s){this.date=new Date;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)}return this.hV};if(a!==void 0){if(a.str!==void 0){this.setString(a.str)}else{if("string"==typeof a&&a.match(/^[0-9]{12}Z$/)){this.setString(a)}else{if(a.hex!==void 0){this.setStringHex(a.hex)}else{if(a.date!==void 0){this.setByDate(a.date)}}}}}};extendClass(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERGeneralizedTime=function(a){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,a);this.hT="18";this.withMillis=!1;this.setByDate=function(b){this.hTLV=null;this.isModified=!0;this.date=b;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(this.date===void 0&&this.s===void 0){this.date=new Date;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)}return this.hV};if(a!==void 0){if(a.str!==void 0){this.setString(a.str)}else{if("string"==typeof a&&a.match(/^[0-9]{14}Z$/)){this.setString(a)}else{if(a.hex!==void 0){this.setStringHex(a.hex)}else{if(a.date!==void 0){this.setByDate(a.date)}}}}if(!0===a.millis){this.withMillis=!0}}};extendClass(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERSequence=function(a){KJUR.asn1.DERSequence.superclass.constructor.call(this,a);this.hT="30";this.getFreshValueHex=function(){for(var c="",b=0,d;b<this.asn1Array.length;b++){d=this.asn1Array[b];c+=d.getEncodedHex()}this.hV=c;return this.hV}};extendClass(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERSet=function(a){KJUR.asn1.DERSet.superclass.constructor.call(this,a);this.hT="31";this.sortFlag=!0;this.getFreshValueHex=function(){for(var b=[],c=0,d;c<this.asn1Array.length;c++){d=this.asn1Array[c];b.push(d.getEncodedHex())}if(!0==this.sortFlag){b.sort()}this.hV=b.join("");return this.hV};if("undefined"!=typeof a){if("undefined"!=typeof a.sortflag&&!1==a.sortflag){this.sortFlag=!1}}};extendClass(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERTaggedObject=function(b){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this);var a=KJUR.asn1;this.hT="a0";this.hV="";this.isExplicit=!0;this.asn1Object=null;this.setASN1Object=function(c,d,e){this.hT=d;this.isExplicit=c;this.asn1Object=e;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=!0}else{this.hV=null;this.hTLV=e.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,d);this.isModified=!1}};this.getFreshValueHex=function(){return this.hV};this.setByParam=function(c){if(c.tag!=void 0){this.hT=c.tag}if(c.explicit!=void 0){this.isExplicit=c.explicit}if(c.tage!=void 0){this.hT=c.tage;this.isExplicit=!0}if(c.tagi!=void 0){this.hT=c.tagi;this.isExplicit=!1}if(c.obj!=void 0){if(c.obj instanceof a.ASN1Object){this.asn1Object=c.obj;this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}else{if("object"==typeof c.obj){this.asn1Object=a.ASN1Util.newObject(c.obj);this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}}};if(b!=void 0){this.setByParam(b)}};extendClass(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);var ASN1HEX=new function(){};ASN1HEX.getLblen=function(c,a){if("8"!=c.substr(a+2,1)){return 1}var b=parseInt(c.substr(a+3,1));if(0==b){return-1}if(0<b&&10>b){return b+1}return-2};ASN1HEX.getL=function(c,b){var a=ASN1HEX.getLblen(c,b);if(1>a){return""}return c.substr(b+2,2*a)};ASN1HEX.getVblen=function(d,a){var c,b;c=ASN1HEX.getL(d,a);if(""==c){return-1}if("8"===c.substr(0,1)){b=new BigInteger(c.substr(2),16)}else{b=new BigInteger(c,16)}return b.intValue()};ASN1HEX.getVidx=function(c,b){var a=ASN1HEX.getLblen(c,b);if(0>a){return a}return b+2*(a+1)};ASN1HEX.getV=function(d,a){var c=ASN1HEX.getVidx(d,a),b=ASN1HEX.getVblen(d,a);return d.substr(c,2*b)};ASN1HEX.getTLV=function(b,a){return b.substr(a,2)+ASN1HEX.getL(b,a)+ASN1HEX.getV(b,a)};ASN1HEX.getTLVblen=function(b,a){return 2+2*ASN1HEX.getLblen(b,a)+2*ASN1HEX.getVblen(b,a)};ASN1HEX.getNextSiblingIdx=function(d,a){var c=ASN1HEX.getVidx(d,a),b=ASN1HEX.getVblen(d,a);return c+2*b};ASN1HEX.getChildIdx=function(e,k){var l=ASN1HEX,j=[],c,f,g;c=l.getVidx(e,k);f=2*l.getVblen(e,k);if("03"==e.substr(k,2)){c+=2;f-=2}g=0;var d=c;while(g<=f){var b=l.getTLVblen(e,d);g+=b;if(g<=f){j.push(d)}d+=b;if(g>=f){break}}return j};ASN1HEX.getNthChildIdx=function(d,b,e){var c=ASN1HEX.getChildIdx(d,b);return c[e]};ASN1HEX.getIdxbyList=function(e,d,c,i){var g=ASN1HEX,f,b;if(0==c.length){if(i!==void 0){if(e.substr(d,2)!==i){return-1}}return d}f=c.shift();b=g.getChildIdx(e,d);if(f>=b.length){return-1}return g.getIdxbyList(e,b[f],c,i)};ASN1HEX.getIdxbyListEx=function(f,k,b,g){var m=ASN1HEX,d,l;if(0==b.length){if(g!==void 0){if(f.substr(k,2)!==g){return-1}}return k}d=b.shift();l=m.getChildIdx(f,k);for(var j=0,e=0,c;e<l.length;e++){c=f.substr(l[e],2);if("number"==typeof d&&!m.isContextTag(c)&&j==d||"string"==typeof d&&m.isContextTag(c,d)){return m.getIdxbyListEx(f,l[e],b,g)}if(!m.isContextTag(c)){j++}}return-1};ASN1HEX.getTLVbyList=function(d,c,b,f){var e=ASN1HEX,a=e.getIdxbyList(d,c,b,f);if(-1==a){return null}if(a>=d.length){return null}return e.getTLV(d,a)};ASN1HEX.getTLVbyListEx=function(d,c,b,f){var e=ASN1HEX,a=e.getIdxbyListEx(d,c,b,f);if(-1==a){return null}return e.getTLV(d,a)};ASN1HEX.getVbyList=function(e,c,b,g,i){var f=ASN1HEX,a,d;a=f.getIdxbyList(e,c,b,g);if(-1==a){return null}if(a>=e.length){return null}d=f.getV(e,a);if(!0===i){d=d.substr(2)}return d};ASN1HEX.getVbyListEx=function(b,e,a,d,f){var j=ASN1HEX,g,i;g=j.getIdxbyListEx(b,e,a,d);if(-1==g){return null}i=j.getV(b,g);if("03"==b.substr(g,2)&&!1!==f){i=i.substr(2)}return i};ASN1HEX.getInt=function(e,b,f){if(f==void 0){f=-1}try{var c=e.substr(b,2);if("02"!=c&&"03"!=c){return f}var a=ASN1HEX.getV(e,b);if("02"==c){return parseInt(a,16)}else{return bitstrtoint(a)}}catch(d){return f}};ASN1HEX.getOID=function(c,a,d){if(d==void 0){d=null}try{if("06"!=c.substr(a,2)){return d}var e=ASN1HEX.getV(c,a);return hextooid(e)}catch(b){return d}};ASN1HEX.getOIDName=function(d,a,f){if(f==void 0){f=null}try{var e=ASN1HEX.getOID(d,a,f);if(e==f){return f}var b=KJUR.asn1.x509.OID.oid2name(e);if(""==b){return e}return b}catch(c){return f}};ASN1HEX.getString=function(d,b,e){if(e==void 0){e=null}try{var a=ASN1HEX.getV(d,b);return hextorstr(a)}catch(c){return e}};ASN1HEX.hextooidstr=function(e){var h=function(b,a){if(b.length>=a){return b}return Array(a-b.length+1).join("0")+b},l=[],o=e.substr(0,2),f=parseInt(o,16);l[0]=new String(Math.floor(f/40));l[1]=new String(f%40);for(var m=e.substr(2),k=[],g=0;g<m.length/2;g++){k.push(parseInt(m.substr(2*g,2),16))}for(var j=[],d="",g=0;g<k.length;g++){if(128&k[g]){d=d+h((127&k[g]).toString(2),7)}else{d=d+h((127&k[g]).toString(2),7);j.push(new String(parseInt(d,2)));d=""}}var n=l.join(".");if(0<j.length){n=n+"."+j.join(".")}return n};ASN1HEX.dump=function(t,c,l,g){var p=ASN1HEX,j=p.getV,y=p.dump,w=p.getChildIdx,e=t;if(t instanceof KJUR.asn1.ASN1Object){e=t.getEncodedHex()}var q=function(A,i){if(A.length<=2*i){return A}else{var v=A.substr(0,i)+"..(total "+A.length/2+"bytes).."+A.substr(A.length-i,i);return v}};if(c===void 0){c={ommit_long_octet:32}}if(l===void 0){l=0}if(g===void 0){g=""}var x=c.ommit_long_octet,z=e.substr(l,2);if("01"==z){var h=j(e,l);if("00"==h){return g+"BOOLEAN FALSE\n"}else{return g+"BOOLEAN TRUE\n"}}if("02"==z){var h=j(e,l);return g+"INTEGER "+q(h,x)+"\n"}if("03"==z){var h=j(e,l);if(p.isASN1HEX(h.substr(2))){var k=g+"BITSTRING, encapsulates\n";k=k+y(h.substr(2),c,0,g+"  ");return k}else{return g+"BITSTRING "+q(h,x)+"\n"}}if("04"==z){var h=j(e,l);if(p.isASN1HEX(h)){var k=g+"OCTETSTRING, encapsulates\n";k=k+y(h,c,0,g+"  ");return k}else{return g+"OCTETSTRING "+q(h,x)+"\n"}}if("05"==z){return g+"NULL\n"}if("06"==z){var m=j(e,l),b=KJUR.asn1.ASN1Util.oidHexToInt(m),o=KJUR.asn1.x509.OID.oid2name(b),a=b.replace(/\./g," ");if(""!=o){return g+"ObjectIdentifier "+o+" ("+a+")\n"}else{return g+"ObjectIdentifier ("+a+")\n"}}if("0a"==z){return g+"ENUMERATED "+parseInt(j(e,l))+"\n"}if("0c"==z){return g+"UTF8String '"+hextoutf8(j(e,l))+"'\n"}if("13"==z){return g+"PrintableString '"+hextoutf8(j(e,l))+"'\n"}if("14"==z){return g+"TeletexString '"+hextoutf8(j(e,l))+"'\n"}if("16"==z){return g+"IA5String '"+hextoutf8(j(e,l))+"'\n"}if("17"==z){return g+"UTCTime "+hextoutf8(j(e,l))+"\n"}if("18"==z){return g+"GeneralizedTime "+hextoutf8(j(e,l))+"\n"}if("1a"==z){return g+"VisualString '"+hextoutf8(j(e,l))+"'\n"}if("1e"==z){return g+"BMPString '"+ucs2hextoutf8(j(e,l))+"'\n"}if("30"==z){if("3000"==e.substr(l,4)){return g+"SEQUENCE {}\n"}var k=g+"SEQUENCE\n",d=w(e,l),f=c;if((2==d.length||3==d.length)&&"06"==e.substr(d[0],2)&&"04"==e.substr(d[d.length-1],2)){var o=p.oidname(j(e,d[0])),r=JSON.parse(JSON.stringify(c));r.x509ExtName=o;f=r}for(var u=0;u<d.length;u++){k=k+y(e,f,d[u],g+"  ")}return k}if("31"==z){for(var k=g+"SET\n",d=w(e,l),u=0;u<d.length;u++){k=k+y(e,c,d[u],g+"  ")}return k}var z=parseInt(z,16);if(0!=(128&z)){var n=31&z;if(0!=(32&z)){for(var k=g+"["+n+"]\n",d=w(e,l),u=0;u<d.length;u++){k=k+y(e,c,d[u],g+"  ")}return k}else{var h=j(e,l);if(ASN1HEX.isASN1HEX(h)){var k=g+"["+n+"]\n";k=k+y(h,c,0,g+"  ");return k}else{if("68747470"==h.substr(0,8)){h=hextoutf8(h)}else{if("subjectAltName"===c.x509ExtName&&2==n){h=hextoutf8(h)}}}var k=g+"["+n+"] "+h+"\n";return k}}return g+"UNKNOWN("+z+") "+j(e,l)+"\n"};ASN1HEX.isContextTag=function(c,b){c=c.toLowerCase();var f,e;try{f=parseInt(c,16)}catch(d){return-1}if(b===void 0){if(128==(192&f)){return!0}else{return!1}}try{var a=b.match(/^\[[0-9]+\]$/);if(null==a){return!1}e=parseInt(b.substr(1,b.length-1),10);if(31<e){return!1}if(128==(192&f)&&(31&f)==e){return!0}return!1}catch(d){return!1}};ASN1HEX.isASN1HEX=function(e){var d=ASN1HEX;if(1==e.length%2){return!1}var c=d.getVblen(e,0),b=e.substr(0,2),f=d.getL(e,0),a=e.length-b.length-f.length;if(a==2*c){return!0}return!1};ASN1HEX.checkStrictDER=function(g,o,d,c,r){var s=ASN1HEX;if(d===void 0){if("string"!=typeof g){throw new Error("not hex string")}g=g.toLowerCase();if(!KJUR.lang.String.isHex(g)){throw new Error("not hex string")}d=g.length;c=g.length/2;if(128>c){r=1}else{r=Math.ceil(c.toString(16))+1}}var k=s.getL(g,o);if(k.length>2*r){throw new Error("L of TLV too long: idx="+o)}var n=s.getVblen(g,o);if(n>c){throw new Error("value of L too long than hex: idx="+o)}var q=s.getTLV(g,o),f=q.length-2-s.getL(g,o).length;if(f!==2*n){throw new Error("V string length and L's value not the same:"+f+"/"+2*n)}if(0===o){if(g.length!=q.length){throw new Error("total length and TLV length unmatch:"+g.length+"!="+q.length)}}var b=g.substr(o,2);if("02"===b){var a=s.getVidx(g,o);if("00"==g.substr(a,2)&&56>g.charCodeAt(a+2)){throw new Error("not least zeros for DER INTEGER")}}if(32&parseInt(b,16)){for(var p=s.getVblen(g,o),m=0,l=s.getChildIdx(g,o),e=0,j;e<l.length;e++){j=s.getTLV(g,l[e]);m+=j.length;s.checkStrictDER(g,l[e],d,c,r)}if(2*p!=m){throw new Error("sum of children's TLV length and L unmatch: "+2*p+"!="+m)}}};ASN1HEX.oidname=function(a){var c=KJUR.asn1;if(KJUR.lang.String.isHex(a)){a=c.ASN1Util.oidHexToInt(a)}var b=c.x509.OID.oid2name(a);if(""===b){b=a}return b};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.asn1||!KJUR.asn1){KJUR.asn1={}}if("undefined"==typeof KJUR.asn1.x509||!KJUR.asn1.x509){KJUR.asn1.x509={}}KJUR.asn1.x509.Certificate=function(h){KJUR.asn1.x509.Certificate.superclass.constructor.call(this);var d=KJUR,c=d.asn1,f=c.DERBitString,b=c.DERSequence,g=c.x509,a=g.TBSCertificate,e=g.AlgorithmIdentifier;this.params=void 0;this.setByParam=function(i){this.params=i};this.sign=function(){var l=this.params,k=l.sigalg;if(l.sigalg.name!=void 0){k=l.sigalg.name}var i=l.tbsobj.getEncodedHex(),j=new KJUR.crypto.Signature({alg:k});j.init(l.cakey);j.updateHex(i);l.sighex=j.sign()};this.getPEM=function(){return hextopem(this.getEncodedHex(),"CERTIFICATE")};this.getEncodedHex=function(){var k=this.params;if(k.tbsobj==void 0||null==k.tbsobj){k.tbsobj=new a(k)}if(k.sighex==void 0&&k.cakey!=void 0){this.sign()}if(k.sighex==void 0){throw new Error("sighex or cakey parameter not defined")}var i=[k.tbsobj,new e({name:k.sigalg}),new f({hex:"00"+k.sighex})],j=new b({array:i});return j.getEncodedHex()};if(h!=void 0){this.params=h}};extendClass(KJUR.asn1.x509.Certificate,KJUR.asn1.ASN1Object);KJUR.asn1.x509.TBSCertificate=function(f){KJUR.asn1.x509.TBSCertificate.superclass.constructor.call(this);var b=KJUR,i=b.asn1,d=i.x509,c=i.DERTaggedObject,h=i.DERInteger,g=i.DERSequence,l=d.AlgorithmIdentifier,e=d.Time,a=d.X500Name,j=d.Extensions,k=d.SubjectPublicKeyInfo;this.params=null;this.setByParam=function(m){this.params=m};this.getEncodedHex=function(){var n=[],q=this.params;if(q.version!=void 0||1!=q.version){var m=2;if(q.version!=void 0){m=q.version-1}var p=new c({obj:new h({int:m})});n.push(p)}n.push(new h(q.serial));n.push(new l({name:q.sigalg}));n.push(new a(q.issuer));n.push(new g({array:[new e(q.notbefore),new e(q.notafter)]}));n.push(new a(q.subject));n.push(new k(KEYUTIL.getKey(q.sbjpubkey)));if(q.ext!==void 0&&0<q.ext.length){n.push(new c({tag:"a3",obj:new j(q.ext)}))}var o=new KJUR.asn1.DERSequence({array:n});return o.getEncodedHex()};if(f!==void 0){this.setByParam(f)}};extendClass(KJUR.asn1.x509.TBSCertificate,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Extensions=function(d){KJUR.asn1.x509.Extensions.superclass.constructor.call(this);var c=KJUR,b=c.asn1,a=b.DERSequence,e=b.x509;this.aParam=[];this.setByParam=function(f){this.aParam=f};this.getEncodedHex=function(){for(var f=[],h=0;h<this.aParam.length;h++){var l=this.aParam[h],k=l.extname,j=null;if(l.extn!=void 0){j=new e.PrivateExtension(l)}else{if("subjectKeyIdentifier"==k){j=new e.SubjectKeyIdentifier(l)}else{if("keyUsage"==k){j=new e.KeyUsage(l)}else{if("subjectAltName"==k){j=new e.SubjectAltName(l)}else{if("issuerAltName"==k){j=new e.IssuerAltName(l)}else{if("basicConstraints"==k){j=new e.BasicConstraints(l)}else{if("cRLDistributionPoints"==k){j=new e.CRLDistributionPoints(l)}else{if("certificatePolicies"==k){j=new e.CertificatePolicies(l)}else{if("authorityKeyIdentifier"==k){j=new e.AuthorityKeyIdentifier(l)}else{if("extKeyUsage"==k){j=new e.ExtKeyUsage(l)}else{if("authorityInfoAccess"==k){j=new e.AuthorityInfoAccess(l)}else{if("cRLNumber"==k){j=new e.CRLNumber(l)}else{if("cRLReason"==k){j=new e.CRLReason(l)}else{if("ocspNonce"==k){j=new e.OCSPNonce(l)}else{if("ocspNoCheck"==k){j=new e.OCSPNoCheck(l)}else{if("adobeTimeStamp"==k){j=new e.AdobeTimeStamp(l)}else{if("subjectDirectoryAttributes"==k){j=new e.SubjectDirectoryAttributes(l)}else{throw new Error("extension not supported:"+JSON.stringify(l))}}}}}}}}}}}}}}}}}if(null!=j){f.push(j)}}var g=new a({array:f});return g.getEncodedHex()};if(d!=void 0){this.setByParam(d)}};extendClass(KJUR.asn1.x509.Extensions,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Extension=function(d){KJUR.asn1.x509.Extension.superclass.constructor.call(this);var a=KJUR,e=a.asn1,h=e.DERObjectIdentifier,i=e.DEROctetString,b=e.DERBitString,g=e.DERBoolean,c=e.DERSequence;this.getEncodedHex=function(){var m=new h({oid:this.oid}),l=new i({hex:this.getExtnValueHex()}),k=[];k.push(m);if(this.critical){k.push(new g)}k.push(l);var j=new c({array:k});return j.getEncodedHex()};this.critical=!1;if(d!==void 0){if(d.critical!==void 0){this.critical=d.critical}}};extendClass(KJUR.asn1.x509.Extension,KJUR.asn1.ASN1Object);KJUR.asn1.x509.KeyUsage=function(f){KJUR.asn1.x509.KeyUsage.superclass.constructor.call(this,f);var a=X509.KEYUSAGE_NAME;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.15";if(f!==void 0){if(f.bin!==void 0){this.asn1ExtnValue=new KJUR.asn1.DERBitString(f)}if(f.names!==void 0&&f.names.length!==void 0){for(var e=f.names,d="000000000",c=0;c<e.length;c++){for(var b=0;b<a.length;b++){if(e[c]===a[b]){d=d.substring(0,b)+"1"+d.substring(b+1,d.length)}}}this.asn1ExtnValue=new KJUR.asn1.DERBitString({bin:d})}}};extendClass(KJUR.asn1.x509.KeyUsage,KJUR.asn1.x509.Extension);KJUR.asn1.x509.BasicConstraints=function(g){KJUR.asn1.x509.BasicConstraints.superclass.constructor.call(this,g);var c=KJUR.asn1,e=c.DERBoolean,f=c.DERInteger,b=c.DERSequence;this.getExtnValueHex=function(){var i=[];if(this.cA){i.push(new e)}if(-1<this.pathLen){i.push(new f({int:this.pathLen}))}var h=new b({array:i});this.asn1ExtnValue=h;return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.19";this.cA=!1;this.pathLen=-1;if(g!==void 0){if(g.cA!==void 0){this.cA=g.cA}if(g.pathLen!==void 0){this.pathLen=g.pathLen}}};extendClass(KJUR.asn1.x509.BasicConstraints,KJUR.asn1.x509.Extension);KJUR.asn1.x509.CRLDistributionPoints=function(d){KJUR.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,d);var b=KJUR,a=b.asn1,c=a.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.setByDPArray=function(e){for(var f=[],g=0;g<e.length;g++){if(e[g]instanceof KJUR.asn1.ASN1Object){f.push(e[g])}else{var h=new c.DistributionPoint(e[g]);f.push(h)}}this.asn1ExtnValue=new a.DERSequence({array:f})};this.setByOneURI=function(f){var e=new c.DistributionPoint({fulluri:f});this.setByDPArray([e])};this.oid="2.5.29.31";if(d!==void 0){if(d.array!==void 0){this.setByDPArray(d.array)}else{if(d.uri!==void 0){this.setByOneURI(d.uri)}}}};extendClass(KJUR.asn1.x509.CRLDistributionPoints,KJUR.asn1.x509.Extension);KJUR.asn1.x509.DistributionPoint=function(e){KJUR.asn1.x509.DistributionPoint.superclass.constructor.call(this);var c=KJUR,b=c.asn1,d=b.x509.DistributionPointName;this.getEncodedHex=function(){var f=new b.DERSequence;if(null!=this.asn1DP){var g=new b.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});f.appendASN1Object(g)}this.hTLV=f.getEncodedHex();return this.hTLV};if(e!==void 0){if(e.dpobj!==void 0){this.asn1DP=e.dpobj}else{if(e.dpname!==void 0){this.asn1DP=new d(e.dpname)}else{if(e.fulluri!==void 0){this.asn1DP=new d({full:[{uri:e.fulluri}]})}}}}};extendClass(KJUR.asn1.x509.DistributionPoint,KJUR.asn1.ASN1Object);KJUR.asn1.x509.DistributionPointName=function(h){KJUR.asn1.x509.DistributionPointName.superclass.constructor.call(this);var c=KJUR,b=c.asn1,e=b.DERTaggedObject;this.getEncodedHex=function(){if("full"!=this.type){throw new Error("currently type shall be 'full': "+this.type)}this.asn1Obj=new e({explicit:!1,tag:this.tag,obj:this.asn1V});this.hTLV=this.asn1Obj.getEncodedHex();return this.hTLV};if(h!==void 0){if(b.x509.GeneralNames.prototype.isPrototypeOf(h)){this.type="full";this.tag="a0";this.asn1V=h}else{if(h.full!==void 0){this.type="full";this.tag="a0";this.asn1V=new b.x509.GeneralNames(h.full)}else{throw new Error("This class supports GeneralNames only as argument")}}}};extendClass(KJUR.asn1.x509.DistributionPointName,KJUR.asn1.ASN1Object);KJUR.asn1.x509.CertificatePolicies=function(f){KJUR.asn1.x509.CertificatePolicies.superclass.constructor.call(this,f);var c=KJUR,b=c.asn1,e=b.x509,a=b.DERSequence,d=e.PolicyInformation;this.params=null;this.getExtnValueHex=function(){for(var j=[],h=0;h<this.params.array.length;h++){j.push(new d(this.params.array[h]))}var g=new a({array:j});this.asn1ExtnValue=g;return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.32";if(f!==void 0){this.params=f}};extendClass(KJUR.asn1.x509.CertificatePolicies,KJUR.asn1.x509.Extension);KJUR.asn1.x509.PolicyInformation=function(d){KJUR.asn1.x509.PolicyInformation.superclass.constructor.call(this,d);var c=KJUR.asn1,b=c.DERSequence,e=c.DERObjectIdentifier,a=c.x509.PolicyQualifierInfo;this.params=null;this.getEncodedHex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0){throw new Error("parameter oid and array missing")}var f=[new e(this.params.policyoid)];if(this.params.array!==void 0){for(var j=[],h=0;h<this.params.array.length;h++){j.push(new a(this.params.array[h]))}if(0<j.length){f.push(new b({array:j}))}}var g=new b({array:f});return g.getEncodedHex()};if(d!==void 0){this.params=d}};extendClass(KJUR.asn1.x509.PolicyInformation,KJUR.asn1.ASN1Object);KJUR.asn1.x509.PolicyQualifierInfo=function(e){KJUR.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var c=KJUR.asn1,b=c.DERSequence,d=c.DERIA5String,f=c.DERObjectIdentifier,a=c.x509.UserNotice;this.params=null;this.getEncodedHex=function(){if(this.params.cps!==void 0){var g=new b({array:[new f({oid:"1.3.6.1.5.5.7.2.1"}),new d({str:this.params.cps})]});return g.getEncodedHex()}if(this.params.unotice!=void 0){var g=new b({array:[new f({oid:"1.3.6.1.5.5.7.2.2"}),new a(this.params.unotice)]});return g.getEncodedHex()}};if(e!==void 0){this.params=e}};extendClass(KJUR.asn1.x509.PolicyQualifierInfo,KJUR.asn1.ASN1Object);KJUR.asn1.x509.UserNotice=function(e){KJUR.asn1.x509.UserNotice.superclass.constructor.call(this,e);var a=KJUR.asn1.DERSequence,d=KJUR.asn1.DERInteger,c=KJUR.asn1.x509.DisplayText,b=KJUR.asn1.x509.NoticeReference;this.params=null;this.getEncodedHex=function(){var f=[];if(this.params.noticeref!==void 0){f.push(new b(this.params.noticeref))}if(this.params.exptext!==void 0){f.push(new c(this.params.exptext))}var g=new a({array:f});return g.getEncodedHex()};if(e!==void 0){this.params=e}};extendClass(KJUR.asn1.x509.UserNotice,KJUR.asn1.ASN1Object);KJUR.asn1.x509.NoticeReference=function(d){KJUR.asn1.x509.NoticeReference.superclass.constructor.call(this,d);var a=KJUR.asn1.DERSequence,c=KJUR.asn1.DERInteger,b=KJUR.asn1.x509.DisplayText;this.params=null;this.getEncodedHex=function(){var f=[];if(this.params.org!==void 0){f.push(new b(this.params.org))}if(this.params.noticenum!==void 0){for(var h=[],e=this.params.noticenum,j=0;j<e.length;j++){h.push(new c(e[j]))}f.push(new a({array:h}))}if(0==f.length){throw new Error("parameter is empty")}var g=new a({array:f});return g.getEncodedHex()};if(d!==void 0){this.params=d}};extendClass(KJUR.asn1.x509.NoticeReference,KJUR.asn1.ASN1Object);KJUR.asn1.x509.DisplayText=function(a){KJUR.asn1.x509.DisplayText.superclass.constructor.call(this,a);this.hT="0c";if(a!==void 0){if("ia5"===a.type){this.hT="16"}else{if("vis"===a.type){this.hT="1a"}else{if("bmp"===a.type){this.hT="1e"}}}}};extendClass(KJUR.asn1.x509.DisplayText,KJUR.asn1.DERAbstractString);KJUR.asn1.x509.ExtKeyUsage=function(c){KJUR.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,c);var b=KJUR,a=b.asn1;this.setPurposeArray=function(d){this.asn1ExtnValue=new a.DERSequence;for(var e=0,f;e<d.length;e++){f=new a.DERObjectIdentifier(d[e]);this.asn1ExtnValue.appendASN1Object(f)}};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.37";if(c!==void 0){if(c.array!==void 0){this.setPurposeArray(c.array)}}};extendClass(KJUR.asn1.x509.ExtKeyUsage,KJUR.asn1.x509.Extension);KJUR.asn1.x509.AuthorityKeyIdentifier=function(f){KJUR.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,f);var b=KJUR,a=b.asn1,d=a.DERTaggedObject,e=a.x509.GeneralNames,c=b.crypto.Util.isKey;this.asn1KID=null;this.asn1CertIssuer=null;this.asn1CertSN=null;this.getExtnValueHex=function(){var h=[];if(this.asn1KID){h.push(new d({explicit:!1,tag:"80",obj:this.asn1KID}))}if(this.asn1CertIssuer){h.push(new d({explicit:!1,tag:"a1",obj:new e([{dn:this.asn1CertIssuer}])}))}if(this.asn1CertSN){h.push(new d({explicit:!1,tag:"82",obj:this.asn1CertSN}))}var g=new a.DERSequence({array:h});this.asn1ExtnValue=g;return this.asn1ExtnValue.getEncodedHex()};this.setKIDByParam=function(i){if(i.str!==void 0||i.hex!==void 0){this.asn1KID=new KJUR.asn1.DEROctetString(i)}else{if("object"===typeof i&&KJUR.crypto.Util.isKey(i)||"string"===typeof i&&-1!=i.indexOf("BEGIN ")){var h=i;if("string"===typeof i){h=KEYUTIL.getKey(i)}var g=KEYUTIL.getKeyID(h);this.asn1KID=new KJUR.asn1.DEROctetString({hex:g})}}};this.setCertIssuerByParam=function(g){if(g.str!==void 0||g.ldapstr!==void 0||g.hex!==void 0||g.certsubject!==void 0||g.certissuer!==void 0){this.asn1CertIssuer=new KJUR.asn1.x509.X500Name(g)}else{if("string"===typeof g&&-1!=g.indexOf("BEGIN ")&&-1!=g.indexOf("CERTIFICATE")){this.asn1CertIssuer=new KJUR.asn1.x509.X500Name({certissuer:g})}}};this.setCertSNByParam=function(i){if(i.str!==void 0||i.bigint!==void 0||i.hex!==void 0){this.asn1CertSN=new KJUR.asn1.DERInteger(i)}else{if("string"===typeof i&&-1!=i.indexOf("BEGIN ")&&i.indexOf("CERTIFICATE")){var g=new X509;g.readCertPEM(i);var h=g.getSerialNumberHex();this.asn1CertSN=new KJUR.asn1.DERInteger({hex:h})}}};this.oid="2.5.29.35";if(f!==void 0){if(f.kid!==void 0){this.setKIDByParam(f.kid)}if(f.issuer!==void 0){this.setCertIssuerByParam(f.issuer)}if(f.sn!==void 0){this.setCertSNByParam(f.sn)}if(f.issuersn!==void 0&&"string"===typeof f.issuersn&&-1!=f.issuersn.indexOf("BEGIN ")&&f.issuersn.indexOf("CERTIFICATE")){this.setCertSNByParam(f.issuersn);this.setCertIssuerByParam(f.issuersn)}}};extendClass(KJUR.asn1.x509.AuthorityKeyIdentifier,KJUR.asn1.x509.Extension);KJUR.asn1.x509.SubjectKeyIdentifier=function(d){KJUR.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,d);var b=KJUR,a=b.asn1,c=a.DEROctetString;this.asn1KID=null;this.getExtnValueHex=function(){this.asn1ExtnValue=this.asn1KID;return this.asn1ExtnValue.getEncodedHex()};this.setKIDByParam=function(g){if(g.str!==void 0||g.hex!==void 0){this.asn1KID=new c(g)}else{if("object"===typeof g&&KJUR.crypto.Util.isKey(g)||"string"===typeof g&&-1!=g.indexOf("BEGIN")){var f=g;if("string"===typeof g){f=KEYUTIL.getKey(g)}var e=KEYUTIL.getKeyID(f);this.asn1KID=new KJUR.asn1.DEROctetString({hex:e})}}};this.oid="2.5.29.14";if(d!==void 0){if(d.kid!==void 0){this.setKIDByParam(d.kid)}}};extendClass(KJUR.asn1.x509.SubjectKeyIdentifier,KJUR.asn1.x509.Extension);KJUR.asn1.x509.AuthorityInfoAccess=function(a){KJUR.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,a);this.setAccessDescriptionArray=function(k){for(var d=[],b=KJUR,g=b.asn1,c=g.DERSequence,j=g.DERObjectIdentifier,l=g.x509.GeneralName,f=0;f<k.length;f++){var e,h=k[f];if(h.ocsp!==void 0){e=new c({array:[new j({oid:"1.3.6.1.5.5.7.48.1"}),new l({uri:h.ocsp})]})}else{if(h.caissuer!==void 0){e=new c({array:[new j({oid:"1.3.6.1.5.5.7.48.2"}),new l({uri:h.caissuer})]})}else{throw new Error("unknown AccessMethod parameter: "+JSON.stringify(h))}}d.push(e)}this.asn1ExtnValue=new c({array:d})};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="1.3.6.1.5.5.7.1.1";if(a!==void 0){if(a.array!==void 0){this.setAccessDescriptionArray(a.array)}}};extendClass(KJUR.asn1.x509.AuthorityInfoAccess,KJUR.asn1.x509.Extension);KJUR.asn1.x509.SubjectAltName=function(a){KJUR.asn1.x509.SubjectAltName.superclass.constructor.call(this,a);this.setNameArray=function(b){this.asn1ExtnValue=new KJUR.asn1.x509.GeneralNames(b)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.17";if(a!==void 0){if(a.array!==void 0){this.setNameArray(a.array)}}};extendClass(KJUR.asn1.x509.SubjectAltName,KJUR.asn1.x509.Extension);KJUR.asn1.x509.IssuerAltName=function(a){KJUR.asn1.x509.IssuerAltName.superclass.constructor.call(this,a);this.setNameArray=function(b){this.asn1ExtnValue=new KJUR.asn1.x509.GeneralNames(b)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.18";if(a!==void 0){if(a.array!==void 0){this.setNameArray(a.array)}}};extendClass(KJUR.asn1.x509.IssuerAltName,KJUR.asn1.x509.Extension);KJUR.asn1.x509.SubjectDirectoryAttributes=function(e){KJUR.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var c=KJUR.asn1,a=c.DERSequence,b=c.ASN1Util.newObject,d=c.x509.OID.name2oid;this.params=null;this.getExtnValueHex=function(){for(var f=[],j=0;j<this.params.array.length;j++){var k=this.params.array[j],h={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if("dateOfBirth"==k.attr){h.seq[0].oid=d(k.attr);h.seq[1].set[0]={gentime:k.str}}else{if("placeOfBirth"==k.attr){h.seq[0].oid=d(k.attr);h.seq[1].set[0]={utf8str:k.str}}else{if("gender"==k.attr){h.seq[0].oid=d(k.attr);h.seq[1].set[0]={prnstr:k.str}}else{if("countryOfCitizenship"==k.attr){h.seq[0].oid=d(k.attr);h.seq[1].set[0]={prnstr:k.str}}else{if("countryOfResidence"==k.attr){h.seq[0].oid=d(k.attr);h.seq[1].set[0]={prnstr:k.str}}else{throw new Error("unsupported attribute: "+k.attr)}}}}}f.push(new b(h))}var g=new a({array:f});this.asn1ExtnValue=g;return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.9";if(e!==void 0){this.params=e}};extendClass(KJUR.asn1.x509.SubjectDirectoryAttributes,KJUR.asn1.x509.Extension);KJUR.asn1.x509.PrivateExtension=function(f){KJUR.asn1.x509.PrivateExtension.superclass.constructor.call(this,f);var c=KJUR,e=c.lang.String.isHex,b=c.asn1,d=b.x509.OID.name2oid,a=b.ASN1Util.newObject;this.params=null;this.setByParam=function(g){this.oid=d(g.extname);this.params=g};this.getExtnValueHex=function(){if(this.params.extname==void 0||this.params.extn==void 0){throw new Error("extname or extnhex not specified")}var h=this.params.extn;if("string"==typeof h&&e(h)){return h}else{if("object"==typeof h){try{return a(h).getEncodedHex()}catch(g){}}}throw new Error("unsupported extn value")};if(f!=void 0){this.setByParam(f)}};extendClass(KJUR.asn1.x509.PrivateExtension,KJUR.asn1.x509.Extension);KJUR.asn1.x509.CRL=function(g){KJUR.asn1.x509.CRL.superclass.constructor.call(this);var c=KJUR,b=c.asn1,a=b.DERSequence,e=b.DERBitString,f=b.x509,d=f.AlgorithmIdentifier,h=f.TBSCertList;this.params=void 0;this.setByParam=function(i){this.params=i};this.sign=function(){var j=new h(this.params).getEncodedHex(),k=new KJUR.crypto.Signature({alg:this.params.sigalg});k.init(this.params.cakey);k.updateHex(j);var i=k.sign();this.params.sighex=i};this.getPEM=function(){return hextopem(this.getEncodedHex(),"X509 CRL")};this.getEncodedHex=function(){var k=this.params;if(k.tbsobj==void 0){k.tbsobj=new h(k)}if(k.sighex==void 0&&k.cakey!=void 0){this.sign()}if(k.sighex==void 0){throw new Error("sighex or cakey parameter not defined")}var i=[k.tbsobj,new d({name:k.sigalg}),new e({hex:"00"+k.sighex})],j=new a({array:i});return j.getEncodedHex()};if(g!=void 0){this.params=g}};extendClass(KJUR.asn1.x509.CRL,KJUR.asn1.ASN1Object);KJUR.asn1.x509.TBSCertList=function(f){KJUR.asn1.x509.TBSCertList.superclass.constructor.call(this);var b=KJUR,i=b.asn1,h=i.DERInteger,g=i.DERSequence,c=i.DERTaggedObject,k=i.DERObjectIdentifier,d=i.x509,l=d.AlgorithmIdentifier,e=d.Time,j=d.Extensions,a=d.X500Name;this.params=null;this.setByParam=function(m){this.params=m};this.getRevCertSequence=function(){for(var m=[],n=this.params.revcert,o=0,p;o<n.length;o++){p=[new h(n[o].sn),new e(n[o].date)];if(n[o].ext!=void 0){p.push(new j(n[o].ext))}m.push(new g({array:p}))}return new g({array:m})};this.getEncodedHex=function(){var n=[],r=this.params;if(r.version!=void 0){var m=r.version-1,p=new h({int:m});n.push(p)}n.push(new l({name:r.sigalg}));n.push(new a(r.issuer));n.push(new e(r.thisupdate));if(r.nextupdate!=void 0){n.push(new e(r.nextupdate))}if(r.revcert!=void 0){n.push(this.getRevCertSequence())}if(r.ext!=void 0){var q=new j(r.ext);n.push(new c({tag:"a0",explicit:!0,obj:q}))}var o=new g({array:n});return o.getEncodedHex()};if(f!==void 0){this.setByParam(f)}};extendClass(KJUR.asn1.x509.TBSCertList,KJUR.asn1.ASN1Object);KJUR.asn1.x509.CRLEntry=function(e){KJUR.asn1.x509.CRLEntry.superclass.constructor.call(this);var b=KJUR,a=b.asn1;this.setCertSerial=function(f){this.sn=new a.DERInteger(f)};this.setRevocationDate=function(f){this.time=new a.x509.Time(f)};this.getEncodedHex=function(){var f=new a.DERSequence({array:[this.sn,this.time]});this.TLV=f.getEncodedHex();return this.TLV};if(e!==void 0){if(e.time!==void 0){this.setRevocationDate(e.time)}if(e.sn!==void 0){this.setCertSerial(e.sn)}}};extendClass(KJUR.asn1.x509.CRLEntry,KJUR.asn1.ASN1Object);KJUR.asn1.x509.CRLNumber=function(a){KJUR.asn1.x509.CRLNumber.superclass.constructor.call(this,a);this.params=void 0;this.getExtnValueHex=function(){this.asn1ExtnValue=new KJUR.asn1.DERInteger(this.params.num);return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.20";if(a!=void 0){this.params=a}};extendClass(KJUR.asn1.x509.CRLNumber,KJUR.asn1.x509.Extension);KJUR.asn1.x509.CRLReason=function(a){KJUR.asn1.x509.CRLReason.superclass.constructor.call(this,a);this.params=void 0;this.getExtnValueHex=function(){this.asn1ExtnValue=new KJUR.asn1.DEREnumerated(this.params.code);return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.21";if(a!=void 0){this.params=a}};extendClass(KJUR.asn1.x509.CRLReason,KJUR.asn1.x509.Extension);KJUR.asn1.x509.OCSPNonce=function(a){KJUR.asn1.x509.OCSPNonce.superclass.constructor.call(this,a);this.params=void 0;this.getExtnValueHex=function(){this.asn1ExtnValue=new KJUR.asn1.DEROctetString(this.params);return this.asn1ExtnValue.getEncodedHex()};this.oid="1.3.6.1.5.5.7.48.1.2";if(a!=void 0){this.params=a}};extendClass(KJUR.asn1.x509.OCSPNonce,KJUR.asn1.x509.Extension);KJUR.asn1.x509.OCSPNoCheck=function(a){KJUR.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,a);this.params=void 0;this.getExtnValueHex=function(){this.asn1ExtnValue=new KJUR.asn1.DERNull;return this.asn1ExtnValue.getEncodedHex()};this.oid="1.3.6.1.5.5.7.48.1.5";if(a!=void 0){this.params=a}};extendClass(KJUR.asn1.x509.OCSPNoCheck,KJUR.asn1.x509.Extension);KJUR.asn1.x509.AdobeTimeStamp=function(g){KJUR.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,g);var c=KJUR,b=c.asn1,f=b.DERInteger,d=b.DERBoolean,a=b.DERSequence,e=b.x509.GeneralName;this.params=null;this.getExtnValueHex=function(){var i=this.params,h=[new f(1)];h.push(new e({uri:i.uri}));if(i.reqauth!=void 0){h.push(new d(i.reqauth))}this.asn1ExtnValue=new a({array:h});return this.asn1ExtnValue.getEncodedHex()};this.oid="1.2.840.113583.1.1.9.1";if(g!==void 0){this.setByParam(g)}};extendClass(KJUR.asn1.x509.AdobeTimeStamp,KJUR.asn1.x509.Extension);KJUR.asn1.x509.X500Name=function(f){KJUR.asn1.x509.X500Name.superclass.constructor.call(this);this.asn1Array=[];this.paramArray=[];this.sRule="utf8";var c=KJUR,b=c.asn1,e=b.x509,d=e.RDN;this.setByString=function(g,l){if(l!==void 0){this.sRule=l}var k=g.split("/");k.shift();for(var j=[],m=0;m<k.length;m++){if(k[m].match(/^[^=]+=.+$/)){j.push(k[m])}else{var h=j.length-1;j[h]=j[h]+"/"+k[m]}}for(var m=0;m<j.length;m++){this.asn1Array.push(new d({str:j[m],rule:this.sRule}))}};this.setByLdapString=function(g,h){if(h!==void 0){this.sRule=h}var i=e.X500Name.ldapToCompat(g);this.setByString(i,h)};this.setByObject=function(j,i){if(i!==void 0){this.sRule=i}for(var g in j){if(j.hasOwnProperty(g)){var h=new d({str:g+"="+j[g],rule:this.sRule});this.asn1Array?this.asn1Array.push(h):this.asn1Array=[h]}}};this.setByParam=function(h){if(h.rule!==void 0){this.sRule=h.rule}if(h.array!==void 0){this.paramArray=h.array}else{if(h.str!==void 0){this.setByString(h.str)}else{if(h.ldapstr!==void 0){this.setByLdapString(h.ldapstr)}else{if(h.hex!==void 0){this.hTLV=h.hex}else{if(h.certissuer!==void 0){var g=new X509;g.readCertPEM(h.certissuer);this.hTLV=g.getIssuerHex()}else{if(h.certsubject!==void 0){var g=new X509;g.readCertPEM(h.certsubject);this.hTLV=g.getSubjectHex()}else{if("object"===typeof h&&h.certsubject===void 0&&h.certissuer===void 0){this.setByObject(h)}}}}}}}};this.getEncodedHex=function(){if("string"==typeof this.hTLV){return this.hTLV}if(0==this.asn1Array.length&&0<this.paramArray.length){for(var g=0,k;g<this.paramArray.length;g++){k={array:this.paramArray[g]};if("utf8"!=this.sRule){k.rule=this.sRule}var h=new d(k);this.asn1Array.push(h)}}var j=new b.DERSequence({array:this.asn1Array});this.hTLV=j.getEncodedHex();return this.hTLV};if(f!==void 0){this.setByParam(f)}};extendClass(KJUR.asn1.x509.X500Name,KJUR.asn1.ASN1Object);KJUR.asn1.x509.X500Name.compatToLDAP=function(d){if("/"!==d.substr(0,1)){throw"malformed input"}d=d.substr(1);var c=d.split("/");c.reverse();c=c.map(function(a){return a.replace(/,/,"\\,")});return c.join(",")};KJUR.asn1.x509.X500Name.onelineToLDAP=function(a){return KJUR.asn1.x509.X500Name.compatToLDAP(a)};KJUR.asn1.x509.X500Name.ldapToCompat=function(g){for(var c=g.split(","),e=!1,b=[],f=0,h;0<c.length;f++){h=c.shift();if(!0===e){var d=b.pop(),j=(d+","+h).replace(/\\,/g,",");b.push(j);e=!1}else{b.push(h)}if("\\"===h.substr(-1,1)){e=!0}}b=b.map(function(a){return a.replace("/","\\/")});b.reverse();return"/"+b.join("/")};KJUR.asn1.x509.X500Name.ldapToOneline=function(a){return KJUR.asn1.x509.X500Name.ldapToCompat(a)};KJUR.asn1.x509.RDN=function(b){KJUR.asn1.x509.RDN.superclass.constructor.call(this);this.asn1Array=[];this.paramArray=[];this.sRule="utf8";var a=KJUR.asn1.x509.AttributeTypeAndValue;this.setByParam=function(c){if(c.rule!==void 0){this.sRule=c.rule}if(c.str!==void 0){this.addByMultiValuedString(c.str)}if(c.array!==void 0){this.paramArray=c.array}};this.addByString=function(c){this.asn1Array.push(new KJUR.asn1.x509.AttributeTypeAndValue({str:c,rule:this.sRule}))};this.addByMultiValuedString=function(e){for(var c=KJUR.asn1.x509.RDN.parseString(e),d=0;d<c.length;d++){this.addByString(c[d])}};this.getEncodedHex=function(){if(0==this.asn1Array.length&&0<this.paramArray.length){for(var d=0,f;d<this.paramArray.length;d++){f=this.paramArray[d];if(f.rule!==void 0&&"utf8"!=this.sRule){f.rule=this.sRule}var c=new a(f);this.asn1Array.push(c)}}var e=new KJUR.asn1.DERSet({array:this.asn1Array});this.TLV=e.getEncodedHex();return this.TLV};if(b!==void 0){this.setByParam(b)}};extendClass(KJUR.asn1.x509.RDN,KJUR.asn1.ASN1Object);KJUR.asn1.x509.RDN.parseString=function(m){for(var j=m.split(/\+/),h=!1,c=[],g=0,k;0<j.length;g++){k=j.shift();if(!0===h){var f=c.pop(),d=(f+"+"+k).replace(/\\\+/g,"+");c.push(d);h=!1}else{c.push(k)}if("\\"===k.substr(-1,1)){h=!0}}for(var l=!1,b=[],g=0,k;0<c.length;g++){k=c.shift();if(!0===l){var e=b.pop();if(k.match(/"$/)){var d=(e+"+"+k).replace(/^([^=]+)="(.*)"$/,"$1=$2");b.push(d);l=!1}else{b.push(e+"+"+k)}}else{b.push(k)}if(k.match(/^[^=]+="/)){l=!0}}return b};KJUR.asn1.x509.AttributeTypeAndValue=function(c){KJUR.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);this.sRule="utf8";this.sType=null;this.sValue=null;this.dsType=null;var a=KJUR,g=a.asn1,d=g.DERSequence,l=g.DERUTF8String,i=g.DERPrintableString,h=g.DERTeletexString,b=g.DERIA5String,e=g.DERVisibleString,k=g.DERBMPString,f=a.lang.String.isMail,j=a.lang.String.isPrintable;this.setByParam=function(o){if(o.rule!==void 0){this.sRule=o.rule}if(o.ds!==void 0){this.dsType=o.ds}if(o.value===void 0&&o.str!==void 0){var n=o.str,m=n.match(/^([^=]+)=(.+)$/);if(m){this.sType=m[1];this.sValue=m[2]}else{throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}}else{this.sType=o.type;this.sValue=o.value}};this.setByString=function(n,o){if(o!==void 0){this.sRule=o}var m=n.match(/^([^=]+)=(.+)$/);if(m){this.setByAttrTypeAndValueStr(m[1],m[2])}else{throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}};this._getDsType=function(){var o=this.sType,n=this.sValue,m=this.sRule;if("prn"===m){if("CN"==o&&f(n)){return"ia5"}if(j(n)){return"prn"}return"utf8"}else{if("utf8"===m){if("CN"==o&&f(n)){return"ia5"}if("C"==o){return"prn"}return"utf8"}}return"utf8"};this.setByAttrTypeAndValueStr=function(o,n,m){if(m!==void 0){this.sRule=m}this.sType=o;this.sValue=n};this.getValueObj=function(n,m){if("utf8"==n){return new l({str:m})}if("prn"==n){return new i({str:m})}if("tel"==n){return new h({str:m})}if("ia5"==n){return new b({str:m})}if("vis"==n){return new e({str:m})}if("bmp"==n){return new k({str:m})}throw new Error("unsupported directory string type: type="+n+" value="+m)};this.getEncodedHex=function(){if(null==this.dsType){this.dsType=this._getDsType()}var n=KJUR.asn1.x509.OID.atype2obj(this.sType),m=this.getValueObj(this.dsType,this.sValue),p=new d({array:[n,m]});this.TLV=p.getEncodedHex();return this.TLV};if(c!==void 0){this.setByParam(c)}};extendClass(KJUR.asn1.x509.AttributeTypeAndValue,KJUR.asn1.ASN1Object);KJUR.asn1.x509.SubjectPublicKeyInfo=function(f){KJUR.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var a=KJUR,j=a.asn1,i=j.DERInteger,b=j.DERBitString,m=j.DERObjectIdentifier,e=j.DERSequence,h=j.ASN1Util.newObject,d=j.x509,o=d.AlgorithmIdentifier,g=a.crypto,n=g.ECDSA,c=g.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey){throw"algId and/or subjPubKey not set"}var p=new e({array:[this.asn1AlgId,this.asn1SubjPKey]});return p};this.getEncodedHex=function(){var p=this.getASN1Object();this.hTLV=p.getEncodedHex();return this.hTLV};this.setPubKey=function(q){try{if(q instanceof RSAKey){var u=h({seq:[{int:{bigint:q.n}},{int:{int:q.e}}]}),s=u.getEncodedHex();this.asn1AlgId=new o({name:"rsaEncryption"});this.asn1SubjPKey=new b({hex:"00"+s})}}catch(p){}try{if(q instanceof KJUR.crypto.ECDSA){var r=new m({name:q.curveName});this.asn1AlgId=new o({name:"ecPublicKey",asn1params:r});this.asn1SubjPKey=new b({hex:"00"+q.pubKeyHex})}}catch(p){}try{if(q instanceof KJUR.crypto.DSA){var r=new h({seq:[{int:{bigint:q.p}},{int:{bigint:q.q}},{int:{bigint:q.g}}]});this.asn1AlgId=new o({name:"dsa",asn1params:r});var t=new i({bigint:q.y});this.asn1SubjPKey=new b({hex:"00"+t.getEncodedHex()})}}catch(p){}};if(f!==void 0){this.setPubKey(f)}};extendClass(KJUR.asn1.x509.SubjectPublicKeyInfo,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Time=function(f){KJUR.asn1.x509.Time.superclass.constructor.call(this);var d=KJUR,c=d.asn1,b=c.DERUTCTime,g=c.DERGeneralizedTime;this.setTimeParams=function(h){this.timeParams=h};this.getEncodedHex=function(){var h=null;if(null!=this.timeParams){if("utc"==this.type){h=new b(this.timeParams)}else{h=new g(this.timeParams)}}else{if("utc"==this.type){h=new b}else{h=new g}}this.TLV=h.getEncodedHex();return this.TLV};this.type="utc";if(f!==void 0){if(f.type!==void 0){this.type=f.type}else{if(f.str!==void 0){if(f.str.match(/^[0-9]{12}Z$/)){this.type="utc"}if(f.str.match(/^[0-9]{14}Z$/)){this.type="gen"}}}this.timeParams=f}};extendClass(KJUR.asn1.x509.Time,KJUR.asn1.ASN1Object);KJUR.asn1.x509.AlgorithmIdentifier=function(e){KJUR.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);this.nameAlg=null;this.asn1Alg=null;this.asn1Params=null;this.paramEmpty=!1;var b=KJUR,a=b.asn1,c=a.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg){throw new Error("algorithm not specified")}if(null!==this.nameAlg){var f=null;for(var h in c){if(h===this.nameAlg){f=c[h]}}if(null!==f){this.hTLV=f;return this.hTLV}}if(null!==this.nameAlg&&null===this.asn1Alg){this.asn1Alg=a.x509.OID.name2obj(this.nameAlg)}var g=[this.asn1Alg];if(null!==this.asn1Params){g.push(this.asn1Params)}var i=new a.DERSequence({array:g});this.hTLV=i.getEncodedHex();return this.hTLV};if(e!==void 0){if(e.name!==void 0){this.nameAlg=e.name}if(e.asn1params!==void 0){this.asn1Params=e.asn1params}if(e.paramempty!==void 0){this.paramEmpty=e.paramempty}}if(null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){if(this.nameAlg.name!==void 0){this.nameAlg=this.nameAlg.name}var d=this.nameAlg.toLowerCase();if("withdsa"!==d.substr(-7,7)&&"withecdsa"!==d.substr(-9,9)){this.asn1Params=new a.DERNull}}};extendClass(KJUR.asn1.x509.AlgorithmIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};KJUR.asn1.x509.GeneralName=function(e){KJUR.asn1.x509.GeneralName.superclass.constructor.call(this);var k={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},b=KJUR,g=b.asn1,f=g.DERSequence,j=g.DEROctetString,d=g.DERIA5String,c=g.DERTaggedObject,l=g.ASN1Object,a=g.x509.X500Name,h=pemtohex;this.explicit=!1;this.setByParam=function(p){var u=null;if(p===void 0){return}if(p.rfc822!==void 0){this.type="rfc822";u=new d({str:p[this.type]})}if(p.dns!==void 0){this.type="dns";u=new d({str:p[this.type]})}if(p.uri!==void 0){this.type="uri";u=new d({str:p[this.type]})}if(p.dn!==void 0){this.type="dn";this.explicit=!0;if("string"===typeof p.dn){u=new a({str:p.dn})}else{if(p.dn instanceof KJUR.asn1.x509.X500Name){u=p.dn}else{u=new a(p.dn)}}}if(p.ldapdn!==void 0){this.type="dn";this.explicit=!0;u=new a({ldapstr:p.ldapdn})}if(p.certissuer!==void 0){this.type="dn";this.explicit=!0;var o=p.certissuer,w=null;if(o.match(/^[0-9A-Fa-f]+$/)){}if(-1!=o.indexOf("-----BEGIN ")){w=h(o)}if(null==w){throw"certissuer param not cert"}var t=new X509;t.hex=w;var y=t.getIssuerHex();u=new l;u.hTLV=y}if(p.certsubj!==void 0){this.type="dn";this.explicit=!0;var o=p.certsubj,w=null;if(o.match(/^[0-9A-Fa-f]+$/)){}if(-1!=o.indexOf("-----BEGIN ")){w=h(o)}if(null==w){throw"certsubj param not cert"}var t=new X509;t.hex=w;var y=t.getSubjectHex();u=new l;u.hTLV=y}if(p.ip!==void 0){this.type="ip";this.explicit=!1;var q=p.ip,s,n="malformed IP address";if(q.match(/^[0-9.]+[.][0-9.]+$/)){s=intarystrtohex("["+q.split(".").join(",")+"]");if(8!==s.length){throw n}}else{if(q.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/)){s=ipv6tohex(q)}else{if(q.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/)){s=q}else{throw n}}}u=new j({hex:s})}if(null==this.type){throw"unsupported type in params="+p}this.asn1Obj=new c({explicit:this.explicit,tag:k[this.type],obj:u})};this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()};if(e!==void 0){this.setByParam(e)}};extendClass(KJUR.asn1.x509.GeneralName,KJUR.asn1.ASN1Object);KJUR.asn1.x509.GeneralNames=function(d){KJUR.asn1.x509.GeneralNames.superclass.constructor.call(this);var c=KJUR,b=c.asn1;this.setByParamArray=function(g){for(var e=0,f;e<g.length;e++){f=new b.x509.GeneralName(g[e]);this.asn1Array.push(f)}};this.getEncodedHex=function(){var e=new b.DERSequence({array:this.asn1Array});return e.getEncodedHex()};this.asn1Array=[];if("undefined"!=typeof d){this.setByParamArray(d)}};extendClass(KJUR.asn1.x509.GeneralNames,KJUR.asn1.ASN1Object);KJUR.asn1.x509.OID=new function(){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"};this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1"};this.objCache={};this.name2obj=function(b){if("undefined"!=typeof this.objCache[b]){return this.objCache[b]}if("undefined"==typeof this.name2oidList[b]){throw"Name of ObjectIdentifier not defined: "+b}var c=this.name2oidList[b],d=new KJUR.asn1.DERObjectIdentifier({oid:c});this.objCache[b]=d;return d};this.atype2obj=function(b){if(this.objCache[b]!==void 0){return this.objCache[b]}var c;if(b.match(/^\d+\.\d+\.[0-9.]+$/)){c=b}else{if(this.atype2oidList[b]!==void 0){c=this.atype2oidList[b]}else{if(this.name2oidList[b]!==void 0){c=this.name2oidList[b]}else{throw"AttributeType name undefined: "+b}}}var d=new KJUR.asn1.DERObjectIdentifier({oid:c});this.objCache[b]=d;return d}};KJUR.asn1.x509.OID.oid2name=function(b){var c=KJUR.asn1.x509.OID.name2oidList;for(var a in c){if(c[a]==b){return a}}return""};KJUR.asn1.x509.OID.oid2atype=function(b){var c=KJUR.asn1.x509.OID.atype2oidList;for(var a in c){if(c[a]==b){return a}}return b};KJUR.asn1.x509.OID.name2oid=function(a){if(a.match(/^[0-9.]+$/)){return a}var b=KJUR.asn1.x509.OID.name2oidList;if(b[a]===void 0){return""}return b[a]};KJUR.asn1.x509.X509Util={};KJUR.asn1.x509.X509Util.newCertPEM=function(e){var d=KJUR.asn1.x509,b=d.TBSCertificate,a=d.Certificate,c=new a(e);return c.getPEM()};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.asn1||!KJUR.asn1){KJUR.asn1={}}if("undefined"==typeof KJUR.asn1.cms||!KJUR.asn1.cms){KJUR.asn1.cms={}}KJUR.asn1.cms.Attribute=function(){var e=Error,d=KJUR,c=d.asn1,b=c.DERSequence,a=c.DERSet,g=c.DERObjectIdentifier;this.params=null;this.typeOid=null;this.setByParam=function(h){this.params=h};this.getValueArray=function(){throw new e("not yet implemented abstract")};this.getEncodedHex=function(){var j=new g({oid:this.typeOid}),h=new a({array:this.getValueArray()}),i=new b({array:[j,h]});return i.getEncodedHex()}};extendClass(KJUR.asn1.cms.Attribute,KJUR.asn1.ASN1Object);KJUR.asn1.cms.ContentType=function(c){var b=KJUR,a=b.asn1;a.cms.ContentType.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.3";this.getValueArray=function(){var d=new a.DERObjectIdentifier(this.params.type);return[d]};if(c!=void 0){this.setByParam(c)}};extendClass(KJUR.asn1.cms.ContentType,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.MessageDigest=function(e){var b=KJUR,a=b.asn1,c=a.DEROctetString,d=a.cms;d.MessageDigest.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.4";this.getValueArray=function(){var f=new c(this.params);return[f]};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cms.MessageDigest,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.SigningTime=function(c){var b=KJUR,a=b.asn1;a.cms.SigningTime.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.5";this.getValueArray=function(){var d=new a.x509.Time(this.params);return[d]};if(c!=void 0){this.setByParam(c)}};extendClass(KJUR.asn1.cms.SigningTime,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.SigningCertificate=function(h){var e=Error,d=KJUR,c=d.asn1,b=c.DERSequence,g=c.cms,a=g.ESSCertID,f=d.crypto;g.SigningCertificate.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.16.2.12";this.getValueArray=function(){if(null==this.params||this.params==void 0||this.params.array==void 0){throw new e("parameter 'array' not specified")}for(var o=this.params.array,k=[],l=0,n;l<o.length;l++){n=o[l];if(!1==h.hasis&&"string"==typeof n&&(-1!=n.indexOf("-----BEGIN")||ASN1HEX.isASN1HEX(n))){n={cert:n}}if(!1!=n.hasis&&!1==h.hasis){n.hasis=!1}k.push(new a(n))}var j=new b({array:k}),m=new b({array:[j]});return[m]};if(h!=void 0){this.setByParam(h)}};extendClass(KJUR.asn1.cms.SigningCertificate,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.ESSCertID=function(g){KJUR.asn1.cms.ESSCertID.superclass.constructor.call(this);var d=Error,c=KJUR,b=c.asn1,f=b.DEROctetString,a=b.DERSequence,e=b.cms.IssuerSerial;this.params=null;this.getCertHash=function(k,h){if(k.hash!=void 0){return k.hash}if("string"==typeof k&&-1==k.indexOf("-----BEGIN")&&!ASN1HEX.isASN1HEX(k)){return k}var i;if("string"==typeof k){i=k}else{if(k.cert!=void 0){i=k.cert}else{throw new d("hash nor cert unspecified")}}var j;if(-1!=i.indexOf("-----BEGIN")){j=pemtohex(i)}else{j=i}if("string"==typeof k){if(-1!=k.indexOf("-----BEGIN")){j=pemtohex(k)}else{if(ASN1HEX.isASN1HEX(k)){j=k}}}var l;if(k.alg!=void 0){l=k.alg}else{if(h!=void 0){l=h}else{throw new d("hash alg unspecified")}}return c.crypto.Util.hashHex(j,l)};this.getEncodedHex=function(){var k=this.params,j=this.getCertHash(k,"sha1"),h=[];h.push(new f({hex:j}));if("string"==typeof k&&-1!=k.indexOf("-----BEGIN")||k.cert!=void 0&&!1!=k.hasis||k.issuer!=void 0&&k.serial!=void 0){h.push(new e(k))}var i=new a({array:h});return i.getEncodedHex()};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.cms.ESSCertID,KJUR.asn1.ASN1Object);KJUR.asn1.cms.SigningCertificateV2=function(d){var h=Error,a=KJUR,g=a.asn1,e=g.DERSequence,b=g.x509,i=g.cms,c=i.ESSCertIDv2,f=a.crypto;i.SigningCertificateV2.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.16.2.47";this.getValueArray=function(){if(null==this.params||this.params==void 0||this.params.array==void 0){throw new h("parameter 'array' not specified")}for(var o=this.params.array,l=[],m=0,n;m<o.length;m++){n=o[m];if((d.alg!=void 0||!1==d.hasis)&&"string"==typeof n&&(-1!=n.indexOf("-----BEGIN")||ASN1HEX.isASN1HEX(n))){n={cert:n}}if(n.alg==void 0&&d.alg!=void 0){n.alg=d.alg}if(!1!=n.hasis&&!1==d.hasis){n.hasis=!1}l.push(new c(n))}var k=new e({array:l}),j=new e({array:[k]});return[j]};if(d!=void 0){this.setByParam(d)}};extendClass(KJUR.asn1.cms.SigningCertificateV2,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.ESSCertIDv2=function(h){KJUR.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var d=Error,c=KJUR,b=c.asn1,f=b.DEROctetString,a=b.DERSequence,e=b.cms.IssuerSerial,g=b.x509.AlgorithmIdentifier;this.params=null;this.getEncodedHex=function(){var l=this.params,k=this.getCertHash(l,"sha256"),i=[];if(l.alg!=void 0&&"sha256"!=l.alg){i.push(new g({name:l.alg}))}i.push(new f({hex:k}));if("string"==typeof l&&-1!=l.indexOf("-----BEGIN")||l.cert!=void 0&&!1!=l.hasis||l.issuer!=void 0&&l.serial!=void 0){i.push(new e(l))}var j=new a({array:i});return j.getEncodedHex()};if(h!=void 0){this.setByParam(h)}};extendClass(KJUR.asn1.cms.ESSCertIDv2,KJUR.asn1.cms.ESSCertID);KJUR.asn1.cms.IssuerSerial=function(e){var i=Error,c=KJUR,h=c.asn1,g=h.DERInteger,f=h.DERSequence,j=h.cms,d=h.x509,a=d.GeneralNames;j.IssuerSerial.superclass.constructor.call(this);this.setByParam=function(k){this.params=k};this.getEncodedHex=function(){var p=this.params,l,r;if("string"==typeof p&&-1!=p.indexOf("-----BEGIN")||p.cert!=void 0){var n;if(p.cert!=void 0){n=p.cert}else{n=p}var k=new X509;k.readCertPEM(n);l=k.getIssuer();r={hex:k.getSerialNumberHex()}}else{if(p.issuer!=void 0&&p.serial){l=p.issuer;r=p.serial}else{throw new i("cert or issuer and serial parameter not specified")}}var q=new a([{dn:l}]),o=new g(r),m=new f({array:[q,o]});return m.getEncodedHex()};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cms.IssuerSerial,KJUR.asn1.ASN1Object);KJUR.asn1.cms.SignerIdentifier=function(f){var c=KJUR,i=c.asn1,h=i.DERInteger,g=i.DERSequence,l=i.cms,k=l.IssuerAndSerialNumber,d=l.SubjectKeyIdentifier,e=i.x509,a=e.X500Name,j=Error;l.SignerIdentifier.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var o=this.params;if("isssn"==o.type){var m=new k(o);return m.getEncodedHex()}else{if("skid"==o.type){var n=new d(o);return n.getEncodedHex()}else{throw new Error("wrong property for isssn or skid")}}};if(f!=void 0){this.setByParam(f)}};extendClass(KJUR.asn1.cms.SignerIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.cms.IssuerAndSerialNumber=function(e){var c=KJUR,h=c.asn1,g=h.DERInteger,f=h.DERSequence,j=h.cms,d=h.x509,a=d.X500Name,i=Error;j.IssuerAndSerialNumber.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var p=this.params,l,r;if("string"==typeof p&&-1!=p.indexOf("-----BEGIN")||p.cert!=void 0){var n;if(p.cert!=void 0){n=p.cert}else{n=p}var k=new X509;k.readCertPEM(n);l=k.getIssuer();r={hex:k.getSerialNumberHex()}}else{if(p.issuer!=void 0&&p.serial){l=p.issuer;r=p.serial}else{throw new i("cert or issuer and serial parameter not specified")}}var q=new a(l),o=new g(r),m=new f({array:[q,o]});return m.getEncodedHex()};this.setByParam=function(k){this.params=k};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cms.IssuerAndSerialNumber,KJUR.asn1.ASN1Object);KJUR.asn1.cms.SubjectKeyIdentifier=function(g){var d=KJUR,k=d.asn1,i=k.DERInteger,h=k.DERSequence,j=k.ASN1Util.newObject,m=k.cms,f=m.IssuerAndSerialName,c=m.SubjectKeyIdentifier,e=k.x509,a=e.X500Name,l=Error;m.SubjectKeyIdentifier.superclass.constructor.call(this);this.getEncodedHex=function(){var r=this.params;if(r.cert==void 0&&r.skid==void 0){throw new l("property cert nor skid undefined")}var q;if(r.cert!=void 0){var n=new X509(r.cert),o=n.getExtSubjectKeyIdentifier();q=o.kid.hex}else{if(r.skid!=void 0){q=r.skid}}var p=j({tag:{tage:"a0",obj:{octstr:{hex:q}}}});return p.getEncodedHex()};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.cms.SubjectKeyIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.cms.AttributeList=function(f){var d=Error,c=KJUR,b=c.asn1,a=b.DERSet,e=b.cms;e.AttributeList.superclass.constructor.call(this);this.params=null;this.hTLV=null;this.setByParam=function(g){this.params=g};this.getEncodedHex=function(){var o=this.params;if(null!=this.hTLV){return this.hTLV}var m=!0;if(o.sortflag!=void 0){m=o.sortflag}for(var j=o.array,g=[],l=0;l<j.length;l++){var n=j[l],k=n.attr;if("contentType"==k){g.push(new e.ContentType(n))}else{if("messageDigest"==k){g.push(new e.MessageDigest(n))}else{if("signingTime"==k){g.push(new e.SigningTime(n))}else{if("signingCertificate"==k){g.push(new e.SigningCertificate(n))}else{if("signingCertificateV2"==k){g.push(new e.SigningCertificateV2(n))}else{if("signaturePolicyIdentifier"==k){g.push(new KJUR.asn1.cades.SignaturePolicyIdentifier(n))}else{if("signatureTimeStamp"==k||"timeStampToken"==k){g.push(new KJUR.asn1.cades.SignatureTimeStamp(n))}else{throw new d("unknown attr: "+k)}}}}}}}}var h=new a({array:g,sortflag:m});this.hTLV=h.getEncodedHex();return this.hTLV};if(f!=void 0){this.setByParam(f)}};extendClass(KJUR.asn1.cms.AttributeList,KJUR.asn1.ASN1Object);KJUR.asn1.cms.SignerInfo=function(q){var n=Error,r=KJUR,i=r.asn1,c=i.DERInteger,f=i.DEROctetString,h=i.DERSequence,m=i.DERTaggedObject,k=i.cms,p=k.SignerIdentifier,l=k.AttributeList,g=k.ContentType,e=k.EncapsulatedContentInfo,d=k.MessageDigest,j=k.SignedData,a=i.x509,s=a.AlgorithmIdentifier,b=r.crypto;k.SignerInfo.superclass.constructor.call(this);this.params=null;this.sign=function(){var y=this.params,x=y.sigalg,u=new l(y.sattrs).getEncodedHex(),v=KEYUTIL.getKey(y.signkey),w=new b.Signature({alg:x});w.init(v);w.updateHex(u);var t=w.sign();y.sighex=t};this.getEncodedHex=function(){var w=this.params,t=[];t.push(new c({int:w.version}));t.push(new p(w.id));t.push(new s({name:w.hashalg}));if(w.sattrs!=void 0){var x=new l(w.sattrs);try{t.push(new m({tag:"a0",explicit:!1,obj:x}))}catch(v){throw new n("si sattr error: "+v)}}if(w.sigalgfield!=void 0){t.push(new s({name:w.sigalgfield}))}else{t.push(new s({name:w.sigalg}))}if(w.sighex==void 0&&w.signkey!=void 0){this.sign()}t.push(new f({hex:w.sighex}));if(w.uattrs!=void 0){var x=new l(w.uattrs);try{t.push(new m({tag:"a1",explicit:!1,obj:x}))}catch(v){throw new n("si uattr error: "+v)}}var u=new h({array:t});return u.getEncodedHex()};if(q!=void 0){this.setByParam(q)}};extendClass(KJUR.asn1.cms.SignerInfo,KJUR.asn1.ASN1Object);KJUR.asn1.cms.EncapsulatedContentInfo=function(g){var c=KJUR,b=c.asn1,e=b.DERTaggedObject,a=b.DERSequence,h=b.DERObjectIdentifier,d=b.DEROctetString,f=b.cms;f.EncapsulatedContentInfo.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var m=this.params,i=[];i.push(new h(m.type));if(m.content!=void 0&&(m.content.hex!=void 0||m.content.str!=void 0)&&!0!=m.isDetached){var k=new d(m.content),l=new e({tag:"a0",explicit:!0,obj:k});i.push(l)}var j=new a({array:i});return j.getEncodedHex()};this.setByParam=function(i){this.params=i};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.cms.EncapsulatedContentInfo,KJUR.asn1.ASN1Object);KJUR.asn1.cms.ContentInfo=function(g){var c=KJUR,b=c.asn1,d=b.DERTaggedObject,a=b.DERSequence,h=b.DERObjectIdentifier,f=b.x509,e=f.OID.name2obj;KJUR.asn1.cms.ContentInfo.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var l=this.params,i=[];i.push(new h(l.type));var k=new d({tag:"a0",explicit:!0,obj:l.obj});i.push(k);var j=new a({array:i});return j.getEncodedHex()};this.setByParam=function(i){this.params=i};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.cms.ContentInfo,KJUR.asn1.ASN1Object);KJUR.asn1.cms.SignedData=function(e){var j=Error,a=KJUR,h=a.asn1,m=h.ASN1Object,g=h.DERInteger,p=h.DERSet,f=h.DERSequence,b=h.DERTaggedObject,o=h.cms,l=o.EncapsulatedContentInfo,d=o.SignerInfo,q=o.ContentInfo,k=o.CertificateSet,i=o.RevocationInfoChoices,c=h.x509,n=c.AlgorithmIdentifier;KJUR.asn1.cms.SignedData.superclass.constructor.call(this);this.params=null;this.checkAndFixParam=function(){var r=this.params;this._setDigestAlgs(r);this._setContentTypeByEContent(r);this._setMessageDigestByEContent(r);this._setSignerInfoVersion(r);this._setSignedDataVersion(r)};this._setDigestAlgs=function(v){for(var u={},t=v.sinfos,r=0,s;r<t.length;r++){s=t[r];u[s.hashalg]=1}v.hashalgs=Object.keys(u).sort()};this._setContentTypeByEContent=function(w){for(var u=w.econtent.type,v=w.sinfos,r=0;r<v.length;r++){var t=v[r],s=this._getAttrParamByName(t,"contentType");s.type=u}};this._setMessageDigestByEContent=function(r){var v=r.econtent,y=r.econtent.type,x=v.content.hex;if(x==void 0&&"data"==v.type&&v.content.str!=void 0){x=rstrtohex(v.content.str)}for(var A=r.sinfos,u=0;u<A.length;u++){var t=A[u],s=t.hashalg,z=this._getAttrParamByName(t,"messageDigest"),w=KJUR.crypto.Util.hashHex(x,s);z.hex=w}};this._getAttrParamByName=function(t,s){for(var u=t.sattrs.array,r=0;r<u.length;r++){if(u[r].attr==s){return u[r]}}};this._setSignerInfoVersion=function(v){for(var t=v.sinfos,r=0;r<t.length;r++){var s=t[r],u=1;if("skid"==s.id.type){u=3}s.version=u}};this._setSignedDataVersion=function(s){var r=this._getSignedDataVersion(s);s.version=r};this._getSignedDataVersion=function(w){if(w.revinfos!=void 0){for(var r=w.revinfos,t=0,s;t<r.length;t++){s=r[t];if(s.ocsp!=void 0){return 5}}}for(var v=w.sinfos,t=0,u;t<v.length;t++){u=w.sinfos[t];if(3==u.version){return 3}}if("data"!=w.econtent.type){return 3}return 1};this.getEncodedHex=function(){var y=this.params;if(this.getEncodedHexPrepare!=void 0){this.getEncodedHexPrepare()}if(!0!=y.fixed){this.checkAndFixParam()}for(var r=[new g({int:y.version})],w=[],v=0,t;v<y.hashalgs.length;v++){t=y.hashalgs[v];w.push(new n({name:t}))}r.push(new p({array:w}));r.push(new l(y.econtent));if(y.certs!=void 0){r.push(new k(y.certs))}if(y.revinfos!=void 0){r.push(new i(y.revinfos))}for(var u=[],v=0,x;v<y.sinfos.length;v++){x=y.sinfos[v];u.push(new d(x))}r.push(new p({array:u}));var s=new f({array:r});return s.getEncodedHex()};this.getContentInfo=function(){var r=new q({type:"signed-data",obj:this});return r};this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cms.SignedData,KJUR.asn1.ASN1Object);KJUR.asn1.cms.CertificateSet=function(f){KJUR.asn1.cms.CertificateSet.superclass.constructor.call(this);var c=Error,b=KJUR.asn1,e=b.DERTaggedObject,a=b.DERSet,d=b.ASN1Object;this.params=null;this.getEncodedHex=function(){var j=this.params,p=[],q;if(j instanceof Array){q=j}else{if(j.array!=void 0){q=j.array}else{throw new c("cert array not specified")}}for(var k=0;k<q.length;k++){var l=q[k],n=pemtohex(l),g=new d;g.hTLV=n;p.push(g)}var m={array:p};if(!1==j.sortflag){m.sortflag=!1}var o=new a(m),h=new e({tag:"a0",explicit:!1,obj:o});return h.getEncodedHex()};if(f!=void 0){this.setByParam(f)}};extendClass(KJUR.asn1.cms.CertificateSet,KJUR.asn1.ASN1Object);KJUR.asn1.cms.RevocationInfoChoices=function(a){KJUR.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var e=this.params;if(!e instanceof Array){throw new Error("params is not array")}for(var b=[],c=0;c<e.length;c++){b.push(new KJUR.asn1.cms.RevocationInfoChoice(e[c]))}var d=KJUR.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:b}}});return d.getEncodedHex()};if(a!=void 0){this.setByParam(a)}};extendClass(KJUR.asn1.cms.RevocationInfoChoices,KJUR.asn1.ASN1Object);KJUR.asn1.cms.RevocationInfoChoice=function(a){KJUR.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var d=this.params;if(d.crl!=void 0&&"string"==typeof d.crl){var b=d.crl;if(-1!=d.crl.indexOf("-----BEGIN")){b=pemtohex(d.crl)}return b}else{if(d.ocsp!=void 0){var c=KJUR.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new KJUR.asn1.cms.OtherRevocationFormat(d)}});return c.getEncodedHex()}else{throw new Error("property crl or ocsp undefined")}}};if(a!=void 0){this.setByParam(a)}};extendClass(KJUR.asn1.cms.RevocationInfoChoice,KJUR.asn1.ASN1Object);KJUR.asn1.cms.OtherRevocationFormat=function(f){KJUR.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var d=Error,c=KJUR,b=c.asn1,a=b.ASN1Util.newObject,e=c.lang.String.isHex;this.params=null;this.getEncodedHex=function(){var h=this.params;if(h.ocsp==void 0){throw new d("property ocsp not specified")}if(!e(h.ocsp)||!ASN1HEX.isASN1HEX(h.ocsp)){throw new d("ocsp value not ASN.1 hex string")}var g=a({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:h.ocsp}}]});return g.getEncodedHex()};if(f!=void 0){this.setByParam(f)}};extendClass(KJUR.asn1.cms.OtherRevocationFormat,KJUR.asn1.ASN1Object);KJUR.asn1.cms.CMSUtil=new function(){};KJUR.asn1.cms.CMSUtil.newSignedData=function(a){return new KJUR.asn1.cms.SignedData(a)};KJUR.asn1.cms.CMSUtil.verifySignedData=function(n){var C=KJUR,p=C.asn1,s=p.cms,D=s.SignerInfo,q=s.SignedData,y=s.SigningTime,b=s.SigningCertificate,d=s.SigningCertificateV2,A=p.cades,u=A.SignaturePolicyIdentifier,i=C.lang.String.isHex,v=ASN1HEX,h=v.getVbyList,a=v.getTLVbyList,t=v.getIdxbyList,z=v.getChildIdx,c=v.getTLV,B=v.oidname,j=C.crypto.Util.hashHex;if(n.cms===void 0&&!i(n.cms)){}var E=n.cms,g=function(J,H){for(var G,I=3;6>I;I++){G=t(J,0,[1,0,I]);if(G!==void 0){var F=J.substr(G,2);if("a0"===F){H.certsIdx=G}if("a1"===F){H.revinfosIdx=G}if("31"===F){H.signerinfosIdx=G}}}},l=function(I,F){var H=F.signerinfosIdx;if(H===void 0){return}var L=z(I,H);F.signerInfoIdxList=L;for(var G=0;G<L.length;G++){var K=L[G],J={idx:K};k(I,J);F.signerInfos.push(J)}},k=function(I,J){var F=J.idx;J.signerid_issuer1=a(I,F,[1,0],"30");J.signerid_serial1=h(I,F,[1,1],"02");J.hashalg=B(h(I,F,[2,0],"06"));var H=t(I,F,[3],"a0");J.idxSignedAttrs=H;f(I,J,H);var G=z(I,F),K=G.length;if(6>K){throw"malformed SignerInfo"}J.sigalg=B(h(I,F,[K-2,0],"06"));J.sigval=h(I,F,[K-1],"04")},f=function(L,M,F){var J=z(L,F);M.signedAttrIdxList=J;for(var K=0;K<J.length;K++){var I=J[K],G=h(L,I,[0],"06"),H;if("2a864886f70d010905"===G){H=hextoutf8(h(L,I,[1,0]));M.saSigningTime=H}else{if("2a864886f70d010904"===G){H=h(L,I,[1,0],"04");M.saMessageDigest=H}}}},x=function(F,Q,J){var N=Q.parse.certsIdx,H;if(Q.certs===void 0){H=[];Q.certkeys=[];for(var K=z(F,N),I=0;I<K.length;I++){var M=c(F,K[I]),O=new X509;O.readCertHex(M);H[I]=O;Q.certkeys[I]=O.getPublicKey()}Q.certs=H}else{H=Q.certs}Q.cccc=H.length;Q.cccci=K.length;for(var I=0;I<H.length;I++){var L=O.getIssuerHex(),G=O.getSerialNumberHex();if(J.signerid_issuer1===L&&J.signerid_serial1===G){J.certkey_idx=I}}},e=function(F,R,I,N){I.verifyDetail={};var Q=I.verifyDetail,K=R.parse.econtent,G=I.hashalg,L=I.saMessageDigest;Q.validMessageDigest=!1;if(j(K,G)===L){Q.validMessageDigest=!0}x(F,R,I,N);Q.validSignatureValue=!1;var H=I.sigalg,M="31"+c(F,I.idxSignedAttrs).substr(2);I.signedattrshex=M;var J=R.certs[I.certkey_idx].getPublicKey(),P=new KJUR.crypto.Signature({alg:H});P.init(J);P.updateHex(M);var O=P.verify(I.sigval);Q.validSignatureValue_isValid=O;if(!0===O){Q.validSignatureValue=!0}I.isValid=!1;if(Q.validMessageDigest&&Q.validSignatureValue){I.isValid=!0}},r={isValid:!1,parse:{}};(function(G,F){if("2a864886f70d010702"!==h(G,0,[0],"06")){return F}F.cmsType="signedData";F.econtent=h(G,0,[1,0,2,1,0]);g(G,F);F.signerInfos=[];l(G,F)})(E,r.parse);(function(J,F){for(var G=F.parse.signerInfos,L=G.length,K=!0,I=0,H;I<L;I++){H=G[I];e(J,F,H,I);if(!H.isValid){K=!1}}F.isValid=K})(E,r);return r};KJUR.asn1.cms.CMSParser=function(){var g=Error,a=X509,h=new a,l=ASN1HEX,i=l.getV,b=l.getTLV,f=l.getIdxbyList,c=l.getTLVbyList,d=l.getTLVbyListEx,e=l.getVbyList,k=l.getVbyListEx,j=l.getChildIdx;this.getCMSSignedData=function(m){var o=c(m,0,[1,0]),n=this.getSignedData(o);return n};this.getSignedData=function(o){var q=j(o,0),v={},p=i(o,q[0]),n=parseInt(p,16);v.version=n;var r=b(o,q[1]);v.hashalgs=this.getHashAlgArray(r);var t=b(o,q[2]);v.econtent=this.getEContent(t);var m=d(o,0,["[0]"]);if(null!=m){v.certs=this.getCertificateSet(m)}var u=d(o,0,["[1]"]);if(null!=u){}var s=d(o,0,[3]);v.sinfos=this.getSignerInfos(s);return v};this.getHashAlgArray=function(s){for(var q=j(s,0),m=new a,n=[],r=0;r<q.length;r++){var p=b(s,q[r]),o=m.getAlgorithmIdentifierName(p);n.push(o)}return n};this.getEContent=function(m){var n={},p=e(m,0,[0]),o=e(m,0,[1,0]);n.type=KJUR.asn1.x509.OID.oid2name(ASN1HEX.hextooidstr(p));n.content={hex:o};return n};this.getSignerInfos=function(p){for(var r=[],m=j(p,0),n=0;n<m.length;n++){var o=b(p,m[n]),q=this.getSignerInfo(o);r.push(q)}return r};this.getSignerInfo=function(s){var y={},u=j(s,0),q=l.getInt(s,u[0],-1);if(-1!=q){y.version=q}var t=b(s,u[1]),p=this.getIssuerAndSerialNumber(t);y.id=p;var z=b(s,u[2]),n=h.getAlgorithmIdentifierName(z);y.hashalg=n;var w=d(s,0,["[0]"]);if(null!=w){var A=this.getAttributeList(w);y.sattrs=A}var m=d(s,0,[3]),x=h.getAlgorithmIdentifierName(m);y.sigalg=x;var o=k(s,0,[4]);y.sighex=o;var r=d(s,0,["[1]"]);if(null!=r){var v=this.getAttributeList(r);y.uattrs=v}return y};this.getSignerIdentifier=function(m){if("30"==m.substr(0,2)){return this.getIssuerAndSerialNumber(m)}else{throw new Error("SKID of signerIdentifier not supported")}};this.getIssuerAndSerialNumber=function(n){var o={type:"isssn"},m=j(n,0),p=b(n,m[0]);o.issuer=h.getX500Name(p);var q=i(n,m[1]);o.serial={hex:q};return o};this.getAttributeList=function(q){for(var m=[],n=j(q,0),o=0;o<n.length;o++){var p=b(q,n[o]),r=this.getAttribute(p);m.push(r)}return{array:m}};this.getAttribute=function(p){var t={},q=j(p,0),o=l.getOID(p,q[0]),m=KJUR.asn1.x509.OID.oid2name(o);t.attr=m;var r=b(p,q[1]),u=j(r,0);if(1==u.length){t.valhex=b(r,u[0])}else{for(var s=[],n=0;n<u.length;n++){s.push(b(r,u[n]))}t.valhex=s}if("contentType"==m){this.setContentType(t)}else{if("messageDigest"==m){this.setMessageDigest(t)}else{if("signingTime"==m){this.setSigningTime(t)}else{if("signingCertificate"==m){this.setSigningCertificate(t)}else{if("signingCertificateV2"==m){this.setSigningCertificateV2(t)}else{if("signaturePolicyIdentifier"==m){this.setSignaturePolicyIdentifier(t)}}}}}}return t};this.setContentType=function(m){var n=l.getOIDName(m.valhex,0,null);if(null!=n){m.type=n;delete m.valhex}};this.setSigningTime=function(o){var n=i(o.valhex,0),m=hextoutf8(n);o.str=m;delete o.valhex};this.setMessageDigest=function(m){var n=i(m.valhex,0);m.hex=n;delete m.valhex};this.setSigningCertificate=function(n){var q=j(n.valhex,0);if(0<q.length){for(var m=b(n.valhex,q[0]),p=j(m,0),t=[],o=0;o<p.length;o++){var s=b(m,p[o]),u=this.getESSCertID(s);t.push(u)}n.array=t}if(1<q.length){var r=b(n.valhex,q[1]);n.polhex=r}delete n.valhex};this.setSignaturePolicyIdentifier=function(s){var q=j(s.valhex,0);if(0<q.length){var r=l.getOID(s.valhex,q[0]);s.oid=r}if(1<q.length){var m=new a,t=j(s.valhex,q[1]),p=b(s.valhex,t[0]),o=m.getAlgorithmIdentifierName(p);s.alg=o;var n=i(s.valhex,t[1]);s.hash=n}delete s.valhex};this.setSigningCertificateV2=function(o){var s=j(o.valhex,0);if(0<s.length){for(var n=b(o.valhex,s[0]),r=j(n,0),u=[],q=0;q<r.length;q++){var m=b(n,r[q]),p=this.getESSCertIDv2(m);u.push(p)}o.array=u}if(1<s.length){var t=b(o.valhex,s[1]);o.polhex=t}delete o.valhex};this.getESSCertID=function(o){var p={},n=j(o,0);if(0<n.length){var q=i(o,n[0]);p.hash=q}if(1<n.length){var m=b(o,n[1]),r=this.getIssuerSerial(m);if(r.serial!=void 0){p.serial=r.serial}if(r.issuer!=void 0){p.issuer=r.issuer}}return p};this.getESSCertIDv2=function(q){var s={},p=j(q,0);if(1>p.length||3<p.length){throw new g("wrong number of elements")}var r=0;if("30"==q.substr(p[0],2)){var o=b(q,p[0]);s.alg=h.getAlgorithmIdentifierName(o);r++}else{s.alg="sha256"}var n=i(q,p[r]);s.hash=n;if(p.length>r+1){var m=b(q,p[r+1]),t=this.getIssuerSerial(m);s.issuer=t.issuer;s.serial=t.serial}return s};this.getIssuerSerial=function(q){var r={},n=j(q,0),m=b(q,n[0]),p=h.getGeneralNames(m),o=p[0].dn;r.issuer=o;var s=i(q,n[1]);r.serial={hex:s};return r};this.getCertificateSet=function(p){for(var n=j(p,0),m=[],o=0,r;o<n.length;o++){r=b(p,n[o]);if("30"==r.substr(0,2)){var q=hextopem(r,"CERTIFICATE");m.push(q)}}return{array:m,sortflag:!1}}};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.asn1||!KJUR.asn1){KJUR.asn1={}}if("undefined"==typeof KJUR.asn1.tsp||!KJUR.asn1.tsp){KJUR.asn1.tsp={}}KJUR.asn1.tsp.TimeStampToken=function(d){var c=KJUR,b=c.asn1,a=b.tsp;a.TimeStampToken.superclass.constructor.call(this);this.params=null;this.getEncodedHexPrepare=function(){var e=new a.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=e.getEncodedHex()};if(d!=void 0){this.setByParam(d)}};extendClass(KJUR.asn1.tsp.TimeStampToken,KJUR.asn1.cms.SignedData);KJUR.asn1.tsp.TSTInfo=function(f){var m=Error,c=KJUR,j=c.asn1,g=j.DERSequence,i=j.DERInteger,l=j.DERBoolean,h=j.DERGeneralizedTime,n=j.DERObjectIdentifier,e=j.DERTaggedObject,k=j.tsp,d=k.MessageImprint,b=k.Accuracy,a=j.x509.X500Name,o=j.x509.GeneralName;k.TSTInfo.superclass.constructor.call(this);this.dVersion=new i({int:1});this.dPolicy=null;this.dMessageImprint=null;this.dSerial=null;this.dGenTime=null;this.dAccuracy=null;this.dOrdering=null;this.dNonce=null;this.dTsa=null;this.getEncodedHex=function(){var p=[this.dVersion];if(null==this.dPolicy){throw new Error("policy shall be specified.")}p.push(this.dPolicy);if(null==this.dMessageImprint){throw new Error("messageImprint shall be specified.")}p.push(this.dMessageImprint);if(null==this.dSerial){throw new Error("serialNumber shall be specified.")}p.push(this.dSerial);if(null==this.dGenTime){throw new Error("genTime shall be specified.")}p.push(this.dGenTime);if(null!=this.dAccuracy){p.push(this.dAccuracy)}if(null!=this.dOrdering){p.push(this.dOrdering)}if(null!=this.dNonce){p.push(this.dNonce)}if(null!=this.dTsa){p.push(this.dTsa)}var q=new g({array:p});this.hTLV=q.getEncodedHex();return this.hTLV};if(f!==void 0){if("string"==typeof f.policy){if(!f.policy.match(/^[0-9.]+$/)){throw"policy shall be oid like 0.1.4.134"}this.dPolicy=new n({oid:f.policy})}if(f.messageImprint!==void 0){this.dMessageImprint=new d(f.messageImprint)}if(f.serial!==void 0){this.dSerial=new i(f.serial)}if(f.genTime!==void 0){this.dGenTime=new h(f.genTime)}if(f.accuracy!==void 0){this.dAccuracy=new b(f.accuracy)}if(f.ordering!==void 0&&!0==f.ordering){this.dOrdering=new l}if(f.nonce!==void 0){this.dNonce=new i(f.nonce)}if(f.tsa!==void 0){this.dTsa=new e({tag:"a0",explicit:!0,obj:new o({dn:f.tsa})})}}};extendClass(KJUR.asn1.tsp.TSTInfo,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.Accuracy=function(d){var c=KJUR,b=c.asn1,a=b.ASN1Util.newObject;b.tsp.Accuracy.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var f=this.params,e=[];if(f.seconds!=void 0&&"number"==typeof f.seconds){e.push({int:f.seconds})}if(f.millis!=void 0&&"number"==typeof f.millis){e.push({tag:{tagi:"80",obj:{int:f.millis}}})}if(f.micros!=void 0&&"number"==typeof f.micros){e.push({tag:{tagi:"81",obj:{int:f.micros}}})}return a({seq:e}).getEncodedHex()};if(d!=void 0){this.setByParam(d)}};extendClass(KJUR.asn1.tsp.Accuracy,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.MessageImprint=function(g){var c=KJUR,b=c.asn1,a=b.DERSequence,d=b.DEROctetString,f=b.x509,e=f.AlgorithmIdentifier;b.tsp.MessageImprint.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var k=this.params,j=new e({name:k.alg}),h=new d({hex:k.hash}),i=new a({array:[j,h]});return i.getEncodedHex()};if(g!==void 0){this.setByParam(g)}};extendClass(KJUR.asn1.tsp.MessageImprint,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.TimeStampReq=function(c){var a=KJUR,f=a.asn1,d=f.DERSequence,e=f.DERInteger,h=f.DERBoolean,j=f.ASN1Object,i=f.DERObjectIdentifier,g=f.tsp,b=g.MessageImprint;g.TimeStampReq.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var m=this.params,k=[];k.push(new e({int:1}));if(m.messageImprint instanceof KJUR.asn1.ASN1Object){k.push(m.messageImprint)}else{k.push(new b(m.messageImprint))}if(m.policy!=void 0){k.push(new i(m.policy))}if(m.nonce!=void 0){k.push(new e(m.nonce))}if(!0==m.certreq){k.push(new h)}var l=new d({array:k});return l.getEncodedHex()};if(c!=void 0){this.setByParam(c)}};extendClass(KJUR.asn1.tsp.TimeStampReq,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.TimeStampResp=function(g){var e=KJUR,d=e.asn1,c=d.DERSequence,f=d.ASN1Object,a=d.tsp,b=a.PKIStatusInfo;a.TimeStampResp.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var j=this.params,h=[new b(j.statusinfo)];if(j.econtent!=void 0){h.push(new a.TimeStampToken(j).getContentInfo())}if(j.tst!=void 0&&j.tst instanceof d.ASN1Object){h.push(j.tst)}var i=new c({array:h});return i.getEncodedHex()};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.tsp.TimeStampResp,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIStatusInfo=function(d){var h=Error,a=KJUR,g=a.asn1,e=g.DERSequence,i=g.tsp,f=i.PKIStatus,c=i.PKIFreeText,b=i.PKIFailureInfo;i.PKIStatusInfo.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var l=this.params,j=[];if("string"==typeof l){j.push(new f(l))}else{if(l.status==void 0){throw new h("property 'status' unspecified")}j.push(new f(l.status));if(l.statusstr!=void 0){j.push(new c(l.statusstr))}if(l.failinfo!=void 0){j.push(new b(l.failinfo))}}var k=new e({array:j});return k.getEncodedHex()};if(d!=void 0){this.setByParam(d)}};extendClass(KJUR.asn1.tsp.PKIStatusInfo,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIStatus=function(g){var e=Error,d=KJUR,c=d.asn1,f=c.DERInteger,b=c.tsp;b.PKIStatus.superclass.constructor.call(this);var a={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null;this.getEncodedHex=function(){var k=this.params,j;if("string"==typeof k){try{j=a[k]}catch(i){throw new e("undefined name: "+k)}}else{if("number"==typeof k){j=k}else{throw new e("unsupported params")}}return new f({int:j}).getEncodedHex()};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.tsp.PKIStatus,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIFreeText=function(g){var f=Error,e=KJUR,d=e.asn1,b=d.DERSequence,c=d.DERUTF8String,a=d.tsp;a.PKIFreeText.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var l=this.params;if(!l instanceof Array){throw new f("wrong params: not array")}for(var h=[],k=0;k<l.length;k++){h.push(new c({str:l[k]}))}var j=new b({array:h});return j.getEncodedHex()};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.tsp.PKIFreeText,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIFailureInfo=function(h){var f=Error,e=KJUR,d=e.asn1,g=d.DERBitString,b=d.tsp,c=b.PKIFailureInfo,a={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};c.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var k=this.params,j;if("string"==typeof k){try{j=a[k]}catch(i){throw new f("undefined name: "+k)}}else{if("number"==typeof k){j=k}else{throw new f("wrong params")}}return new g({bin:j.toString(2)}).getEncodedHex()};if(h!=void 0){this.setByParam(h)}};extendClass(KJUR.asn1.tsp.PKIFailureInfo,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.AbstractTSAAdapter=function(){this.getTSTHex=function(){throw"not implemented yet"}};KJUR.asn1.tsp.SimpleTSAAdapter=function(e){var d=KJUR,c=d.asn1,a=c.tsp,b=d.crypto.Util.hashHex;a.SimpleTSAAdapter.superclass.constructor.call(this);this.params=null;this.serial=0;this.getTSTHex=function(g,f){var i=b(g,f);this.params.econtent.content.messageImprint={alg:f,hash:i};this.params.econtent.content.serial={int:this.serial++};var h=Math.floor(1e9*Math.random());this.params.econtent.content.nonce={int:h};var j=new a.TimeStampToken(this.params);return j.getContentInfoEncodedHex()};if(e!==void 0){this.params=e}};extendClass(KJUR.asn1.tsp.SimpleTSAAdapter,KJUR.asn1.tsp.AbstractTSAAdapter);KJUR.asn1.tsp.FixedTSAAdapter=function(e){var d=KJUR,c=d.asn1,a=c.tsp,b=d.crypto.Util.hashHex;a.FixedTSAAdapter.superclass.constructor.call(this);this.params=null;this.getTSTHex=function(g,f){var h=b(g,f);this.params.econtent.content.messageImprint={alg:f,hash:h};var i=new a.TimeStampToken(this.params);return i.getContentInfoEncodedHex()};if(e!==void 0){this.params=e}};extendClass(KJUR.asn1.tsp.FixedTSAAdapter,KJUR.asn1.tsp.AbstractTSAAdapter);KJUR.asn1.tsp.TSPUtil=new function(){};KJUR.asn1.tsp.TSPUtil.newTimeStampToken=function(a){return new KJUR.asn1.tsp.TimeStampToken(a)};KJUR.asn1.tsp.TSPUtil.parseTimeStampReq=function(m){var l=ASN1HEX,h=l.getChildIdx,f=l.getV,b=l.getTLV,j={};j.certreq=!1;var a=h(m,0);if(2>a.length){throw"TimeStampReq must have at least 2 items"}var e=b(m,a[1]);j.messageImprint=KJUR.asn1.tsp.TSPUtil.parseMessageImprint(e);for(var d=2;d<a.length;d++){var g=a[d],k=m.substr(g,2);if("06"==k){var c=f(m,g);j.policy=l.hextooidstr(c)}if("02"==k){j.nonce=f(m,g)}if("01"==k){j.certreq=!0}}return j};KJUR.asn1.tsp.TSPUtil.parseMessageImprint=function(c){var m=ASN1HEX,j=m.getChildIdx,i=m.getV,g=m.getIdxbyList,k={};if("30"!=c.substr(0,2)){throw"head of messageImprint hex shall be '30'"}var a=j(c,0),l=g(c,0,[0,0]),e=i(c,l),d=m.hextooidstr(e),h=KJUR.asn1.x509.OID.oid2name(d);if(""==h){throw"hashAlg name undefined: "+d}var f=g(c,0,[1]);k.alg=h;k.hash=i(c,f);return k};KJUR.asn1.tsp.TSPParser=function(){var e=Error,f=new X509,k=ASN1HEX,g=k.getV,b=k.getTLV,d=k.getIdxbyList,c=k.getTLVbyListEx,i=k.getChildIdx,j=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],h={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(n){var l=i(n,0);if(1==l.length){return this.getPKIStatusInfo(b(n,l[0]))}else{if(1<l.length){var o=this.getPKIStatusInfo(b(n,l[0])),m=b(n,l[1]),p=this.getToken(m);p.statusinfo=o;return p}}};this.getToken=function(m){var l=new KJUR.asn1.cms.CMSParser,n=l.getCMSSignedData(m);this.setTSTInfo(n);return n};this.setTSTInfo=function(l){var o=l.econtent;if("tstinfo"==o.type){var n=o.content.hex,m=this.getTSTInfo(n);o.content=m}};this.getTSTInfo=function(r){var x={},s=i(r,0),p=g(r,s[1]);x.policy=hextooid(p);var o=b(r,s[2]);x.messageImprint=this.getMessageImprint(o);var u=g(r,s[3]);x.serial={hex:u};var y=g(r,s[4]);x.genTime={str:hextoutf8(y)};var q=0;if(5<s.length&&"30"==r.substr(s[5],2)){var v=b(r,s[5]);x.accuracy=this.getAccuracy(v);q++}if(s.length>5+q&&"01"==r.substr(s[5+q],2)){var z=g(r,s[5+q]);if("ff"==z){x.ordering=!0}q++}if(s.length>5+q&&"02"==r.substr(s[5+q],2)){var n=g(r,s[5+q]);x.nonce={hex:n};q++}if(s.length>5+q&&"a0"==r.substr(s[5+q],2)){var m=b(r,s[5+q]);m="30"+m.substr(2);pGeneralNames=f.getGeneralNames(m);var t=pGeneralNames[0].dn;x.tsa=t;q++}if(s.length>5+q&&"a1"==r.substr(s[5+q],2)){var l=b(r,s[5+q]);l="30"+l.substr(2);var w=f.getExtParamArray(l);x.ext=w;q++}return x};this.getAccuracy=function(q){for(var r={},o=i(q,0),p=0;p<o.length;p++){var m=q.substr(o[p],2),l=g(q,o[p]),n=parseInt(l,16);if("02"==m){r.seconds=n}else{if("80"==m){r.millis=n}else{if("81"==m){r.micros=n}}}}return r};this.getMessageImprint=function(n){if("30"!=n.substr(0,2)){throw new Error("head of messageImprint hex shall be x30")}var s={},l=i(n,0),t=d(n,0,[0,0]),o=g(n,t),p=k.hextooidstr(o),r=KJUR.asn1.x509.OID.oid2name(p);if(""==r){throw new Error("hashAlg name undefined: "+p)}var q=d(n,0,[1]);s.alg=r;s.hash=g(n,q);return s};this.getPKIStatusInfo=function(o){var t={},r=i(o,0),n=0;try{var l=g(o,r[0]),p=parseInt(l,16);t.status=j[p]}catch(s){}if(1<r.length&&"30"==o.substr(r[1],2)){var m=b(o,r[1]);t.statusstr=this.getPKIFreeText(m);n++}if(r.length>n&&"03"==o.substr(r[1+n],2)){var q=b(o,r[1+n]);t.failinfo=this.getPKIFailureInfo(q)}return t};this.getPKIFreeText=function(n){for(var o=[],l=i(n,0),m=0;m<l.length;m++){o.push(k.getString(n,l[m]))}return o};this.getPKIFailureInfo=function(l){var m=k.getInt(l,0);if(h[m]!=void 0){return h[m]}else{return m}}};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.asn1||!KJUR.asn1){KJUR.asn1={}}if("undefined"==typeof KJUR.asn1.cades||!KJUR.asn1.cades){KJUR.asn1.cades={}}KJUR.asn1.cades.SignaturePolicyIdentifier=function(e){var c=KJUR,b=c.asn1,a=b.cades,d=a.SignaturePolicyId;a.SignaturePolicyIdentifier.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.16.2.15";this.params=null;this.getValueArray=function(){return[new d(this.params)]};this.setByParam=function(f){this.params=f};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cades.SignaturePolicyIdentifier,KJUR.asn1.cms.Attribute);KJUR.asn1.cades.SignaturePolicyId=function(e){var a=KJUR,g=a.asn1,f=g.DERSequence,i=g.DERObjectIdentifier,d=g.x509,j=d.AlgorithmIdentifier,c=g.cades,h=c.SignaturePolicyId,b=c.OtherHashAlgAndValue;h.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var m=this.params,k=[];k.push(new i(m.oid));k.push(new b(m));var l=new f({array:k});return l.getEncodedHex()};this.setByParam=function(k){this.params=k};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cades.SignaturePolicyId,KJUR.asn1.ASN1Object);KJUR.asn1.cades.OtherHashAlgAndValue=function(e){var h=Error,a=KJUR,g=a.asn1,f=g.DERSequence,i=g.DEROctetString,d=g.x509,j=d.AlgorithmIdentifier,c=g.cades,b=c.OtherHashAlgAndValue;b.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var o=this.params;if(o.alg==void 0){throw new h("property 'alg' not specified")}if(o.hash==void 0&&o.cert==void 0){throw new h("property 'hash' nor 'cert' not specified")}var m=null;if(o.hash!=void 0){m=o.hash}else{if(o.cert!=void 0){if("string"!=typeof o.cert){throw new h("cert not string")}var n=o.cert;if(-1!=o.cert.indexOf("-----BEGIN")){n=pemtohex(o.cert)}m=KJUR.crypto.Util.hashHex(n,o.alg)}}var k=[new j({name:o.alg}),new i({hex:m})],l=new f({array:k});return l.getEncodedHex()};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cades.OtherHashAlgAndValue,KJUR.asn1.ASN1Object);KJUR.asn1.cades.OtherHashValue=function(g){KJUR.asn1.cades.OtherHashValue.superclass.constructor.call(this);var d=Error,c=KJUR,f=c.lang.String.isHex,b=c.asn1,e=b.DEROctetString,a=c.crypto.Util.hashHex;this.params=null;this.getEncodedHex=function(){var j=this.params;if(j.hash==void 0&&j.cert==void 0){throw new d("hash or cert not specified")}var h=null;if(j.hash!=void 0){h=j.hash}else{if(j.cert!=void 0){if("string"!=typeof j.cert){throw new d("cert not string")}var i=j.cert;if(-1!=j.cert.indexOf("-----BEGIN")){i=pemtohex(j.cert)}h=KJUR.crypto.Util.hashHex(i,"sha1")}}return new e({hex:h}).getEncodedHex()};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.cades.OtherHashValue,KJUR.asn1.ASN1Object);KJUR.asn1.cades.SignatureTimeStamp=function(h){var d=Error,c=KJUR,f=c.lang.String.isHex,b=c.asn1,e=b.ASN1Object,g=b.x509,a=b.cades;a.SignatureTimeStamp.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.16.2.14";this.params=null;this.getValueArray=function(){var l=this.params;if(l.tst!=void 0){if(f(l.tst)){var j=new e;j.hTLV=l.tst;return[j]}else{if(l.tst instanceof e){return[l.tst]}else{throw new d("params.tst has wrong value")}}}else{if(l.res!=void 0){var k=l.res;if(k instanceof e){k=k.getEncodedHex()}if("string"!=typeof k||!f(k)){throw new d("params.res has wrong value")}var i=ASN1HEX.getTLVbyList(k,0,[1]),j=new e;j.hTLV=l.tst;return[j]}}};if(null!=h){this.setByParam(h)}};extendClass(KJUR.asn1.cades.SignatureTimeStamp,KJUR.asn1.cms.Attribute);KJUR.asn1.cades.CompleteCertificateRefs=function(h){var f=Error,e=KJUR,d=e.asn1,b=d.DERSequence,c=d.cades,a=c.OtherCertID,g=e.lang.String.isHex;c.CompleteCertificateRefs.superclass.constructor.call(this);this.typeOid="1.2.840.113549.1.9.16.2.21";this.params=null;this.getValueArray=function(){for(var o=this.params,k=[],m=0,n;m<o.array.length;m++){n=o.array[m];if("string"==typeof n){if(-1!=n.indexOf("-----BEGIN")){n={cert:n}}else{if(g(n)){n={hash:n}}else{throw new f("unsupported value: "+n)}}}if(o.alg!=void 0&&n.alg==void 0){n.alg=o.alg}if(o.hasis!=void 0&&n.hasis==void 0){n.hasis=o.hasis}var j=new a(n);k.push(j)}var l=new b({array:k});return[l]};if(h!=void 0){this.setByParam(h)}};extendClass(KJUR.asn1.cades.CompleteCertificateRefs,KJUR.asn1.cms.Attribute);KJUR.asn1.cades.OtherCertID=function(e){var a=KJUR,h=a.asn1,f=h.DERSequence,i=h.cms,g=i.IssuerSerial,c=h.cades,d=c.OtherHashValue,b=c.OtherHashAlgAndValue;c.OtherCertID.superclass.constructor.call(this);this.params=e;this.getEncodedHex=function(){var n=this.params;if("string"==typeof n){if(-1!=n.indexOf("-----BEGIN")){n={cert:n}}else{if(_isHex(n)){n={hash:n}}}}var j=[],m=null;if(n.alg!=void 0){m=new b(n)}else{m=new d(n)}j.push(m);if(n.cert!=void 0&&!0==n.hasis||n.issuer!=void 0&&n.serial!=void 0){var l=new g(n);j.push(l)}var k=new f({array:j});return k.getEncodedHex()};if(e!=void 0){this.setByParam(e)}};extendClass(KJUR.asn1.cades.OtherCertID,KJUR.asn1.ASN1Object);KJUR.asn1.cades.OtherHash=function(g){var i=Error,a=KJUR,h=a.asn1,j=h.cms,c=h.cades,b=c.OtherHashAlgAndValue,e=c.OtherHashValue,d=a.crypto.Util.hashHex,f=a.lang.String.isHex;c.OtherHash.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var l=this.params;if("string"==typeof l){if(-1!=l.indexOf("-----BEGIN")){l={cert:l}}else{if(f(l)){l={hash:l}}}}var k=null;if(l.alg!=void 0){k=new b(l)}else{k=new e(l)}return k.getEncodedHex()};if(g!=void 0){this.setByParam(g)}};extendClass(KJUR.asn1.cades.OtherHash,KJUR.asn1.ASN1Object);KJUR.asn1.cades.CAdESUtil=new function(){};KJUR.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(a){var c=new KJUR.asn1.cms.CMSParser,b=c.getCMSSignedData(a);return b};KJUR.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(g,q){var p=ASN1HEX,s=p.getChildIdx,a=p.getTLV,l=p.getV,v=KJUR,h=v.asn1,n=h.ASN1Object,j=h.cms,k=j.AttributeList,w=j.SignerInfo,o={},t=s(g,q);if(6!=t.length){throw"not supported items for SignerInfo (!=6)"}var d=t.shift();o.version=a(g,d);var e=t.shift();o.si=a(g,e);var m=t.shift();o.digalg=a(g,m);var f=t.shift();o.sattrs=a(g,f);var i=t.shift();o.sigalg=a(g,i);var b=t.shift();o.sig=a(g,b);o.sigval=l(g,b);var u=null;o.obj=new w;u=new n;u.hTLV=o.version;o.obj.dCMSVersion=u;u=new n;u.hTLV=o.si;o.obj.dSignerIdentifier=u;u=new n;u.hTLV=o.digalg;o.obj.dDigestAlgorithm=u;u=new n;u.hTLV=o.sattrs;o.obj.dSignedAttrs=u;u=new n;u.hTLV=o.sigalg;o.obj.dSigAlg=u;u=new n;u.hTLV=o.sig;o.obj.dSig=u;o.obj.dUnsignedAttrs=new k;return o};if("undefined"==typeof KJUR.asn1.csr||!KJUR.asn1.csr){KJUR.asn1.csr={}}KJUR.asn1.csr.CertificationRequest=function(g){var d=KJUR,c=d.asn1,e=c.DERBitString,b=c.DERSequence,a=c.csr,f=c.x509,h=a.CertificationRequestInfo;a.CertificationRequest.superclass.constructor.call(this);this.setByParam=function(i){this.params=i};this.sign=function(){var j=new h(this.params).getEncodedHex(),k=new KJUR.crypto.Signature({alg:this.params.sigalg});k.init(this.params.sbjprvkey);k.updateHex(j);var i=k.sign();this.params.sighex=i};this.getPEM=function(){return hextopem(this.getEncodedHex(),"CERTIFICATE REQUEST")};this.getEncodedHex=function(){var l=this.params,j=new KJUR.asn1.csr.CertificationRequestInfo(this.params),m=new KJUR.asn1.x509.AlgorithmIdentifier({name:l.sigalg});if(l.sighex==void 0&&l.sbjprvkey!=void 0){this.sign()}if(l.sighex==void 0){throw new Error("sighex or sbjprvkey parameter not defined")}var k=new e({hex:"00"+l.sighex}),i=new b({array:[j,m,k]});return i.getEncodedHex()};if(g!==void 0){this.setByParam(g)}};extendClass(KJUR.asn1.csr.CertificationRequest,KJUR.asn1.ASN1Object);KJUR.asn1.csr.CertificationRequestInfo=function(f){var b=KJUR,j=b.asn1,c=j.DERBitString,g=j.DERSequence,i=j.DERInteger,n=j.DERUTF8String,d=j.DERTaggedObject,h=j.ASN1Util.newObject,l=j.csr,e=j.x509,a=e.X500Name,k=e.Extensions,m=e.SubjectPublicKeyInfo;l.CertificationRequestInfo.superclass.constructor.call(this);this.params=null;this.setByParam=function(o){if(o!=void 0){this.params=o}};this.getEncodedHex=function(){var s=this.params,p=[];p.push(new i({int:0}));p.push(new a(s.subject));p.push(new m(KEYUTIL.getKey(s.sbjpubkey)));if(s.extreq!=void 0){var o=new k(s.extreq),r=h({tag:{tag:"a0",explict:!0,obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[o]}]}}});p.push(r)}else{p.push(new d({tag:"a0",explicit:!1,obj:new n({str:""})}))}var q=new g({array:p});return q.getEncodedHex()};if(f!=void 0){this.setByParam(f)}};extendClass(KJUR.asn1.csr.CertificationRequestInfo,KJUR.asn1.ASN1Object);KJUR.asn1.csr.CSRUtil=new function(){};KJUR.asn1.csr.CSRUtil.newCSRPEM=function(e){var a=KJUR.asn1.csr,c=new a.CertificationRequest(e),d=c.getPEM();return d};KJUR.asn1.csr.CSRUtil.getParam=function(c){var m=ASN1HEX,j=m.getV;_getIdxbyList=m.getIdxbyList;_getTLVbyList=m.getTLVbyList,_getTLVbyListEx=m.getTLVbyListEx,_getVbyListEx=m.getVbyListEx;var n={};if(-1==c.indexOf("-----BEGIN CERTIFICATE REQUEST")){throw new Error("argument is not PEM file")}var e=pemtohex(c,"CERTIFICATE REQUEST");try{var g=_getTLVbyListEx(e,0,[0,1]);if("3000"==g){n.subject={}}else{var k=new X509;n.subject=k.getX500Name(g)}}catch(h){}var d=_getTLVbyListEx(e,0,[0,2]),f=KEYUTIL.getKey(d,null,"pkcs8pub");n.sbjpubkey=KEYUTIL.getPEM(f,"PKCS8PUB");var i=function(p){var o=_getIdxbyList(p,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=j(p,o)){return null}return _getTLVbyList(p,0,[0,3,0,1,0],"30")}(e),k=new X509;if(null!=i){n.extreq=k.getExtParamArray(i)}try{var a=_getTLVbyListEx(e,0,[1],"30"),k=new X509;n.sigalg=k.getAlgorithmIdentifierName(a)}catch(h){}try{var l=_getVbyListEx(e,0,[2]);n.sighex=l}catch(h){}return n};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.asn1||!KJUR.asn1){KJUR.asn1={}}if("undefined"==typeof KJUR.asn1.ocsp||!KJUR.asn1.ocsp){KJUR.asn1.ocsp={}}KJUR.asn1.ocsp.DEFAULT_HASH="sha1";KJUR.asn1.ocsp.OCSPResponse=function(e){KJUR.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);var a=KJUR.asn1.DEREnumerated,b=KJUR.asn1.ASN1Util.newObject,c=KJUR.asn1.ocsp.ResponseBytes,d=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null;this._getStatusCode=function(){var f=this.params.resstatus;if("number"==typeof f){return f}if("string"!=typeof f){return-1}return d.indexOf(f)};this.setByParam=function(f){this.params=f};this.getEncodedHex=function(){var h=this.params,g=this._getStatusCode();if(-1==g){throw new Error("responseStatus not supported: "+h.resstatus)}if(0!=g){return b({seq:[{enum:{int:g}}]}).getEncodedHex()}var f=new c(h);return b({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:f}}]}).getEncodedHex()};if(e!==void 0){this.setByParam(e)}};extendClass(KJUR.asn1.ocsp.OCSPResponse,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.ResponseBytes=function(e){KJUR.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var b=KJUR.asn1,a=b.DERSequence,f=b.DERObjectIdentifier,c=b.DEROctetString,d=b.ocsp.BasicOCSPResponse;this.params=null;this.setByParam=function(g){this.params=g};this.getEncodedHex=function(){var j=this.params;if("ocspBasic"!=j.restype){throw new Error("not supported responseType: "+j.restype)}var i=new d(j),g=[];g.push(new f({name:"ocspBasic"}));g.push(new c({hex:i.getEncodedHex()}));var h=new a({array:g});return h.getEncodedHex()};if(e!==void 0){this.setByParam(e)}};extendClass(KJUR.asn1.ocsp.ResponseBytes,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.BasicOCSPResponse=function(d){KJUR.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var i=Error,g=KJUR.asn1,j=g.ASN1Object,e=g.DERSequence,f=g.DERGeneralizedTime,c=g.DERTaggedObject,b=g.DERBitString,h=g.x509.Extensions,k=g.x509.AlgorithmIdentifier,l=g.ocsp,a=l.ResponderID;_SingleResponseList=l.SingleResponseList,_ResponseData=l.ResponseData;this.params=null;this.setByParam=function(m){this.params=m};this.sign=function(){var o=this.params,m=o.tbsresp.getEncodedHex(),n=new KJUR.crypto.Signature({alg:o.sigalg});n.init(o.reskey);n.updateHex(m);o.sighex=n.sign()};this.getEncodedHex=function(){var t=this.params;if(t.tbsresp==void 0){t.tbsresp=new _ResponseData(t)}if(t.sighex==void 0&&t.reskey!=void 0){this.sign()}var n=[t.tbsresp,new k({name:t.sigalg}),new b({hex:"00"+t.sighex})];if(t.certs!=void 0&&t.certs.length!=void 0){for(var m=[],q=0;q<t.certs.length;q++){var s=t.certs[q],r=null;if(ASN1HEX.isASN1HEX(s)){r=s}else{if(s.match(/-----BEGIN/)){r=pemtohex(s)}else{throw new i("certs["+q+"] not hex or PEM")}}m.push(new j({tlv:r}))}var p=new e({array:m});n.push(new c({tag:"a0",explicit:!0,obj:p}))}var o=new e({array:n});return o.getEncodedHex()};if(d!==void 0){this.setByParam(d)}};extendClass(KJUR.asn1.ocsp.BasicOCSPResponse,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.ResponseData=function(c){KJUR.asn1.ocsp.ResponseData.superclass.constructor.call(this);var h=Error,f=KJUR.asn1,d=f.DERSequence,e=f.DERGeneralizedTime,b=f.DERTaggedObject,g=f.x509.Extensions,i=f.ocsp,a=i.ResponderID;_SingleResponseList=i.SingleResponseList;this.params=null;this.getEncodedHex=function(){var m=this.params;if(m.respid!=void 0){new h("respid not specified")}if(m.prodat!=void 0){new h("prodat not specified")}if(m.array!=void 0){new h("array not specified")}var j=[new a(m.respid),new e(m.prodat),new _SingleResponseList(m.array)];if(m.ext!=void 0){var l=new g(m.ext);j.push(new b({tag:"a1",explicit:!0,obj:l}))}var k=new d({array:j});return k.getEncodedHex()};this.setByParam=function(j){this.params=j};if(c!==void 0){this.setByParam(c)}};extendClass(KJUR.asn1.ocsp.ResponseData,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.ResponderID=function(d){KJUR.asn1.ocsp.ResponderID.superclass.constructor.call(this);var b=KJUR.asn1,a=b.ASN1Util.newObject,c=b.x509.X500Name;this.params=null;this.getEncodedHex=function(){var f=this.params;if(f.key!=void 0){var e=a({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:f.key}}}});return e.getEncodedHex()}else{if(f.name!=void 0){var e=a({tag:{tag:"a1",explicit:!0,obj:new c(f.name)}});return e.getEncodedHex()}}throw new Error("key or name not specified")};this.setByParam=function(e){this.params=e};if(d!==void 0){this.setByParam(d)}};extendClass(KJUR.asn1.ocsp.ResponderID,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.SingleResponseList=function(d){KJUR.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var c=KJUR.asn1,b=c.DERSequence,a=c.ocsp.SingleResponse;this.params=null;this.getEncodedHex=function(){var h=this.params;if("object"!=typeof h||h.length==void 0){throw new Error("params not specified properly")}for(var e=[],g=0;g<h.length;g++){e.push(new a(h[g]))}var f=new b({array:e});return f.getEncodedHex()};this.setByParam=function(e){this.params=e};if(d!==void 0){this.setByParam(d)}};extendClass(KJUR.asn1.ocsp.SingleResponseList,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.SingleResponse=function(e){var k=Error,a=KJUR,i=a.asn1,f=i.DERSequence,g=i.DERGeneralizedTime,b=i.DERTaggedObject,l=i.ocsp,h=l.CertID,c=l.CertStatus,d=i.x509,j=d.Extensions;l.SingleResponse.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var q=this.params,n=[];if(q.certid==void 0){throw new k("certid unspecified")}if(q.status==void 0){throw new k("status unspecified")}if(q.thisupdate==void 0){throw new k("thisupdate unspecified")}n.push(new h(q.certid));n.push(new c(q.status));n.push(new g(q.thisupdate));if(q.nextupdate!=void 0){var m=new g(q.nextupdate);n.push(new b({tag:"a0",explicit:!0,obj:m}))}if(q.ext!=void 0){var p=new j(q.ext);n.push(new b({tag:"a1",explicit:!0,obj:p}))}var o=new f({array:n});return o.getEncodedHex()};this.setByParam=function(m){this.params=m};if(e!==void 0){this.setByParam(e)}};extendClass(KJUR.asn1.ocsp.SingleResponse,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.CertID=function(g){var d=KJUR,k=d.asn1,m=k.DEROctetString,j=k.DERInteger,h=k.DERSequence,f=k.x509,n=f.AlgorithmIdentifier,o=k.ocsp,l=o.DEFAULT_HASH,i=d.crypto,e=i.Util.hashHex,c=X509;o.CertID.superclass.constructor.call(this);this.dHashAlg=null;this.dIssuerNameHash=null;this.dIssuerKeyHash=null;this.dSerialNumber=null;this.setByValue=function(t,s,p,r){if(r===void 0){r=l}this.dHashAlg=new n({name:r});this.dIssuerNameHash=new m({hex:t});this.dIssuerKeyHash=new m({hex:s});this.dSerialNumber=new j({hex:p})};this.setByCert=function(x,t,v){if(v===void 0){v=l}var p=new c;p.readCertPEM(t);var y=new c;y.readCertPEM(x);var z=y.getPublicKeyHex(),w=ASN1HEX.getVbyList(z,0,[1],"03",!0),r=p.getSerialNumberHex(),s=e(y.getSubjectHex(),v),u=e(w,v);this.setByValue(s,u,r,v);this.hoge=p.getSerialNumberHex()};this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber){throw"not yet set values"}var p=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],r=new h({array:p});this.hTLV=r.getEncodedHex();return this.hTLV};if(g!==void 0){var b=g;if(b.issuerCert!==void 0&&b.subjectCert!==void 0){var a=l;if(b.alg===void 0){a=void 0}this.setByCert(b.issuerCert,b.subjectCert,a)}else{if(b.issname!==void 0&&b.isskey!==void 0&&b.sbjsn!==void 0){var a=l;if(b.alg===void 0){a=void 0}this.setByValue(b.issname,b.isskey,b.sbjsn,a)}else{throw new Error("invalid constructor arguments")}}}};extendClass(KJUR.asn1.ocsp.CertID,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.CertStatus=function(a){KJUR.asn1.ocsp.CertStatus.superclass.constructor.call(this);this.params=null;this.getEncodedHex=function(){var d=this.params;if("good"==d.status){return"8000"}if("unknown"==d.status){return"8200"}if("revoked"==d.status){var c=[{gentime:{str:d.time}}];if(d.reason!=void 0){c.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:d.reason}}}})}return KJUR.asn1.ASN1Util.newObject({tag:{tag:"a1",explicit:!1,obj:{seq:c}}}).getEncodedHex()}throw new Error("bad status")};this.setByParam=function(b){this.params=b};if(a!==void 0){this.setByParam(a)}};extendClass(KJUR.asn1.ocsp.CertStatus,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.Request=function(f){var c=KJUR,b=c.asn1,a=b.DERSequence,d=b.ocsp;d.Request.superclass.constructor.call(this);this.dReqCert=null;this.dExt=null;this.getEncodedHex=function(){var g=[];if(null===this.dReqCert){throw"reqCert not set"}g.push(this.dReqCert);var h=new a({array:g});this.hTLV=h.getEncodedHex();return this.hTLV};if("undefined"!==typeof f){var e=new d.CertID(f);this.dReqCert=e}};extendClass(KJUR.asn1.ocsp.Request,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.TBSRequest=function(e){var c=KJUR,b=c.asn1,a=b.DERSequence,d=b.ocsp;d.TBSRequest.superclass.constructor.call(this);this.version=0;this.dRequestorName=null;this.dRequestList=[];this.dRequestExt=null;this.setRequestListByParam=function(h){for(var f=[],g=0,j;g<h.length;g++){j=new d.Request(h[0]);f.push(j)}this.dRequestList=f};this.getEncodedHex=function(){var f=[];if(0!==this.version){throw"not supported version: "+this.version}if(null!==this.dRequestorName){throw"requestorName not supported"}var h=new a({array:this.dRequestList});f.push(h);if(null!==this.dRequestExt){throw"requestExtensions not supported"}var g=new a({array:f});this.hTLV=g.getEncodedHex();return this.hTLV};if(e!==void 0){if(e.reqList!==void 0){this.setRequestListByParam(e.reqList)}}};extendClass(KJUR.asn1.ocsp.TBSRequest,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.OCSPRequest=function(f){var c=KJUR,b=c.asn1,a=b.DERSequence,d=b.ocsp;d.OCSPRequest.superclass.constructor.call(this);this.dTbsRequest=null;this.dOptionalSignature=null;this.getEncodedHex=function(){var g=[];if(null!==this.dTbsRequest){g.push(this.dTbsRequest)}else{throw"tbsRequest not set"}if(null!==this.dOptionalSignature){throw"optionalSignature not supported"}var h=new a({array:g});this.hTLV=h.getEncodedHex();return this.hTLV};if(f!==void 0){if(f.reqList!==void 0){var e=new d.TBSRequest(f);this.dTbsRequest=e}}};extendClass(KJUR.asn1.ocsp.OCSPRequest,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.OCSPUtil={};KJUR.asn1.ocsp.OCSPUtil.getRequestHex=function(a,b,h){var d=KJUR,c=d.asn1,e=c.ocsp;if(h===void 0){h=e.DEFAULT_HASH}var g={alg:h,issuerCert:a,subjectCert:b},f=new e.OCSPRequest({reqList:[g]});return f.getEncodedHex()};KJUR.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(b){var m=ASN1HEX,c=m.getVbyList,k=m.getVbyListEx,e=m.getIdxbyList,d=m.getIdxbyListEx,g=m.getV,n={};try{var j=k(b,0,[0],"0a");n.responseStatus=parseInt(j,16)}catch(f){}if(0!==n.responseStatus){return n}try{var i=e(b,0,[1,0,1,0,0,2,0,1]);if("80"===b.substr(i,2)){n.certStatus="good"}else{if("a1"===b.substr(i,2)){n.certStatus="revoked";n.revocationTime=hextoutf8(c(b,i,[0]))}else{if("82"===b.substr(i,2)){n.certStatus="unknown"}}}}catch(f){}try{var a=e(b,0,[1,0,1,0,0,2,0,2]);n.thisUpdate=hextoutf8(g(b,a))}catch(f){}try{var l=e(b,0,[1,0,1,0,0,2,0,3]);if("a0"===b.substr(l,2)){n.nextUpdate=hextoutf8(c(b,l,[0]))}}catch(f){}return n};KJUR.asn1.ocsp.OCSPParser=function(){var g=Error,a=X509,h=new a,l=ASN1HEX,i=l.getV,b=l.getTLV,f=l.getIdxbyList,e=l.getVbyList,c=l.getTLVbyList,k=l.getVbyListEx,d=l.getTLVbyListEx,j=l.getChildIdx;this.getOCSPRequest=function(o){var n=j(o,0);if(1!=n.length&&2!=n.length){throw new g("wrong number elements: "+n.length)}var m=this.getTBSRequest(b(o,n[0]));return m};this.getTBSRequest=function(o){var m={},n=d(o,0,[0],"30");m.array=this.getRequestList(n);var p=d(o,0,["[2]",0],"30");if(null!=p){m.ext=h.getExtParamArray(p)}return m};this.getRequestList=function(p){for(var m=[],n=j(p,0),o=0,p;o<n.length;o++){p=b(p,n[o]);m.push(this.getRequest(p))}return m};this.getRequest=function(n){var m=j(n,0);if(1!=m.length&&2!=m.length){throw new g("wrong number elements: "+m.length)}var p=this.getCertID(b(n,m[0]));if(2==m.length){var o=f(n,0,[1,0]);p.ext=h.getExtParamArray(b(n,o))}return p};this.getCertID=function(p){var o=j(p,0);if(4!=o.length){throw new g("wrong number elements: "+o.length)}var n=new a,m={};m.alg=n.getAlgorithmIdentifierName(b(p,o[0]));m.issname=i(p,o[1]);m.isskey=i(p,o[2]);m.sbjsn=i(p,o[3]);return m};this.getOCSPResponse=function(r){var o=j(r,0),m,q=i(r,o[0]),p=parseInt(q);if(1==o.length){return{resstatus:p}}var n=c(r,0,[1,0]);m=this.getResponseBytes(n);m.resstatus=p;return m};this.getResponseBytes=function(p){var o=j(p,0),n,q=c(p,0,[1,0]);n=this.getBasicOCSPResponse(q);var m=i(p,o[0]);n.restype=KJUR.asn1.x509.OID.oid2name(hextooid(m));return n};this.getBasicOCSPResponse=function(q){var t=j(q,0),v;v=this.getResponseData(b(q,t[0]));var u=new X509;v.alg=u.getAlgorithmIdentifierName(b(q,t[1]));var n=i(q,t[2]);v.sighex=n.substr(2);var m=k(q,0,["[0]"]);if(null!=m){for(var r=j(m,0),o=[],p=0,s;p<r.length;p++){s=b(m,r[p]);o.push(s)}v.certs=o}return v};this.getResponseData=function(q){var p=j(q,0),r=p.length,o={},n=0;if("a0"==q.substr(p[0],2)){n++}o.respid=this.getResponderID(b(q,p[n++]));var t=i(q,p[n++]);o.prodat=hextoutf8(t);o.array=this.getSingleResponseList(b(q,p[n++]));if("a1"==q.substr(p[r-1],2)){var s=c(q,p[r-1],[0]),m=new X509;o.ext=m.getExtParamArray(s)}return o};this.getResponderID=function(o){var n={};if("a2"==o.substr(0,2)){var p=e(o,0,[0]);n.key=p}if("a1"==o.substr(0,2)){var q=c(o,0,[0]),m=new X509;n.name=m.getX500Name(q)}return n};this.getSingleResponseList=function(q){for(var n=j(q,0),m=[],o=0,r;o<n.length;o++){r=this.getSingleResponse(b(q,n[o]));m.push(r)}return m};this.getSingleResponse=function(p){var t=j(p,0),v={},r=this.getCertID(b(p,t[0]));v.certid=r;var u=this.getCertStatus(b(p,t[1]));v.status=u;if("18"==p.substr(t[2],2)){var q=i(p,t[2]);v.thisupdate=hextoutf8(q)}for(var o=3;o<t.length;o++){if("a0"==p.substr(t[o],2)){var m=e(p,t[o],[0],"18");v.nextupdate=hextoutf8(m)}if("a1"==p.substr(t[o],2)){var s=new X509,n=c(p,0,[o,0]);v.ext=s.getExtParamArray(n)}}return v};this.getCertStatus=function(p){var m={};if("8000"==p){return{status:"good"}}if("8200"==p){return{status:"unknown"}}if("a1"==p.substr(0,2)){m.status="revoked";var o=e(p,0,[0]),n=hextoutf8(o);m.time=n}return m}};var KJUR;if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.lang||!KJUR.lang){KJUR.lang={}}KJUR.lang.String=function(){};function Base64x(){}function stoBA(d){for(var b=[],c=0;c<d.length;c++){b[c]=d.charCodeAt(c)}return b}function BAtos(b){for(var d="",c=0;c<b.length;c++){d=d+String.fromCharCode(b[c])}return d}function BAtohex(b){for(var e="",d=0,c;d<b.length;d++){c=b[d].toString(16);if(1==c.length){c="0"+c}e=e+c}return e}function stohex(a){return BAtohex(stoBA(a))}function stob64(a){return hex2b64(stohex(a))}function stob64u(a){return b64tob64u(hex2b64(stohex(a)))}function b64utos(a){return BAtos(b64toBA(b64utob64(a)))}function b64tob64u(a){a=a.replace(/\=/g,"");a=a.replace(/\+/g,"-");a=a.replace(/\//g,"_");return a}function b64utob64(a){if(2==a.length%4){a=a+"=="}else{if(3==a.length%4){a=a+"="}}a=a.replace(/-/g,"+");a=a.replace(/_/g,"/");return a}function hextob64u(a){if(1==a.length%2){a="0"+a}return b64tob64u(hex2b64(a))}function b64utohex(a){return b64tohex(b64utob64(a))}var utf8tob64u,b64utoutf8;if("function"===typeof Buffer){utf8tob64u=function(a){return b64tob64u(Buffer.from(a,"utf8").toString("base64"))};b64utoutf8=function(a){return Buffer.from(b64utob64(a),"base64").toString("utf8")}}else{utf8tob64u=function(a){return hextob64u(uricmptohex(encodeURIComponentAll(a)))};b64utoutf8=function(a){return decodeURIComponent(hextouricmp(b64utohex(a)))}}function utf8tob64(a){return hex2b64(uricmptohex(encodeURIComponentAll(a)))}function b64toutf8(a){return decodeURIComponent(hextouricmp(b64tohex(a)))}function utf8tohex(a){return uricmptohex(encodeURIComponentAll(a))}function hextoutf8(a){return decodeURIComponent(hextouricmp(a))}function hextorstr(c){for(var b="",a=0;a<c.length-1;a+=2){b+=String.fromCharCode(parseInt(c.substr(a,2),16))}return b}function rstrtohex(c){for(var a="",b=0;b<c.length;b++){a+=("0"+c.charCodeAt(b).toString(16)).slice(-2)}return a}function hextob64(a){return hex2b64(a)}function hextob64nl(b){var a=hextob64(b),c=a.replace(/(.{64})/g,"$1\r\n");c=c.replace(/\r\n$/,"");return c}function b64nltohex(b){var a=b.replace(/[^0-9A-Za-z\/+=]*/g,""),c=b64tohex(a);return c}function hextopem(a,b){var c=hextob64nl(a);return"-----BEGIN "+b+"-----\r\n"+c+"\r\n-----END "+b+"-----\r\n"}function pemtohex(a,b){if(-1==a.indexOf("-----BEGIN ")){throw"can't find PEM header: "+b}if(b!==void 0){a=a.replace(new RegExp("^[^]*-----BEGIN "+b+"-----"),"");a=a.replace(new RegExp("-----END "+b+"-----[^]*$"),"")}else{a=a.replace(/^[^]*-----BEGIN [^-]+-----/,"");a=a.replace(/-----END [^-]+-----[^]*$/,"")}return b64nltohex(a)}function hextoArrayBuffer(d){if(0!=d.length%2){throw"input is not even length"}if(null==d.match(/^[0-9A-Fa-f]+$/)){throw"input is not hexadecimal"}for(var b=new ArrayBuffer(d.length/2),a=new DataView(b),c=0;c<d.length/2;c++){a.setUint8(c,parseInt(d.substr(2*c,2),16))}return b}function ArrayBuffertohex(b){for(var d="",a=new DataView(b),c=0;c<b.byteLength;c++){d+=("00"+a.getUint8(c).toString(16)).slice(-2)}return d}function zulutomsec(n){var l,j,m,e,f,i,b,a,h,g,c;c=n.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/);if(c){a=c[1];l=parseInt(a);if(2===a.length){if(50<=l&&100>l){l=1900+l}else{if(0<=l&&50>l){l=2e3+l}}}j=parseInt(c[2])-1;m=parseInt(c[3]);e=parseInt(c[4]);f=parseInt(c[5]);i=parseInt(c[6]);b=0;h=c[7];if(""!==h){g=(h.substr(1)+"00").substr(0,3);b=parseInt(g)}return Date.UTC(l,j,m,e,f,i,b)}throw"unsupported zulu format: "+n}function zulutosec(a){var b=zulutomsec(a);return~~(b/1e3)}function zulutodate(a){return new Date(zulutomsec(a))}function datetozulu(g,e,f){var b,a=g.getUTCFullYear();if(e){if(1950>a||2049<a){throw"not proper year for UTCTime: "+a}b=(""+a).slice(-2)}else{b=("000"+a).slice(-4)}b+=("0"+(g.getUTCMonth()+1)).slice(-2);b+=("0"+g.getUTCDate()).slice(-2);b+=("0"+g.getUTCHours()).slice(-2);b+=("0"+g.getUTCMinutes()).slice(-2);b+=("0"+g.getUTCSeconds()).slice(-2);if(f){var c=g.getUTCMilliseconds();if(0!==c){c=("00"+c).slice(-3);c=c.replace(/0+$/g,"");b+="."+c}}b+="Z";return b}function uricmptohex(a){return a.replace(/%/g,"")}function hextouricmp(a){return a.replace(/(..)/g,"%$1")}function ipv6tohex(g){var b="malformed IPv6 address";if(!g.match(/^[0-9A-Fa-f:]+$/)){throw b}g=g.toLowerCase();var d=g.split(":").length-1;if(2>d){throw b}var e=":".repeat(7-d+2);g=g.replace("::",e);var c=g.split(":");if(8!=c.length){throw b}for(var f=0;8>f;f++){c[f]=("0000"+c[f]).slice(-4)}return c.join("")}function hextoipv6(e){if(!e.match(/^[0-9A-Fa-f]{32}$/)){throw"malformed IPv6 address octet"}e=e.toLowerCase();for(var b=e.match(/.{1,4}/g),d=0;8>d;d++){b[d]=b[d].replace(/^0+/,"");if(""==b[d]){b[d]="0"}}e=":"+b.join(":")+":";var c=e.match(/:(0:){2,}/g);if(null===c){return e.slice(1,-1)}for(var f="",d=0;d<c.length;d++){if(c[d].length>f.length){f=c[d]}}e=e.replace(f,"::");return e.slice(1,-1)}function hextoip(b){var d="malformed hex value";if(!b.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/)){throw d}if(8==b.length){var c;try{c=parseInt(b.substr(0,2),16)+"."+parseInt(b.substr(2,2),16)+"."+parseInt(b.substr(4,2),16)+"."+parseInt(b.substr(6,2),16);return c}catch(a){throw d}}else{if(32==b.length){return hextoipv6(b)}else{return b}}}function iptohex(f){var j="malformed IP address";f=f.toLowerCase(f);if(f.match(/^[0-9.]+$/)){var b=f.split(".");if(4!==b.length){throw j}var g="";try{for(var e=0,h;4>e;e++){h=parseInt(b[e]);g+=("0"+h.toString(16)).slice(-2)}return g}catch(c){throw j}}else{if(f.match(/^[0-9a-f:]+$/)&&-1!==f.indexOf(":")){return ipv6tohex(f)}else{throw j}}}function ucs2hextoutf8(d){var c=d.match(/.{4}/g),b=c.map(function(f){var h=parseInt(f.substr(0,2),16),a=parseInt(f.substr(2),16);if(0==h&128>a){return String.fromCharCode(a)}if(8>h){var j=192|(7&h)<<3|(192&a)>>6,i=128|63&a;return hextoutf8(j.toString(16)+i.toString(16))}var j=224|(240&h)>>4,i=128|(15&h)<<2|(192&a)>>6;return hextoutf8(j.toString(16)+i.toString(16)+(128|63&a).toString(16))});return b.join("")}function encodeURIComponentAll(a){for(var d=encodeURIComponent(a),b="",c=0;c<d.length;c++){if("%"==d[c]){b=b+d.substr(c,3);c=c+2}else{b=b+"%"+stohex(d[c])}}return b}function newline_toUnix(a){a=a.replace(/\r\n/mg,"\n");return a}function newline_toDos(a){a=a.replace(/\r\n/mg,"\n");a=a.replace(/\n/mg,"\r\n");return a}KJUR.lang.String.isInteger=function(a){if(a.match(/^[0-9]+$/)){return!0}else{if(a.match(/^-[0-9]+$/)){return!0}else{return!1}}};KJUR.lang.String.isHex=function(a){return ishex(a)};function ishex(a){if(0==a.length%2&&(a.match(/^[0-9a-f]+$/)||a.match(/^[0-9A-F]+$/))){return!0}else{return!1}}KJUR.lang.String.isBase64=function(a){a=a.replace(/\s+/g,"");if(a.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&0==a.length%4){return!0}else{return!1}};KJUR.lang.String.isBase64URL=function(a){if(a.match(/[+/=]/)){return!1}a=b64utob64(a);return KJUR.lang.String.isBase64(a)};KJUR.lang.String.isIntegerArray=function(a){a=a.replace(/\s+/g,"");if(a.match(/^\[[0-9,]+\]$/)){return!0}else{return!1}};KJUR.lang.String.isPrintable=function(a){if(null!==a.match(/^[0-9A-Za-z '()+,-./:=?]*$/)){return!0}return!1};KJUR.lang.String.isIA5=function(a){if(null!==a.match(/^[\x20-\x21\x23-\x7f]*$/)){return!0}return!1};KJUR.lang.String.isMail=function(a){if(null!==a.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)){return!0}return!1};function hextoposhex(a){if(1==a.length%2){return"0"+a}if("7"<a.substr(0,1)){return"00"+a}return a}function intarystrtohex(b){b=b.replace(/^\s*\[\s*/,"");b=b.replace(/\s*\]\s*$/,"");b=b.replace(/\s*/g,"");try{var c=b.split(/,/).map(function(g){var f=parseInt(g);if(0>f||255<f){throw"integer not in range 0-255"}var d=("00"+f.toString(16)).slice(-2);return d}).join("");return c}catch(a){throw"malformed integer array string: "+a}}var strdiffidx=function(c,a){var d=c.length;if(c.length>a.length){d=a.length}for(var b=0;b<d;b++){if(c.charCodeAt(b)!=a.charCodeAt(b)){return b}}if(c.length!=a.length){return d}return-1};function oidtohex(g){var f=function(a){var l=a.toString(16);if(1==l.length){l="0"+l}return l},e=function(p){var o="",l=parseInt(p,10),a=l.toString(2),m=7-a.length%7;if(7==m){m=0}for(var r="",n=0;n<m;n++){r+="0"}a=r+a;for(var n=0,q;n<a.length-1;n+=7){q=a.substr(n,7);if(n!=a.length-7){q="1"+q}o+=f(parseInt(q,2))}return o};try{if(!g.match(/^[0-9.]+$/)){return null}var j="",b=g.split("."),k=40*parseInt(b[0],10)+parseInt(b[1],10);j+=f(k);b.splice(0,2);for(var d=0;d<b.length;d++){j+=e(b[d])}return j}catch(c){return null}}function hextooid(g){if(!ishex(g)){return null}try{var m=[],p=g.substr(0,2),e=parseInt(p,16);m[0]=new String(Math.floor(e/40));m[1]=new String(e%40);for(var n=g.substr(2),l=[],f=0;f<n.length/2;f++){l.push(parseInt(n.substr(2*f,2),16))}for(var k=[],d="",f=0;f<l.length;f++){if(128&l[f]){d=d+strpad((127&l[f]).toString(2),7)}else{d=d+strpad((127&l[f]).toString(2),7);k.push(new String(parseInt(d,2)));d=""}}var o=m.join(".");if(0<k.length){o=o+"."+k.join(".")}return o}catch(j){return null}}var strpad=function(c,b,a){if(a==void 0){a="0"}if(c.length>=b){return c}return Array(b-c.length+1).join(a)+c};function bitstrtoint(e){try{var a=e.substr(0,2);if("00"==a){return parseInt(e.substr(2),16)}var b=parseInt(a,16),f=e.substr(2),d=parseInt(f,16).toString(2);if("0"==d){d="00000000"}d=d.slice(0,0-b);return parseInt(d,2)}catch(c){return-1}}function inttobitstr(e){var c=(+e).toString(2),b=8-c.length%8;if(8==b){b=0}c=c+strpad("",b,"0");var d=parseInt(c,2).toString(16);if(1==d.length%2){d="0"+d}var a="0"+b;return a+d}function extendClass(c,a){var b=function(){};b.prototype=a.prototype;c.prototype=new b;c.prototype.constructor=c;c.superclass=a.prototype;if(a.prototype.constructor==Object.prototype.constructor){a.prototype.constructor=a}}if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.crypto||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"};this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160};this.getDigestInfoHex=function(a,b){if("undefined"==typeof this.DIGESTINFOHEAD[b]){throw"alg not supported in Util.DIGESTINFOHEAD: "+b}return this.DIGESTINFOHEAD[b]+a};this.getPaddedDigestInfoHex=function(h,a,j){var c=this.getDigestInfoHex(h,a),d=j/4;if(c.length+22>d){throw"key is too short for SigAlg: keylen="+j+","+a}for(var b="0001",k="00"+c,g="",l=d-b.length-k.length,f=0;f<l;f+=2){g+="ff"}var e=b+g+k;return e};this.hashString=function(a,c){var b=new KJUR.crypto.MessageDigest({alg:c});return b.digestString(a)};this.hashHex=function(b,c){var a=new KJUR.crypto.MessageDigest({alg:c});return a.digestHex(b)};this.sha1=function(a){return this.hashString(a,"sha1")};this.sha256=function(a){return this.hashString(a,"sha256")};this.sha256Hex=function(a){return this.hashHex(a,"sha256")};this.sha512=function(a){return this.hashString(a,"sha512")};this.sha512Hex=function(a){return this.hashHex(a,"sha512")};this.isKey=function(a){if(a instanceof RSAKey||a instanceof KJUR.crypto.DSA||a instanceof KJUR.crypto.ECDSA){return!0}else{return!1}}};KJUR.crypto.Util.md5=function(a){var b=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return b.digestString(a)};KJUR.crypto.Util.ripemd160=function(a){var b=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return b.digestString(a)};KJUR.crypto.Util.SECURERANDOMGEN=new SecureRandom;KJUR.crypto.Util.getRandomHexOfNbytes=function(b){var a=Array(b);KJUR.crypto.Util.SECURERANDOMGEN.nextBytes(a);return BAtohex(a)};KJUR.crypto.Util.getRandomBigIntegerOfNbytes=function(a){return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbytes(a),16)};KJUR.crypto.Util.getRandomHexOfNbits=function(d){var c=d%8,b=Array((d-c)/8+1);KJUR.crypto.Util.SECURERANDOMGEN.nextBytes(b);b[0]=(255^255&255<<c)&b[0];return BAtohex(b)};KJUR.crypto.Util.getRandomBigIntegerOfNbits=function(a){return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbits(a),16)};KJUR.crypto.Util.getRandomBigIntegerZeroToMax=function(b){var a=b.bitLength();while(1){var c=KJUR.crypto.Util.getRandomBigIntegerOfNbits(a);if(-1!=b.compareTo(c)){return c}}};KJUR.crypto.Util.getRandomBigIntegerMinToMax=function(e,b){var c=e.compareTo(b);if(1==c){throw"biMin is greater than biMax"}if(0==c){return e}var a=b.subtract(e),d=KJUR.crypto.Util.getRandomBigIntegerZeroToMax(a);return d.add(e)};KJUR.crypto.MessageDigest=function(c){this.setAlgAndProvider=function(g,f){g=KJUR.crypto.MessageDigest.getCanonicalAlgName(g);if(null!==g&&f===void 0){f=KJUR.crypto.Util.DEFAULTPROVIDER[g]}if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)&&"cryptojs"==f){try{this.md=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+g+"/"+e}this.updateString=function(h){this.md.update(h)};this.updateHex=function(h){var i=CryptoJS.enc.Hex.parse(h);this.md.update(i)};this.digest=function(){var h=this.md.finalize();return h.toString(CryptoJS.enc.Hex)};this.digestString=function(h){this.updateString(h);return this.digest()};this.digestHex=function(h){this.updateHex(h);return this.digest()}}if(-1!=":sha256:".indexOf(g)&&"sjcl"==f){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+g+"/"+e}this.updateString=function(h){this.md.update(h)};this.updateHex=function(i){var h=sjcl.codec.hex.toBits(i);this.md.update(h)};this.digest=function(){var h=this.md.finalize();return sjcl.codec.hex.fromBits(h)};this.digestString=function(h){this.updateString(h);return this.digest()};this.digestHex=function(h){this.updateHex(h);return this.digest()}}};this.updateString=function(){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.updateHex=function(){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestString=function(){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestHex=function(){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};if(c!==void 0){if(c.alg!==void 0){this.algName=c.alg;if(c.prov===void 0){this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};KJUR.crypto.MessageDigest.getCanonicalAlgName=function(a){if("string"===typeof a){a=a.toLowerCase();a=a.replace(/-/,"")}return a};KJUR.crypto.MessageDigest.getHashLength=function(c){var b=KJUR.crypto.MessageDigest,a=b.getCanonicalAlgName(c);if(b.HASHLENGTH[a]===void 0){throw"not supported algorithm: "+c}return b.HASHLENGTH[a]};KJUR.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};KJUR.crypto.Mac=function(d){this.setAlgAndProvider=function(k,i){k=k.toLowerCase();if(null==k){k="hmacsha1"}k=k.toLowerCase();if("hmac"!=k.substr(0,4)){throw"setAlgAndProvider unsupported HMAC alg: "+k}if(i===void 0){i=KJUR.crypto.Util.DEFAULTPROVIDER[k]}this.algProv=k+"/"+i;var g=k.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)&&"cryptojs"==i){try{var j=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g];this.mac=CryptoJS.algo.HMAC.create(j,this.pass)}catch(h){throw"setAlgAndProvider hash alg set fail hashAlg="+g+"/"+h}this.updateString=function(l){this.mac.update(l)};this.updateHex=function(l){var m=CryptoJS.enc.Hex.parse(l);this.mac.update(m)};this.doFinal=function(){var l=this.mac.finalize();return l.toString(CryptoJS.enc.Hex)};this.doFinalString=function(l){this.updateString(l);return this.doFinal()};this.doFinalHex=function(l){this.updateHex(l);return this.doFinal()}}};this.updateString=function(){throw"updateString(str) not supported for this alg/prov: "+this.algProv};this.updateHex=function(){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv};this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv};this.doFinalString=function(){throw"digestString(str) not supported for this alg/prov: "+this.algProv};this.doFinalHex=function(){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv};this.setPassword=function(h){if("string"==typeof h){var g=h;if(1==h.length%2||!h.match(/^[0-9A-Fa-f]+$/)){g=rstrtohex(h)}this.pass=CryptoJS.enc.Hex.parse(g);return}if("object"!=typeof h){throw"KJUR.crypto.Mac unsupported password type: "+h}var g=null;if(h.hex!==void 0){if(0!=h.hex.length%2||!h.hex.match(/^[0-9A-Fa-f]+$/)){throw"Mac: wrong hex password: "+h.hex}g=h.hex}if(h.utf8!==void 0){g=utf8tohex(h.utf8)}if(h.rstr!==void 0){g=rstrtohex(h.rstr)}if(h.b64!==void 0){g=b64tohex(h.b64)}if(h.b64u!==void 0){g=b64utohex(h.b64u)}if(null==g){throw"KJUR.crypto.Mac unsupported password type: "+h}this.pass=CryptoJS.enc.Hex.parse(g)};if(d!==void 0){if(d.pass!==void 0){this.setPassword(d.pass)}if(d.alg!==void 0){this.algName=d.alg;if(d.prov===void 0){this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};KJUR.crypto.Signature=function(o){var q=null;this._setAlgNames=function(){var s=this.algName.match(/^(.+)with(.+)$/);if(s){this.mdAlgName=s[1].toLowerCase();this.pubkeyAlgName=s[2].toLowerCase();if("rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName){this.mdAlgName="sha1"}}};this._zeroPaddingOfSignature=function(x,w){for(var v="",t=w/4-x.length,u=0;u<t;u++){v=v+"0"}return v+x};this.setAlgAndProvider=function(u,t){this._setAlgNames();if("cryptojs/jsrsa"!=t){throw new Error("provider not supported: "+t)}if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(s){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+s)}this.init=function(w,x){var y=null;try{if(x===void 0){y=KEYUTIL.getKey(w)}else{y=KEYUTIL.getKey(w,x)}}catch(v){throw"init failed:"+v}if(!0===y.isPrivate){this.prvKey=y;this.state="SIGN"}else{if(!0===y.isPublic){this.pubKey=y;this.state="VERIFY"}else{throw"init failed.:"+y}}};this.updateString=function(v){this.md.updateString(v)};this.updateHex=function(v){this.md.updateHex(v)};this.sign=function(){this.sHashHex=this.md.digest();if(this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&KJUR.crypto.ECDSA!==void 0){this.prvKey=new KJUR.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})}if(this.prvKey instanceof RSAKey&&"rsaandmgf1"===this.pubkeyAlgName){this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen)}else{if(this.prvKey instanceof RSAKey&&"rsa"===this.pubkeyAlgName){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName)}else{if(this.prvKey instanceof KJUR.crypto.ECDSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{if(this.prvKey instanceof KJUR.crypto.DSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{throw"Signature: unsupported private key alg: "+this.pubkeyAlgName}}}}return this.hSign};this.signString=function(v){this.updateString(v);return this.sign()};this.signHex=function(v){this.updateHex(v);return this.sign()};this.verify=function(v){this.sHashHex=this.md.digest();if(this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&KJUR.crypto.ECDSA!==void 0){this.pubKey=new KJUR.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})}if(this.pubKey instanceof RSAKey&&"rsaandmgf1"===this.pubkeyAlgName){return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,v,this.mdAlgName,this.pssSaltLen)}else{if(this.pubKey instanceof RSAKey&&"rsa"===this.pubkeyAlgName){return this.pubKey.verifyWithMessageHash(this.sHashHex,v)}else{if(KJUR.crypto.ECDSA!==void 0&&this.pubKey instanceof KJUR.crypto.ECDSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,v)}else{if(KJUR.crypto.DSA!==void 0&&this.pubKey instanceof KJUR.crypto.DSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,v)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}}};this.init=function(){throw"init(key, pass) not supported for this alg:prov="+this.algProvName};this.updateString=function(){throw"updateString(str) not supported for this alg:prov="+this.algProvName};this.updateHex=function(){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName};this.signString=function(){throw"digestString(str) not supported for this alg:prov="+this.algProvName};this.signHex=function(){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName};this.verify=function(){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName};this.initParams=o;if(o!==void 0){if(o.alg!==void 0){this.algName=o.alg;if(o.prov===void 0){this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}else{this.provName=o.prov}this.algProvName=this.algName+":"+this.provName;this.setAlgAndProvider(this.algName,this.provName);this._setAlgNames()}if(o.psssaltlen!==void 0){this.pssSaltLen=o.psssaltlen}if(o.prvkeypem!==void 0){if(o.prvkeypas!==void 0){throw"both prvkeypem and prvkeypas parameters not supported"}else{try{var q=KEYUTIL.getKey(o.prvkeypem);this.init(q)}catch(m){throw"fatal error to load pem private key: "+m}}}}};KJUR.crypto.Cipher=function(){};KJUR.crypto.Cipher.encrypt=function(e,f,d){if(f instanceof RSAKey&&f.isPublic){var c=KJUR.crypto.Cipher.getAlgByKeyAndName(f,d);if("RSA"===c){return f.encrypt(e)}if("RSAOAEP"===c){return f.encryptOAEP(e,"sha1")}var b=c.match(/^RSAOAEP(\d+)$/);if(null!==b){return f.encryptOAEP(e,"sha"+b[1])}throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+d}else{throw"Cipher.encrypt: unsupported key or algorithm"}};KJUR.crypto.Cipher.decrypt=function(e,f,d){if(f instanceof RSAKey&&f.isPrivate){var c=KJUR.crypto.Cipher.getAlgByKeyAndName(f,d);if("RSA"===c){return f.decrypt(e)}if("RSAOAEP"===c){return f.decryptOAEP(e,"sha1")}var b=c.match(/^RSAOAEP(\d+)$/);if(null!==b){return f.decryptOAEP(e,"sha"+b[1])}throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+d}else{throw"Cipher.decrypt: unsupported key or algorithm"}};KJUR.crypto.Cipher.getAlgByKeyAndName=function(b,a){if(b instanceof RSAKey){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(a)){return a}if(null===a||a===void 0){return"RSA"}throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+a}throw"getAlgByKeyAndName: not supported algorithm name: "+a};KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.crypto||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.ECDSA=function(e){var j=Error,f=BigInteger,h=ECPointFp,m=KJUR.crypto.ECDSA,c=KJUR.crypto.ECParameterDB,d=m.getName,q=ASN1HEX,n=q.getVbyListEx,k=q.isASN1HEX,a=new SecureRandom;this.type="EC";this.isPrivate=!1;this.isPublic=!1;this.getBigRandom=function(r){return new f(r.bitLength(),a).mod(r.subtract(f.ONE)).add(f.ONE)};this.setNamedCurve=function(r){this.ecparams=c.getByName(r);this.prvKeyHex=null;this.pubKeyHex=null;this.curveName=r};this.setPrivateKeyHex=function(r){this.isPrivate=!0;this.prvKeyHex=r};this.setPublicKeyHex=function(r){this.isPublic=!0;this.pubKeyHex=r};this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2)){throw"this method supports uncompressed format(04) only"}var s=this.ecparams.keylen/4;if(t.length!==2+2*s){throw"malformed public key hex length"}var r={x:t.substr(2,s),y:t.substr(2+s)};return r};this.getShortNISTPCurveName=function(){var r=this.curveName;if("secp256r1"===r||"NIST P-256"===r||"P-256"===r||"prime256v1"===r){return"P-256"}if("secp384r1"===r||"NIST P-384"===r||"P-384"===r){return"P-384"}return null};this.generateKeyPairHex=function(){var t=this.ecparams.n,w=this.getBigRandom(t),u=this.ecparams.G.multiply(w),z=u.getX().toBigInteger(),x=u.getY().toBigInteger(),r=this.ecparams.keylen/4,v=("0000000000"+w.toString(16)).slice(-r),A=("0000000000"+z.toString(16)).slice(-r),y=("0000000000"+x.toString(16)).slice(-r),s="04"+A+y;this.setPrivateKeyHex(v);this.setPublicKeyHex(s);return{ecprvhex:v,ecpubhex:s}};this.signWithMessageHash=function(r){return this.signHex(r,this.prvKeyHex)};this.signHex=function(x,u){var A=new f(u,16),v=this.ecparams.n,z=new f(x.substring(0,this.ecparams.keylen/4),16);do{var w=this.getBigRandom(v),B=this.ecparams.G,y=B.multiply(w),t=y.getX().toBigInteger().mod(v)}while(0>=t.compareTo(f.ZERO));var C=w.modInverse(v).multiply(z.add(A.multiply(t))).mod(v);return m.biRSSigToASN1Sig(t,C)};this.sign=function(w,B){var u=this.ecparams.n,y=f.fromByteArrayUnsigned(w);do{var v=this.getBigRandom(u),A=this.ecparams.G,x=A.multiply(v),t=x.getX().toBigInteger().mod(u)}while(0>=t.compareTo(BigInteger.ZERO));var C=v.modInverse(u).multiply(y.add(B.multiply(t))).mod(u);return this.serializeSig(t,C)};this.verifyWithMessageHash=function(s,r){return this.verifyHex(s,r,this.pubKeyHex)};this.verifyHex=function(v,y,u){try{var t,B,w=m.parseSigHex(y);t=w.r;B=w.s;var x=h.decodeFromHex(this.ecparams.curve,u),z=new f(v.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(z,t,B,x)}catch(A){return!1}};this.verify=function(z,A,u){var w,t;if(Bitcoin.Util.isArray(A)){var y=this.parseSig(A);w=y.r;t=y.s}else{if("object"===typeof A&&A.r&&A.s){w=A.r;t=A.s}else{throw"Invalid value for signature"}}var v;if(u instanceof ECPointFp){v=u}else{if(Bitcoin.Util.isArray(u)){v=h.decodeFrom(this.ecparams.curve,u)}else{throw"Invalid format for pubkey value, must be byte array or ECPointFp"}}var x=f.fromByteArrayUnsigned(z);return this.verifyRaw(x,w,t,v)};this.verifyRaw=function(z,t,E,y){var x=this.ecparams.n,D=this.ecparams.G;if(0>t.compareTo(f.ONE)||0<=t.compareTo(x)){return!1}if(0>E.compareTo(f.ONE)||0<=E.compareTo(x)){return!1}var A=E.modInverse(x),w=z.multiply(A).mod(x),u=t.multiply(A).mod(x),B=D.multiply(w).add(y.multiply(u)),C=B.getX().toBigInteger().mod(x);return C.equals(t)};this.serializeSig=function(v,u){var w=v.toByteArraySigned(),t=u.toByteArraySigned(),x=[];x.push(2);x.push(w.length);x=x.concat(w);x.push(2);x.push(t.length);x=x.concat(t);x.unshift(x.length);x.unshift(48);return x};this.parseSig=function(y){var x;if(48!=y[0]){throw new Error("Signature not a valid DERSequence")}x=2;if(2!=y[x]){throw new Error("First element in signature must be a DERInteger")}var w=y.slice(x+2,x+2+y[x+1]);x+=2+y[x+1];if(2!=y[x]){throw new Error("Second element in signature must be a DERInteger")}var t=y.slice(x+2,x+2+y[x+1]);x+=2+y[x+1];var v=f.fromByteArrayUnsigned(w),u=f.fromByteArrayUnsigned(t);return{r:v,s:u}};this.parseSigCompact=function(w){if(65!==w.length){throw"Signature has the wrong length"}var t=w[0]-27;if(0>t||7<t){throw"Invalid signature type"}var x=this.ecparams.n,v=f.fromByteArrayUnsigned(w.slice(1,33)).mod(x),u=f.fromByteArrayUnsigned(w.slice(33,65)).mod(x);return{r:v,s:u,i:t}};this.readPKCS5PrvKeyHex=function(u){if(!1===k(u)){throw new Error("not ASN.1 hex string")}var r,t,v;try{r=n(u,0,["[0]",0],"06");t=n(u,0,[1],"04");try{v=n(u,0,["[1]",0],"03")}catch(s){}}catch(s){throw new Error("malformed PKCS#1/5 plain ECC private key")}this.curveName=d(r);if(this.curveName===void 0){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(v);this.setPrivateKeyHex(t);this.isPublic=!1};this.readPKCS8PrvKeyHex=function(v){if(!1===k(v)){throw new j("not ASN.1 hex string")}var r,u,w;try{n(v,0,[1,0],"06");r=n(v,0,[1,1],"06");u=n(v,0,[2,0,1],"04");try{w=n(v,0,[2,0,"[1]",0],"03")}catch(s){}}catch(s){throw new j("malformed PKCS#8 plain ECC private key")}this.curveName=d(r);if(this.curveName===void 0){throw new j("unsupported curve name")}this.setNamedCurve(this.curveName);this.setPublicKeyHex(w);this.setPrivateKeyHex(u);this.isPublic=!1};this.readPKCS8PubKeyHex=function(u){if(!1===k(u)){throw new j("not ASN.1 hex string")}var r,v;try{n(u,0,[0,0],"06");r=n(u,0,[0,1],"06");v=n(u,0,[1],"03")}catch(s){throw new j("malformed PKCS#8 ECC public key")}this.curveName=d(r);if(null===this.curveName){throw new j("unsupported curve name")}this.setNamedCurve(this.curveName);this.setPublicKeyHex(v)};this.readCertPubKeyHex=function(t){if(!1===k(t)){throw new j("not ASN.1 hex string")}var r,u;try{r=n(t,0,[0,5,0,1],"06");u=n(t,0,[0,5,1],"03")}catch(s){throw new j("malformed X.509 certificate ECC public key")}this.curveName=d(r);if(null===this.curveName){throw new j("unsupported curve name")}this.setNamedCurve(this.curveName);this.setPublicKeyHex(u)};if(e!==void 0){if(e.curve!==void 0){this.curveName=e.curve}}if(this.curveName===void 0){this.curveName="secp256r1"}this.setNamedCurve(this.curveName);if(e!==void 0){if(e.prv!==void 0){this.setPrivateKeyHex(e.prv)}if(e.pub!==void 0){this.setPublicKeyHex(e.pub)}}};KJUR.crypto.ECDSA.parseSigHex=function(a){var b=KJUR.crypto.ECDSA.parseSigHexInHexRS(a),d=new BigInteger(b.r,16),c=new BigInteger(b.s,16);return{r:d,s:c}};KJUR.crypto.ECDSA.parseSigHexInHexRS=function(f){var j=ASN1HEX,i=j.getChildIdx,g=j.getV;j.checkStrictDER(f,0);if("30"!=f.substr(0,2)){throw new Error("signature is not a ASN.1 sequence")}var h=i(f,0);if(2!=h.length){throw new Error("signature shall have two elements")}var e=h[0],d=h[1];if("02"!=f.substr(e,2)){throw new Error("1st item not ASN.1 integer")}if("02"!=f.substr(d,2)){throw new Error("2nd item not ASN.1 integer")}var c=g(f,e),b=g(f,d);return{r:c,s:b}};KJUR.crypto.ECDSA.asn1SigToConcatSig=function(c){var d=KJUR.crypto.ECDSA.parseSigHexInHexRS(c),b=d.r,a=d.s;if("00"==b.substr(0,2)&&2==b.length%32){b=b.substr(2)}if("00"==a.substr(0,2)&&2==a.length%32){a=a.substr(2)}if(30==b.length%32){b="00"+b}if(30==a.length%32){a="00"+a}if(0!=b.length%32){throw"unknown ECDSA sig r length error"}if(0!=a.length%32){throw"unknown ECDSA sig s length error"}return b+a};KJUR.crypto.ECDSA.concatSigToASN1Sig=function(a){if(0!=8*(a.length/2)%(8*16)){throw"unknown ECDSA concatinated r-s sig  length error"}var c=a.substr(0,a.length/2),b=a.substr(a.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(c,b)};KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(b,a){var d=new BigInteger(b,16),c=new BigInteger(a,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(d,c)};KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(f,d){var c=KJUR.asn1,b=new c.DERInteger({bigint:f}),a=new c.DERInteger({bigint:d}),e=new c.DERSequence({array:[b,a]});return e.getEncodedHex()};KJUR.crypto.ECDSA.getName=function(a){if("2b8104001f"===a){return"secp192k1"}if("2a8648ce3d030107"===a){return"secp256r1"}if("2b8104000a"===a){return"secp256k1"}if("2b81040021"===a){return"secp224r1"}if("2b81040022"===a){return"secp384r1"}if(-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(a)){return"secp256r1"}if(-1!=="|secp256k1|".indexOf(a)){return"secp256k1"}if(-1!=="|secp224r1|NIST P-224|P-224|".indexOf(a)){return"secp224r1"}if(-1!=="|secp384r1|NIST P-384|P-384|".indexOf(a)){return"secp384r1"}return null};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.crypto||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.ECParameterDB=new function(){var b={},c={};function a(d){return new BigInteger(d,16)}this.getByName=function(e){var d=e;if("undefined"!=typeof c[d]){d=c[e]}if("undefined"!=typeof b[d]){return b[d]}throw"unregistered EC curve name: "+d};this.regist=function(A,l,o,g,m,e,j,f,k,u,d,x){b[A]={};var s=a(o),z=a(g),y=a(m),t=a(e),w=a(j),r=new ECCurveFp(s,z,y),q=r.decodePointHex("04"+f+k);b[A].name=A;b[A].keylen=l;b[A].curve=r;b[A].G=q;b[A].n=t;b[A].h=w;b[A].oid=d;b[A].info=x;for(var v=0;v<u.length;v++){c[u[v]]=A}}};KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.crypto||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.DSA=function(){var b=ASN1HEX,e=b.getVbyList,d=b.getVbyListEx,a=b.isASN1HEX,c=BigInteger;this.p=null;this.q=null;this.g=null;this.y=null;this.x=null;this.type="DSA";this.isPrivate=!1;this.isPublic=!1;this.setPrivate=function(j,i,h,k,f){this.isPrivate=!0;this.p=j;this.q=i;this.g=h;this.y=k;this.x=f};this.setPrivateHex=function(i,g,k,n,o){var h,f,j,l,m;h=new BigInteger(i,16);f=new BigInteger(g,16);j=new BigInteger(k,16);if("string"===typeof n&&1<n.length){l=new BigInteger(n,16)}else{l=null}m=new BigInteger(o,16);this.setPrivate(h,f,j,l,m)};this.setPublic=function(i,h,f,j){this.isPublic=!0;this.p=i;this.q=h;this.g=f;this.y=j;this.x=null};this.setPublicHex=function(k,j,i,l){var g,f,m,h;g=new BigInteger(k,16);f=new BigInteger(j,16);m=new BigInteger(i,16);h=new BigInteger(l,16);this.setPublic(g,f,m,h)};this.signWithMessageHash=function(j){var i=this.p,h=this.q,m=this.g,o=this.y,t=this.x,l=KJUR.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),h.subtract(BigInteger.ONE)),u=j.substr(0,h.bitLength()/4),n=new BigInteger(u,16),f=m.modPow(l,i).mod(h),w=l.modInverse(h).multiply(n.add(t.multiply(f))).mod(h),v=KJUR.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:f}},{int:{bigint:w}}]});return v};this.verifyWithMessageHash=function(m,l){var j=this.p,h=this.q,o=this.g,u=this.y,n=this.parseASN1Signature(l),f=n[0],C=n[1],B=m.substr(0,h.bitLength()/4),t=new BigInteger(B,16);if(0<BigInteger.ZERO.compareTo(f)||0<f.compareTo(h)){throw"invalid DSA signature"}if(0<=BigInteger.ZERO.compareTo(C)||0<C.compareTo(h)){throw"invalid DSA signature"}var x=C.modInverse(h),k=t.multiply(x).mod(h),i=f.multiply(x).mod(h),A=o.modPow(k,j).multiply(u.modPow(i,j)).mod(j).mod(h);return 0==A.compareTo(f)};this.parseASN1Signature=function(f){try{var i=new c(d(f,0,[0],"02"),16),h=new c(d(f,0,[1],"02"),16);return[i,h]}catch(g){throw new Error("malformed ASN.1 DSA signature")}};this.readPKCS5PrvKeyHex=function(j){var k,i,g,l,m;if(!1===a(j)){throw new Error("not ASN.1 hex string")}try{k=d(j,0,[1],"02");i=d(j,0,[2],"02");g=d(j,0,[3],"02");l=d(j,0,[4],"02");m=d(j,0,[5],"02")}catch(f){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(k,i,g,l,m)};this.readPKCS8PrvKeyHex=function(j){var k,i,g,l;if(!1===a(j)){throw new Error("not ASN.1 hex string")}try{k=d(j,0,[1,1,0],"02");i=d(j,0,[1,1,1],"02");g=d(j,0,[1,1,2],"02");l=d(j,0,[2,0],"02")}catch(f){throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(k,i,g,null,l)};this.readPKCS8PubKeyHex=function(j){var k,i,g,l;if(!1===a(j)){throw new Error("not ASN.1 hex string")}try{k=d(j,0,[0,1,0],"02");i=d(j,0,[0,1,1],"02");g=d(j,0,[0,1,2],"02");l=d(j,0,[1,0],"02")}catch(f){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(k,i,g,l)};this.readCertPubKeyHex=function(j){var k,i,g,l;if(!1===a(j)){throw new Error("not ASN.1 hex string")}try{k=d(j,0,[0,5,0,1,0],"02");i=d(j,0,[0,5,0,1,1],"02");g=d(j,0,[0,5,0,1,2],"02");l=d(j,0,[0,5,1,0],"02")}catch(f){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(k,i,g,l)}};var KEYUTIL=function(){var d=function(p,r,q){return k(CryptoJS.AES,p,r,q)},k=function(s,x,u,q){var r=CryptoJS.enc.Hex.parse(x),w=CryptoJS.enc.Hex.parse(u),p=CryptoJS.enc.Hex.parse(q),t={};t.key=w;t.iv=p;t.ciphertext=r;var v=s.decrypt(t,w,{iv:p});return CryptoJS.enc.Hex.stringify(v)},l=function(p,r,q){return g(CryptoJS.AES,p,r,q)},g=function(t,y,v,q){var s=CryptoJS.enc.Hex.parse(y),x=CryptoJS.enc.Hex.parse(v),p=CryptoJS.enc.Hex.parse(q),w=t.encrypt(s,x,{iv:p}),r=CryptoJS.enc.Hex.parse(w.toString()),u=CryptoJS.enc.Base64.stringify(r);return u},i={"AES-256-CBC":{proc:d,eproc:l,keylen:32,ivlen:16},"AES-192-CBC":{proc:d,eproc:l,keylen:24,ivlen:16},"AES-128-CBC":{proc:d,eproc:l,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(p,r,q){return k(CryptoJS.TripleDES,p,r,q)},eproc:function(p,r,q){return g(CryptoJS.TripleDES,p,r,q)},keylen:24,ivlen:8},"DES-CBC":{proc:function(p,r,q){return k(CryptoJS.DES,p,r,q)},eproc:function(p,r,q){return g(CryptoJS.DES,p,r,q)},keylen:8,ivlen:8}},m=function(p){var r=CryptoJS.lib.WordArray.random(p),q=CryptoJS.enc.Hex.stringify(r);return q},n=function(v){var w={},q=v.match(/DEK-Info: ([^,]+),([0-9A-Fa-f]+)/m);if(q){w.cipher=q[1];w.ivsalt=q[2]}var p=v.match(/-----BEGIN ([A-Z]+) PRIVATE KEY-----/);if(p){w.type=p[1]}var u=-1,x=0;if(-1!=v.indexOf("\r\n\r\n")){u=v.indexOf("\r\n\r\n");x=2}if(-1!=v.indexOf("\n\n")){u=v.indexOf("\n\n");x=1}var t=v.indexOf("-----END");if(-1!=u&&-1!=t){var r=v.substring(u+2*x,t-x);r=r.replace(/\s+/g,"");w.data=r}return w},j=function(q,y,p){var v=p.substring(0,16),t=CryptoJS.enc.Hex.parse(v),r=CryptoJS.enc.Utf8.parse(y),u=i[q].keylen+i[q].ivlen,x="",w=null;for(;;){var s=CryptoJS.algo.MD5.create();if(null!=w){s.update(w)}s.update(r);s.update(t);w=s.finalize();x=x+CryptoJS.enc.Hex.stringify(w);if(x.length>=2*u){break}}var z={keyhex:x.substr(0,2*i[q].keylen),ivhex:x.substr(2*i[q].keylen,2*i[q].ivlen)};return z},b=function(p,v,r,w){var s=CryptoJS.enc.Base64.parse(p),q=CryptoJS.enc.Hex.stringify(s),u=i[v].proc,t=u(q,r,w);return t},h=function(p,s,q,u){var r=i[s].eproc,t=r(p,q,u);return t};return{version:"1.0.0",parsePKCS5PEM:function(p){return n(p)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(q,p,r){return j(q,p,r)},decryptKeyB64:function(p,r,q,s){return b(p,r,q,s)},getDecryptedKeyHex:function(y,x){var q=n(y),t=q.type,r=q.cipher,p=q.ivsalt,s=q.data,w=j(r,x,p),v=w.keyhex,u=b(s,r,v,p);return u},getEncryptedPKCS5PEMFromPrvKeyHex:function(x,s,A,t,r){var p="";if("undefined"==typeof t||null==t){t="AES-256-CBC"}if("undefined"==typeof i[t]){throw new Error("KEYUTIL unsupported algorithm: "+t)}if("undefined"==typeof r||null==r){var v=i[t].ivlen,u=m(v);r=u.toUpperCase()}var z=j(t,A,r),y=z.keyhex,w=h(s,t,y,r),q=w.replace(/(.{64})/g,"$1\r\n"),p="-----BEGIN "+x+" PRIVATE KEY-----\r\n";p+="Proc-Type: 4,ENCRYPTED\r\n";p+="DEK-Info: "+t+","+r+"\r\n";p+="\r\n";p+=q;p+="\r\n-----END "+x+" PRIVATE KEY-----\r\n";return p},parseHexOfEncryptedPKCS8:function(y){var B=ASN1HEX,z=B.getChildIdx,w=B.getV,t={},r=z(y,0);if(2!=r.length){throw new Error("malformed format: SEQUENCE(0).items != 2: "+r.length)}t.ciphertext=w(y,r[1]);var A=z(y,r[0]);if(2!=A.length){throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+A.length)}if("2a864886f70d01050d"!=w(y,A[0])){throw new Error("this only supports pkcs5PBES2")}var p=z(y,A[1]);if(2!=A.length){throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+p.length)}var q=z(y,p[1]);if(2!=q.length){throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+q.length)}if("2a864886f70d0307"!=w(y,q[0])){throw"this only supports TripleDES"}t.encryptionSchemeAlg="TripleDES";t.encryptionSchemeIV=w(y,q[1]);var s=z(y,p[0]);if(2!=s.length){throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+s.length)}if("2a864886f70d01050c"!=w(y,s[0])){throw new Error("this only supports pkcs5PBKDF2")}var x=z(y,s[1]);if(2>x.length){throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+x.length)}t.pbkdf2Salt=w(y,x[0]);var u=w(y,x[1]);try{t.pbkdf2Iter=parseInt(u,16)}catch(v){throw new Error("malformed format pbkdf2Iter: "+u)}return t},getPBKDF2KeyHexFromParam:function(u,p){var t=CryptoJS.enc.Hex.parse(u.pbkdf2Salt),q=u.pbkdf2Iter,s=CryptoJS.PBKDF2(p,t,{keySize:192/32,iterations:q}),r=CryptoJS.enc.Hex.stringify(s);return r},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(x,y){var r=pemtohex(x,"ENCRYPTED PRIVATE KEY"),p=this.parseHexOfEncryptedPKCS8(r),u=KEYUTIL.getPBKDF2KeyHexFromParam(p,y),v={};v.ciphertext=CryptoJS.enc.Hex.parse(p.ciphertext);var t=CryptoJS.enc.Hex.parse(u),s=CryptoJS.enc.Hex.parse(p.encryptionSchemeIV),w=CryptoJS.TripleDES.decrypt(v,t,{iv:s}),q=CryptoJS.enc.Hex.stringify(w);return q},getKeyFromEncryptedPKCS8PEM:function(s,q){var p=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(s,q),r=this.getKeyFromPlainPrivatePKCS8Hex(p);return r},parsePlainPrivatePKCS8Hex:function(s){var v=ASN1HEX,u=v.getChildIdx,t=v.getV,q={};q.algparam=null;if("30"!=s.substr(0,2)){throw new Error("malformed plain PKCS8 private key(code:001)")}var r=u(s,0);if(3>r.length){throw new Error("malformed plain PKCS8 private key(code:002)")}if("30"!=s.substr(r[1],2)){throw new Error("malformed PKCS8 private key(code:003)")}var p=u(s,r[1]);if(2!=p.length){throw new Error("malformed PKCS8 private key(code:004)")}if("06"!=s.substr(p[0],2)){throw new Error("malformed PKCS8 private key(code:005)")}q.algoid=t(s,p[0]);if("06"==s.substr(p[1],2)){q.algparam=t(s,p[1])}if("04"!=s.substr(r[2],2)){throw new Error("malformed PKCS8 private key(code:006)")}q.keyidx=v.getVidx(s,r[2]);return q},getKeyFromPlainPrivatePKCS8PEM:function(q){var p=pemtohex(q,"PRIVATE KEY"),r=this.getKeyFromPlainPrivatePKCS8Hex(p);return r},getKeyFromPlainPrivatePKCS8Hex:function(p){var q=this.parsePlainPrivatePKCS8Hex(p),r;if("2a864886f70d010101"==q.algoid){r=new RSAKey}else{if("2a8648ce380401"==q.algoid){r=new KJUR.crypto.DSA}else{if("2a8648ce3d0201"==q.algoid){r=new KJUR.crypto.ECDSA}else{throw new Error("unsupported private key algorithm")}}}r.readPKCS8PrvKeyHex(p);return r},_getKeyFromPublicPKCS8Hex:function(q){var p,r=ASN1HEX.getVbyList(q,0,[0,0],"06");if("2a864886f70d010101"===r){p=new RSAKey}else{if("2a8648ce380401"===r){p=new KJUR.crypto.DSA}else{if("2a8648ce3d0201"===r){p=new KJUR.crypto.ECDSA}else{throw new Error("unsupported PKCS#8 public key hex")}}}p.readPKCS8PubKeyHex(q);return p},parsePublicRawRSAKeyHex:function(r){var u=ASN1HEX,t=u.getChildIdx,s=u.getV,p={};if("30"!=r.substr(0,2)){throw new Error("malformed RSA key(code:001)")}var q=t(r,0);if(2!=q.length){throw new Error("malformed RSA key(code:002)")}if("02"!=r.substr(q[0],2)){throw new Error("malformed RSA key(code:003)")}p.n=s(r,q[0]);if("02"!=r.substr(q[1],2)){throw new Error("malformed RSA key(code:004)")}p.e=s(r,q[1]);return p},parsePublicPKCS8Hex:function(t){var v=ASN1HEX,u=v.getChildIdx,s=v.getV,q={};q.algparam=null;var r=u(t,0);if(2!=r.length){throw new Error("outer DERSequence shall have 2 elements: "+r.length)}var w=r[0];if("30"!=t.substr(w,2)){throw new Error("malformed PKCS8 public key(code:001)")}var p=u(t,w);if(2!=p.length){throw new Error("malformed PKCS8 public key(code:002)")}if("06"!=t.substr(p[0],2)){throw new Error("malformed PKCS8 public key(code:003)")}q.algoid=s(t,p[0]);if("06"==t.substr(p[1],2)){q.algparam=s(t,p[1])}else{if("30"==t.substr(p[1],2)){q.algparam={};q.algparam.p=v.getVbyList(t,p[1],[0],"02");q.algparam.q=v.getVbyList(t,p[1],[1],"02");q.algparam.g=v.getVbyList(t,p[1],[2],"02")}}if("03"!=t.substr(r[1],2)){throw new Error("malformed PKCS8 public key(code:004)")}q.key=s(t,r[1]).substr(2);return q}}}();KEYUTIL.getKey=function(l,k,n){var G=ASN1HEX,L=G.getChildIdx,v=G.getV,d=G.getVbyList,c=KJUR.crypto,i=c.ECDSA,C=c.DSA,w=RSAKey,M=pemtohex,F=KEYUTIL;if("undefined"!=typeof w&&l instanceof w){return l}if("undefined"!=typeof i&&l instanceof i){return l}if("undefined"!=typeof C&&l instanceof C){return l}if(l.curve!==void 0&&l.xy!==void 0&&l.d===void 0){return new i({pub:l.xy,curve:l.curve})}if(l.curve!==void 0&&l.d!==void 0){return new i({prv:l.d,curve:l.curve})}if(l.kty===void 0&&l.n!==void 0&&l.e!==void 0&&l.d===void 0){var P=new w;P.setPublic(l.n,l.e);return P}if(l.kty===void 0&&l.n!==void 0&&l.e!==void 0&&l.d!==void 0&&l.p!==void 0&&l.q!==void 0&&l.dp!==void 0&&l.dq!==void 0&&l.co!==void 0&&l.qi===void 0){var P=new w;P.setPrivateEx(l.n,l.e,l.d,l.p,l.q,l.dp,l.dq,l.co);return P}if(l.kty===void 0&&l.n!==void 0&&l.e!==void 0&&l.d!==void 0&&l.p===void 0){var P=new w;P.setPrivate(l.n,l.e,l.d);return P}if(l.p!==void 0&&l.q!==void 0&&l.g!==void 0&&l.y!==void 0&&l.x===void 0){var P=new C;P.setPublic(l.p,l.q,l.g,l.y);return P}if(l.p!==void 0&&l.q!==void 0&&l.g!==void 0&&l.y!==void 0&&l.x!==void 0){var P=new C;P.setPrivate(l.p,l.q,l.g,l.y,l.x);return P}if("RSA"===l.kty&&l.n!==void 0&&l.e!==void 0&&l.d===void 0){var P=new w;P.setPublic(b64utohex(l.n),b64utohex(l.e));return P}if("RSA"===l.kty&&l.n!==void 0&&l.e!==void 0&&l.d!==void 0&&l.p!==void 0&&l.q!==void 0&&l.dp!==void 0&&l.dq!==void 0&&l.qi!==void 0){var P=new w;P.setPrivateEx(b64utohex(l.n),b64utohex(l.e),b64utohex(l.d),b64utohex(l.p),b64utohex(l.q),b64utohex(l.dp),b64utohex(l.dq),b64utohex(l.qi));return P}if("RSA"===l.kty&&l.n!==void 0&&l.e!==void 0&&l.d!==void 0){var P=new w;P.setPrivate(b64utohex(l.n),b64utohex(l.e),b64utohex(l.d));return P}if("EC"===l.kty&&l.crv!==void 0&&l.x!==void 0&&l.y!==void 0&&l.d===void 0){var j=new i({curve:l.crv}),t=j.ecparams.keylen/4,B=("0000000000"+b64utohex(l.x)).slice(-t),z=("0000000000"+b64utohex(l.y)).slice(-t),u="04"+B+z;j.setPublicKeyHex(u);return j}if("EC"===l.kty&&l.crv!==void 0&&l.x!==void 0&&l.y!==void 0&&l.d!==void 0){var j=new i({curve:l.crv}),t=j.ecparams.keylen/4,B=("0000000000"+b64utohex(l.x)).slice(-t),z=("0000000000"+b64utohex(l.y)).slice(-t),u="04"+B+z,b=("0000000000"+b64utohex(l.d)).slice(-t);j.setPublicKeyHex(u);j.setPrivateKeyHex(b);return j}if("pkcs5prv"===n){var J=l,G=ASN1HEX,N,P;N=L(J,0);if(9===N.length){P=new w;P.readPKCS5PrvKeyHex(J)}else{if(6===N.length){P=new C;P.readPKCS5PrvKeyHex(J)}else{if(2<N.length&&"04"===J.substr(N[1],2)){P=new i;P.readPKCS5PrvKeyHex(J)}else{throw new Error("unsupported PKCS#1/5 hexadecimal key")}}}return P}if("pkcs8prv"===n){var P=F.getKeyFromPlainPrivatePKCS8Hex(l);return P}if("pkcs8pub"===n){return F._getKeyFromPublicPKCS8Hex(l)}if("x509pub"===n){return X509.getPublicKeyFromCertHex(l)}if(-1!=l.indexOf("-END CERTIFICATE-",0)||-1!=l.indexOf("-END X509 CERTIFICATE-",0)||-1!=l.indexOf("-END TRUSTED CERTIFICATE-",0)){return X509.getPublicKeyFromCertPEM(l)}if(-1!=l.indexOf("-END PUBLIC KEY-")){var O=pemtohex(l,"PUBLIC KEY");return F._getKeyFromPublicPKCS8Hex(O)}if(-1!=l.indexOf("-END RSA PRIVATE KEY-")&&-1==l.indexOf("4,ENCRYPTED")){var m=M(l,"RSA PRIVATE KEY");return F.getKey(m,null,"pkcs5prv")}if(-1!=l.indexOf("-END DSA PRIVATE KEY-")&&-1==l.indexOf("4,ENCRYPTED")){var I=M(l,"DSA PRIVATE KEY"),E=d(I,0,[1],"02"),D=d(I,0,[2],"02"),K=d(I,0,[3],"02"),r=d(I,0,[4],"02"),s=d(I,0,[5],"02"),P=new C;P.setPrivate(new BigInteger(E,16),new BigInteger(D,16),new BigInteger(K,16),new BigInteger(r,16),new BigInteger(s,16));return P}if(-1!=l.indexOf("-END EC PRIVATE KEY-")&&-1==l.indexOf("4,ENCRYPTED")){var m=M(l,"EC PRIVATE KEY");return F.getKey(m,null,"pkcs5prv")}if(-1!=l.indexOf("-END PRIVATE KEY-")){return F.getKeyFromPlainPrivatePKCS8PEM(l)}if(-1!=l.indexOf("-END RSA PRIVATE KEY-")&&-1!=l.indexOf("4,ENCRYPTED")){var o=F.getDecryptedKeyHex(l,k),H=new RSAKey;H.readPKCS5PrvKeyHex(o);return H}if(-1!=l.indexOf("-END EC PRIVATE KEY-")&&-1!=l.indexOf("4,ENCRYPTED")){var I=F.getDecryptedKeyHex(l,k),P=d(I,0,[1],"04"),f=d(I,0,[2,0],"06"),A=d(I,0,[3,0],"03").substr(2),e="";if(KJUR.crypto.OID.oidhex2name[f]!==void 0){e=KJUR.crypto.OID.oidhex2name[f]}else{throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+f)}var j=new i({curve:e});j.setPublicKeyHex(A);j.setPrivateKeyHex(P);j.isPublic=!1;return j}if(-1!=l.indexOf("-END DSA PRIVATE KEY-")&&-1!=l.indexOf("4,ENCRYPTED")){var I=F.getDecryptedKeyHex(l,k),E=d(I,0,[1],"02"),D=d(I,0,[2],"02"),K=d(I,0,[3],"02"),r=d(I,0,[4],"02"),s=d(I,0,[5],"02"),P=new C;P.setPrivate(new BigInteger(E,16),new BigInteger(D,16),new BigInteger(K,16),new BigInteger(r,16),new BigInteger(s,16));return P}if(-1!=l.indexOf("-END ENCRYPTED PRIVATE KEY-")){return F.getKeyFromEncryptedPKCS8PEM(l,k)}throw new Error("not supported argument")};KEYUTIL.generateKeypair=function(a,c){if("RSA"==a){var h=new RSAKey;h.generate(c,"10001");h.isPrivate=!0;h.isPublic=!0;var f=new RSAKey,e=h.n.toString(16),i=h.e.toString(16);f.setPublic(e,i);f.isPrivate=!1;f.isPublic=!0;var k={prvKeyObj:h,pubKeyObj:f};return k}else{if("EC"==a){var d=c,g=new KJUR.crypto.ECDSA({curve:d}),j=g.generateKeyPairHex(),h=new KJUR.crypto.ECDSA({curve:d});h.setPublicKeyHex(j.ecpubhex);h.setPrivateKeyHex(j.ecprvhex);h.isPrivate=!0;h.isPublic=!1;var f=new KJUR.crypto.ECDSA({curve:d});f.setPublicKeyHex(j.ecpubhex);f.isPrivate=!1;f.isPublic=!0;var k={prvKeyObj:h,pubKeyObj:f};return k}else{throw new Error("unknown algorithm: "+a)}}};KEYUTIL.getPEM=function(b,D,y,m,q,j){var F=KJUR,k=F.asn1,z=k.DERObjectIdentifier,f=k.DERInteger,l=k.ASN1Util.newObject,a=k.x509,C=a.SubjectPublicKeyInfo,e=F.crypto,u=e.DSA,r=e.ECDSA,n=RSAKey;function A(s){var G=l({seq:[{int:0},{int:{bigint:s.n}},{int:s.e},{int:{bigint:s.d}},{int:{bigint:s.p}},{int:{bigint:s.q}},{int:{bigint:s.dmp1}},{int:{bigint:s.dmq1}},{int:{bigint:s.coeff}}]});return G}function B(G){var s=l({seq:[{int:1},{octstr:{hex:G.prvKeyHex}},{tag:["a0",!0,{oid:{name:G.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+G.pubKeyHex}}]}]});return s}function x(s){var G=l({seq:[{int:0},{int:{bigint:s.p}},{int:{bigint:s.q}},{int:{bigint:s.g}},{int:{bigint:s.y}},{int:{bigint:s.x}}]});return G}if((n!==void 0&&b instanceof n||u!==void 0&&b instanceof u||r!==void 0&&b instanceof r)&&!0==b.isPublic&&(D===void 0||"PKCS8PUB"==D)){var E=new C(b),w=E.getEncodedHex();return hextopem(w,"PUBLIC KEY")}if("PKCS1PRV"==D&&n!==void 0&&b instanceof n&&(y===void 0||null==y)&&!0==b.isPrivate){var E=A(b),w=E.getEncodedHex();return hextopem(w,"RSA PRIVATE KEY")}if("PKCS1PRV"==D&&r!==void 0&&b instanceof r&&(y===void 0||null==y)&&!0==b.isPrivate){var i=new z({name:b.curveName}),v=i.getEncodedHex(),h=B(b),t=h.getEncodedHex(),p="";p+=hextopem(v,"EC PARAMETERS");p+=hextopem(t,"EC PRIVATE KEY");return p}if("PKCS1PRV"==D&&u!==void 0&&b instanceof u&&(y===void 0||null==y)&&!0==b.isPrivate){var E=x(b),w=E.getEncodedHex();return hextopem(w,"DSA PRIVATE KEY")}if("PKCS5PRV"==D&&n!==void 0&&b instanceof n&&y!==void 0&&null!=y&&!0==b.isPrivate){var E=A(b),w=E.getEncodedHex();if(m===void 0){m="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",w,y,m,j)}if("PKCS5PRV"==D&&r!==void 0&&b instanceof r&&y!==void 0&&null!=y&&!0==b.isPrivate){var E=B(b),w=E.getEncodedHex();if(m===void 0){m="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",w,y,m,j)}if("PKCS5PRV"==D&&u!==void 0&&b instanceof u&&y!==void 0&&null!=y&&!0==b.isPrivate){var E=x(b),w=E.getEncodedHex();if(m===void 0){m="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",w,y,m,j)}var o=function(G,s){var I=c(G,s),H=new l({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:I.pbkdf2Salt}},{int:I.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:I.encryptionSchemeIV}}]}]}]},{octstr:{hex:I.ciphertext}}]});return H.getEncodedHex()},c=function(N,O){var H=100,M=CryptoJS.lib.WordArray.random(8),s=CryptoJS.lib.WordArray.random(8),I=CryptoJS.PBKDF2(O,M,{keySize:192/32,iterations:H}),J=CryptoJS.enc.Hex.parse(N),K=CryptoJS.TripleDES.encrypt(J,I,{iv:s})+"",G={};G.ciphertext=K;G.pbkdf2Salt=CryptoJS.enc.Hex.stringify(M);G.pbkdf2Iter=H;G.encryptionSchemeAlg="DES-EDE3-CBC";G.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(s);return G};if("PKCS8PRV"==D&&n!=void 0&&b instanceof n&&!0==b.isPrivate){var g=A(b),d=g.getEncodedHex(),E=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:d}}]}),w=E.getEncodedHex();if(y===void 0||null==y){return hextopem(w,"PRIVATE KEY")}else{var t=o(w,y);return hextopem(t,"ENCRYPTED PRIVATE KEY")}}if("PKCS8PRV"==D&&r!==void 0&&b instanceof r&&!0==b.isPrivate){var g=new l({seq:[{int:1},{octstr:{hex:b.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+b.pubKeyHex}}]}]}),d=g.getEncodedHex(),E=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:b.curveName}}]},{octstr:{hex:d}}]}),w=E.getEncodedHex();if(y===void 0||null==y){return hextopem(w,"PRIVATE KEY")}else{var t=o(w,y);return hextopem(t,"ENCRYPTED PRIVATE KEY")}}if("PKCS8PRV"==D&&u!==void 0&&b instanceof u&&!0==b.isPrivate){var g=new f({bigint:b.x}),d=g.getEncodedHex(),E=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:b.p}},{int:{bigint:b.q}},{int:{bigint:b.g}}]}]},{octstr:{hex:d}}]}),w=E.getEncodedHex();if(y===void 0||null==y){return hextopem(w,"PRIVATE KEY")}else{var t=o(w,y);return hextopem(t,"ENCRYPTED PRIVATE KEY")}}throw new Error("unsupported object nor format")};KEYUTIL.getKeyFromCSRPEM=function(b){var a=pemtohex(b,"CERTIFICATE REQUEST"),c=KEYUTIL.getKeyFromCSRHex(a);return c};KEYUTIL.getKeyFromCSRHex=function(a){var c=KEYUTIL.parseCSRHex(a),b=KEYUTIL.getKey(c.p8pubkeyhex,null,"pkcs8pub");return b};KEYUTIL.parseCSRHex=function(d){var i=ASN1HEX,f=i.getChildIdx,c=i.getTLV,b={},g=d;if("30"!=g.substr(0,2)){throw new Error("malformed CSR(code:001)")}var e=f(g,0);if(1>e.length){throw new Error("malformed CSR(code:002)")}if("30"!=g.substr(e[0],2)){throw new Error("malformed CSR(code:003)")}var a=f(g,e[0]);if(3>a.length){throw new Error("malformed CSR(code:004)")}b.p8pubkeyhex=c(g,a[2]);return b};KEYUTIL.getKeyID=function(f){var c=KEYUTIL,e=ASN1HEX;if("string"===typeof f&&-1!=f.indexOf("BEGIN ")){f=c.getKey(f)}var d=pemtohex(c.getPEM(f)),b=e.getIdxbyList(d,0,[1]),a=e.getV(d,b).substring(2);return KJUR.crypto.Util.hashHex(a,"sha1")};KEYUTIL.getJWKFromKey=function(d){var b={};if(d instanceof RSAKey&&d.isPrivate){b.kty="RSA";b.n=hextob64u(d.n.toString(16));b.e=hextob64u(d.e.toString(16));b.d=hextob64u(d.d.toString(16));b.p=hextob64u(d.p.toString(16));b.q=hextob64u(d.q.toString(16));b.dp=hextob64u(d.dmp1.toString(16));b.dq=hextob64u(d.dmq1.toString(16));b.qi=hextob64u(d.coeff.toString(16));return b}else{if(d instanceof RSAKey&&d.isPublic){b.kty="RSA";b.n=hextob64u(d.n.toString(16));b.e=hextob64u(d.e.toString(16));return b}else{if(d instanceof KJUR.crypto.ECDSA&&d.isPrivate){var a=d.getShortNISTPCurveName();if("P-256"!==a&&"P-384"!==a){throw new Error("unsupported curve name for JWT: "+a)}var c=d.getPublicKeyXYHex();b.kty="EC";b.crv=a;b.x=hextob64u(c.x);b.y=hextob64u(c.y);b.d=hextob64u(d.prvKeyHex);return b}else{if(d instanceof KJUR.crypto.ECDSA&&d.isPublic){var a=d.getShortNISTPCurveName();if("P-256"!==a&&"P-384"!==a){throw new Error("unsupported curve name for JWT: "+a)}var c=d.getPublicKeyXYHex();b.kty="EC";b.crv=a;b.x=hextob64u(c.x);b.y=hextob64u(c.y);return b}}}}throw new Error("not supported key object")};RSAKey.getPosArrayOfChildrenFromHex=function(a){return ASN1HEX.getChildIdx(a,0)};RSAKey.getHexValueArrayOfChildrenFromHex=function(f){var i=ASN1HEX.getV,k=RSAKey.getPosArrayOfChildrenFromHex(f),e=i(f,k[0]),j=i(f,k[1]),b=i(f,k[2]),c=i(f,k[3]),h=i(f,k[4]),g=i(f,k[5]),m=i(f,k[6]),l=i(f,k[7]),d=i(f,k[8]),k=[];k.push(e,j,b,c,h,g,m,l,d);return k};RSAKey.prototype.readPrivateKeyFromPEMString=function(d){var c=pemtohex(d),b=RSAKey.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])};RSAKey.prototype.readPKCS5PrvKeyHex=function(c){var b=RSAKey.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function(e){var c,i,k,b,a,f,d,j,m=ASN1HEX,l=m.getVbyListEx;if(!1===m.isASN1HEX(e)){throw new Error("not ASN.1 hex string")}try{c=l(e,0,[2,0,1],"02");i=l(e,0,[2,0,2],"02");k=l(e,0,[2,0,3],"02");b=l(e,0,[2,0,4],"02");a=l(e,0,[2,0,5],"02");f=l(e,0,[2,0,6],"02");d=l(e,0,[2,0,7],"02");j=l(e,0,[2,0,8],"02")}catch(g){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(c,i,k,b,a,f,d,j)};RSAKey.prototype.readPKCS5PubKeyHex=function(c){var e=ASN1HEX,b=e.getV;if(!1===e.isASN1HEX(c)){throw new Error("keyHex is not ASN.1 hex string")}var a=e.getChildIdx(c,0);if(2!==a.length||"02"!==c.substr(a[0],2)||"02"!==c.substr(a[1],2)){throw new Error("wrong hex for PKCS#5 public key")}var f=b(c,a[0]),d=b(c,a[1]);this.setPublic(f,d)};RSAKey.prototype.readPKCS8PubKeyHex=function(b){var c=ASN1HEX;if(!1===c.isASN1HEX(b)){throw new Error("not ASN.1 hex string")}if("06092a864886f70d010101"!==c.getTLVbyListEx(b,0,[0,0])){throw new Error("not PKCS8 RSA public key")}var a=c.getTLVbyListEx(b,0,[1,0]);this.readPKCS5PubKeyHex(a)};RSAKey.prototype.readCertPubKeyHex=function(b){var a,c;a=new X509;a.readCertHex(b);c=a.getPublicKeyHex();this.readPKCS8PubKeyHex(c)};var _RE_HEXDECONLY=/[^0-9a-f]/gi;function _rsasign_getHexPaddedDigestInfoForString(d,e,a){var b=function(f){return KJUR.crypto.Util.hashString(f,a)},c=b(d);return KJUR.crypto.Util.getPaddedDigestInfoHex(c,a,e)}function _zeroPaddingOfSignature(e,d){for(var c="",a=d/4-e.length,b=0;b<a;b++){c=c+"0"}return c+e}RSAKey.prototype.sign=function(d,a){var b=function(e){return KJUR.crypto.Util.hashString(e,a)},c=b(d);return this.signWithMessageHash(c,a)};RSAKey.prototype.signWithMessageHash=function(e,c){var f=KJUR.crypto.Util.getPaddedDigestInfoHex(e,c,this.n.bitLength()),b=parseBigInt(f,16),d=this.doPrivate(b),a=d.toString(16);return _zeroPaddingOfSignature(a,this.n.bitLength())};function pss_mgf1_str(c,a,e){var b="",d=0;while(b.length<a){b+=hextorstr(e(rstrtohex(c+String.fromCharCode.apply(String,[(4278190080&d)>>24,(16711680&d)>>16,(65280&d)>>8,255&d]))));d+=1}return b}RSAKey.prototype.signPSS=function(e,a,d){var c=function(f){return KJUR.crypto.Util.hashHex(f,a)},b=c(rstrtohex(e));if(d===void 0){d=-1}return this.signWithMessageHashPSS(b,a,d)};RSAKey.prototype.signWithMessageHashPSS=function(l,a,k){var _StringfromCharCode3=String.fromCharCode,b=hextorstr(l),g=b.length,m=this.n.bitLength()-1,c=Math.ceil(m/8),d,o=function(i){return KJUR.crypto.Util.hashHex(i,a)};if(-1===k||k===void 0){k=g}else{if(-2===k){k=c-g-2}else{if(-2>k){throw new Error("invalid salt length")}}}if(c<g+k+2){throw new Error("data too long")}var f="";if(0<k){f=Array(k);new SecureRandom().nextBytes(f);f=_StringfromCharCode3.apply(String,f)}var n=hextorstr(o(rstrtohex("\0\0\0\0\0\0\0\0"+b+f))),j=[];for(d=0;d<c-k-g-2;d+=1){j[d]=0}var e=_StringfromCharCode3.apply(String,j)+"\x01"+f,h=pss_mgf1_str(n,e.length,o),q=[];for(d=0;d<e.length;d+=1){q[d]=e.charCodeAt(d)^h.charCodeAt(d)}q[0]&=~(255&65280>>8*c-m);for(d=0;d<g;d++){q.push(n.charCodeAt(d))}q.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(q)).toString(16),this.n.bitLength())};function _rsasign_getDecryptSignatureBI(a,d,c){var b=new RSAKey;b.setPublic(d,c);var e=b.doPublic(a);return e}function _rsasign_getHexDigestInfoFromSig(a,c,b){var e=_rsasign_getDecryptSignatureBI(a,c,b),d=e.toString(16).replace(/^1f+00/,"");return d}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(f){for(var e in KJUR.crypto.Util.DIGESTINFOHEAD){var d=KJUR.crypto.Util.DIGESTINFOHEAD[e],b=d.length;if(f.substring(0,b)==d){var c=[e,f.substring(b)];return c}}return[]}RSAKey.prototype.verify=function(f,l){l=l.toLowerCase();if(null==l.match(/^[0-9a-f]+$/)){return!1}var b=parseBigInt(l,16),k=this.n.bitLength();if(b.bitLength()>k){return!1}var j=this.doPublic(b),i=j.toString(16);if(i.length+3!=k/4){return!1}var e=i.replace(/^1f+00/,""),g=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(0==g.length){return!1}var d=g[0],h=g[1],a=function(m){return KJUR.crypto.Util.hashString(m,d)},c=a(f);return h==c};RSAKey.prototype.verifyWithMessageHash=function(e,a){if(a.length!=Math.ceil(this.n.bitLength()/4)){return!1}var b=parseBigInt(a,16);if(b.bitLength()>this.n.bitLength()){return 0}var h=this.doPublic(b),g=h.toString(16).replace(/^1f+00/,""),c=_rsasign_getAlgNameAndHashFromHexDisgestInfo(g);if(0==c.length){return!1}var d=c[0],f=c[1];return f==e};RSAKey.prototype.verifyPSS=function(c,b,a,f){var e=function(g){return KJUR.crypto.Util.hashHex(g,a)},d=e(rstrtohex(c));if(f===void 0){f=-1}return this.verifyWithMessageHashPSS(d,b,a,f)};RSAKey.prototype.verifyWithMessageHashPSS=function(f,s,l,c){var _Mathceil=Math.ceil,_StringfromCharCode4=String.fromCharCode;if(s.length!=_Mathceil(this.n.bitLength()/4)){return!1}var k=new BigInteger(s,16),r=function(i){return KJUR.crypto.Util.hashHex(i,l)},j=hextorstr(f),h=j.length,g=this.n.bitLength()-1,m=_Mathceil(g/8),q;if(-1===c||c===void 0){c=h}else{if(-2===c){c=m-h-2}else{if(-2>c){throw new Error("invalid salt length")}}}if(m<h+c+2){throw new Error("data too long")}var a=this.doPublic(k).toByteArray();for(q=0;q<a.length;q+=1){a[q]&=255}while(a.length<m){a.unshift(0)}if(188!==a[m-1]){throw new Error("encoded message does not end in 0xbc")}a=_StringfromCharCode4.apply(String,a);var d=a.substr(0,m-h-1),e=a.substr(d.length,h),p=255&65280>>8*m-g;if(0!==(d.charCodeAt(0)&p)){throw new Error("bits beyond keysize not zero")}var n=pss_mgf1_str(e,d.length,r),o=[];for(q=0;q<d.length;q+=1){o[q]=d.charCodeAt(q)^n.charCodeAt(q)}o[0]&=~p;var b=m-h-c-2;for(q=0;q<b;q+=1){if(0!==o[q]){throw new Error("leftmost octets not zero")}}if(1!==o[b]){throw new Error("0x01 marker not found")}return e===hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+j+_StringfromCharCode4.apply(String,o.slice(-c)))))};RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.SALT_LEN_RECOVER=-2;function X509(q){var j=ASN1HEX,n=j.getChildIdx,g=j.getV,b=j.getTLV,c=j.getVbyList,k=j.getVbyListEx,a=j.getTLVbyList,l=j.getTLVbyListEx,h=j.getIdxbyList,e=j.getIdxbyListEx,i=j.getVidx,s=j.getInt,p=j.oidname,m=j.hextooidstr,f;try{f=KJUR.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(o){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"};this.hex=null;this.version=0;this.foffset=0;this.aExtInfo=null;this.getVersion=function(){if(null===this.hex||0!==this.version){return this.version}var u=a(this.hex,0,[0,0]);if("a0"==u.substr(0,2)){var v=a(u,0,[0]),t=s(v,0);if(0>t||2<t){throw new Error("malformed version field")}this.version=t+1;return this.version}else{this.version=1;this.foffset=-1;return 1}};this.getSerialNumberHex=function(){return k(this.hex,0,[0,0],"02")};this.getSignatureAlgorithmField=function(){var t=l(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(t)};this.getAlgorithmIdentifierName=function(t){for(var u in f){if(t===f[u]){return u}}return p(k(t,0,[0],"06"))};this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())};this.getIssuerHex=function(){return a(this.hex,0,[0,3+this.foffset],"30")};this.getIssuerString=function(){var t=this.getIssuer();return t.str};this.getSubject=function(){return this.getX500Name(this.getSubjectHex())};this.getSubjectHex=function(){return a(this.hex,0,[0,5+this.foffset],"30")};this.getSubjectString=function(){var t=this.getSubject();return t.str};this.getNotBefore=function(){var t=c(this.hex,0,[0,4+this.foffset,0]);t=t.replace(/(..)/g,"%$1");t=decodeURIComponent(t);return t};this.getNotAfter=function(){var t=c(this.hex,0,[0,4+this.foffset,1]);t=t.replace(/(..)/g,"%$1");t=decodeURIComponent(t);return t};this.getPublicKeyHex=function(){return j.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")};this.getPublicKeyIdx=function(){return h(this.hex,0,[0,6+this.foffset],"30")};this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return h(this.hex,t,[1,0],"30")};this.getPublicKey=function(){return KEYUTIL.getKey(this.getPublicKeyHex(),null,"pkcs8pub")};this.getSignatureAlgorithmName=function(){var t=a(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(t)};this.getSignatureValueHex=function(){return c(this.hex,0,[2],"03",!0)};this.verifySignature=function(v){var w=this.getSignatureAlgorithmField(),t=this.getSignatureValueHex(),u=a(this.hex,0,[0],"30"),x=new KJUR.crypto.Signature({alg:w});x.init(v);x.updateHex(u);return x.verify(t)};this.parseExt=function(C){var v,t,x;if(C===void 0){x=this.hex;if(3!==this.version){return-1}v=h(x,0,[0,7,0],"30");t=n(x,v)}else{x=pemtohex(C);var y=h(x,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=g(x,y)){this.aExtInfo=[];return}v=h(x,0,[0,3,0,1,0],"30");t=n(x,v);this.hex=x}this.aExtInfo=[];for(var w=0,A;w<t.length;w++){A={};A.critical=!1;var z=n(x,t[w]),u=0;if(3===z.length){A.critical=!0;u=1}A.oid=j.hextooidstr(c(x,t[w],[0],"06"));var B=h(x,t[w],[1+u]);A.vidx=i(x,B);this.aExtInfo.push(A)}};this.getExtInfo=function(v){var t=this.aExtInfo,w=v;if(!v.match(/^[0-9.]+$/)){w=KJUR.asn1.x509.OID.name2oid(v)}if(""===w){return}for(var u=0;u<t.length;u++){if(t[u].oid===w){return t[u]}}};this.getExtBasicConstraints=function(u,y){if(u===void 0&&y===void 0){var w=this.getExtInfo("basicConstraints");if(w===void 0){return}u=b(this.hex,w.vidx);y=w.critical}var t={extname:"basicConstraints"};if(y){t.critical=!0}if("3000"===u){return t}if("30030101ff"===u){t.cA=!0;return t}if("30060101ff02"===u.substr(0,12)){var x=g(u,10),v=parseInt(x,16);t.cA=!0;t.pathLen=v;return t}throw new Error("hExtV parse error: "+u)};this.getExtKeyUsage=function(u,w){if(u===void 0&&w===void 0){var v=this.getExtInfo("keyUsage");if(v===void 0){return}u=b(this.hex,v.vidx);w=v.critical}var t={extname:"keyUsage"};if(w){t.critical=!0}t.names=this.getExtKeyUsageString(u).split(",");return t};this.getExtKeyUsageBin=function(u){if(u===void 0){var v=this.getExtInfo("keyUsage");if(v===void 0){return""}u=b(this.hex,v.vidx)}if(8!=u.length&&10!=u.length){throw new Error("malformed key usage value: "+u)}var t="000000000000000"+parseInt(u.substr(6),16).toString(2);if(8==u.length){t=t.slice(-8)}if(10==u.length){t=t.slice(-16)}t=t.replace(/0+$/,"");if(""==t){t="0"}return t};this.getExtKeyUsageString=function(v){for(var w=this.getExtKeyUsageBin(v),t=[],u=0;u<w.length;u++){if("1"==w.substr(u,1)){t.push(X509.KEYUSAGE_NAME[u])}}return t.join(",")};this.getExtSubjectKeyIdentifier=function(v,x){if(v===void 0&&x===void 0){var w=this.getExtInfo("subjectKeyIdentifier");if(w===void 0){return}v=b(this.hex,w.vidx);x=w.critical}var t={extname:"subjectKeyIdentifier"};if(x){t.critical=!0}var u=g(v,0);t.kid={hex:u};return t};this.getExtAuthorityKeyIdentifier=function(z,x){if(z===void 0&&x===void 0){var t=this.getExtInfo("authorityKeyIdentifier");if(t===void 0){return}z=b(this.hex,t.vidx);x=t.critical}var A={extname:"authorityKeyIdentifier"};if(x){A.critical=!0}for(var y=n(z,0),u=0,B;u<y.length;u++){B=z.substr(y[u],2);if("80"===B){A.kid={hex:g(z,y[u])}}if("a1"===B){var w=b(z,y[u]),v=this.getGeneralNames(w);A.issuer=v[0].dn}if("82"===B){A.sn={hex:g(z,y[u])}}}return A};this.getExtExtKeyUsage=function(w,y){if(w===void 0&&y===void 0){var x=this.getExtInfo("extKeyUsage");if(x===void 0){return}w=b(this.hex,x.vidx);y=x.critical}var t={extname:"extKeyUsage",array:[]};if(y){t.critical=!0}for(var u=n(w,0),v=0;v<u.length;v++){t.array.push(p(g(w,u[v])))}return t};this.getExtExtKeyUsageName=function(){var x=this.getExtInfo("extKeyUsage");if(x===void 0){return x}var t=[],w=b(this.hex,x.vidx);if(""===w){return t}for(var u=n(w,0),v=0;v<u.length;v++){t.push(p(g(w,u[v])))}return t};this.getExtSubjectAltName=function(u,w){if(u===void 0&&w===void 0){var v=this.getExtInfo("subjectAltName");if(v===void 0){return}u=b(this.hex,v.vidx);w=v.critical}var t={extname:"subjectAltName",array:[]};if(w){t.critical=!0}t.array=this.getGeneralNames(u);return t};this.getExtIssuerAltName=function(u,w){if(u===void 0&&w===void 0){var v=this.getExtInfo("issuerAltName");if(v===void 0){return}u=b(this.hex,v.vidx);w=v.critical}var t={extname:"issuerAltName",array:[]};if(w){t.critical=!0}t.array=this.getGeneralNames(u);return t};this.getGeneralNames=function(x){for(var v=n(x,0),t=[],w=0,u;w<v.length;w++){u=this.getGeneralName(b(x,v[w]));if(u!==void 0){t.push(u)}}return t};this.getGeneralName=function(u){var t=u.substr(0,2),w=g(u,0),v=hextorstr(w);if("81"==t){return{rfc822:v}}if("82"==t){return{dns:v}}if("86"==t){return{uri:v}}if("87"==t){return{ip:hextoip(w)}}if("a4"==t){return{dn:this.getX500Name(w)}}};this.getExtSubjectAltName2=function(){var x,A,z,y=this.getExtInfo("subjectAltName");if(y===void 0){return y}for(var t=[],w=b(this.hex,y.vidx),u=n(w,0),v=0;v<u.length;v++){z=w.substr(u[v],2);x=g(w,u[v]);if("81"===z){A=hextoutf8(x);t.push(["MAIL",A])}if("82"===z){A=hextoutf8(x);t.push(["DNS",A])}if("84"===z){A=X509.hex2dn(x,0);t.push(["DN",A])}if("86"===z){A=hextoutf8(x);t.push(["URI",A])}if("87"===z){A=hextoip(x);t.push(["IP",A])}}return t};this.getExtCRLDistributionPoints=function(x,z){if(x===void 0&&z===void 0){var y=this.getExtInfo("cRLDistributionPoints");if(y===void 0){return}x=b(this.hex,y.vidx);z=y.critical}var u={extname:"cRLDistributionPoints",array:[]};if(z){u.critical=!0}for(var v=n(x,0),w=0,t;w<v.length;w++){t=b(x,v[w]);u.array.push(this.getDistributionPoint(t))}return u};this.getDistributionPoint=function(y){for(var v={},w=n(y,0),x=0;x<w.length;x++){var u=y.substr(w[x],2),t=b(y,w[x]);if("a0"==u){v.dpname=this.getDistributionPointName(t)}}return v};this.getDistributionPointName=function(y){for(var v={},w=n(y,0),x=0;x<w.length;x++){var u=y.substr(w[x],2),t=b(y,w[x]);if("a0"==u){v.full=this.getGeneralNames(t)}}return v};this.getExtCRLDistributionPointsURI=function(){var y=this.getExtInfo("cRLDistributionPoints");if(y===void 0){return y}for(var t=[],u=n(this.hex,y.vidx),w=0;w<u.length;w++){try{var z=c(this.hex,u[w],[0,0,0],"86"),x=hextoutf8(z);t.push(x)}catch(v){}}return t};this.getExtAIAInfo=function(){var x=this.getExtInfo("authorityInfoAccess");if(x===void 0){return x}for(var t={ocsp:[],caissuer:[]},u=n(this.hex,x.vidx),v=0;v<u.length;v++){var y=c(this.hex,u[v],[0],"06"),w=c(this.hex,u[v],[1],"86");if("2b06010505073001"===y){t.ocsp.push(hextoutf8(w))}if("2b06010505073002"===y){t.caissuer.push(hextoutf8(w))}}return t};this.getExtAuthorityInfoAccess=function(A,y){if(A===void 0&&y===void 0){var t=this.getExtInfo("authorityInfoAccess");if(t===void 0){return}A=b(this.hex,t.vidx);y=t.critical}var B={extname:"authorityInfoAccess",array:[]};if(y){B.critical=!0}for(var z=n(A,0),u=0;u<z.length;u++){var x=k(A,z[u],[0],"06"),v=c(A,z[u],[1],"86"),w=hextoutf8(v);if("2b06010505073001"==x){B.array.push({ocsp:w})}else{if("2b06010505073002"==x){B.array.push({caissuer:w})}else{throw new Error("unknown method: "+x)}}}return B};this.getExtCertificatePolicies=function(x,A){if(x===void 0&&A===void 0){var z=this.getExtInfo("certificatePolicies");if(z===void 0){return}x=b(this.hex,z.vidx);A=z.critical}var t={extname:"certificatePolicies",array:[]};if(A){t.critical=!0}for(var u=n(x,0),v=0;v<u.length;v++){var y=b(x,u[v]),w=this.getPolicyInformation(y);t.array.push(w)}return t};this.getPolicyInformation=function(x){var t={},z=c(x,0,[0],"06");t.policyoid=p(z);var A=e(x,0,[1],"30");if(-1!=A){t.array=[];for(var u=n(x,A),v=0;v<u.length;v++){var y=b(x,u[v]),w=this.getPolicyQualifierInfo(y);t.array.push(w)}}return t};this.getPolicyQualifierInfo=function(u){var t={},v=c(u,0,[0],"06");if("2b06010505070201"===v){var x=k(u,0,[1],"16");t.cps=hextorstr(x)}else{if("2b06010505070202"===v){var w=a(u,0,[1],"30");t.unotice=this.getUserNotice(w)}}return t};this.getUserNotice=function(x){for(var u={},v=n(x,0),w=0,t;w<v.length;w++){t=b(x,v[w]);if("30"!=t.substr(0,2)){u.exptext=this.getDisplayText(t)}}return u};this.getDisplayText=function(u){var t={};t.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[u.substr(0,2)];t.str=hextorstr(g(u,0));return t};this.getExtCRLNumber=function(u,v){var t={extname:"cRLNumber"};if(v){t.critical=!0}if("02"==u.substr(0,2)){t.num={hex:g(u,0)};return t}throw new Error("hExtV parse error: "+u)};this.getExtCRLReason=function(u,v){var t={extname:"cRLReason"};if(v){t.critical=!0}if("0a"==u.substr(0,2)){t.code=parseInt(g(u,0),16);return t}throw new Error("hExtV parse error: "+u)};this.getExtOcspNonce=function(u,w){var t={extname:"ocspNonce"};if(w){t.critical=!0}var v=g(u,0);t.hex=v;return t};this.getExtOcspNoCheck=function(u,v){var t={extname:"ocspNoCheck"};if(v){t.critical=!0}return t};this.getExtAdobeTimeStamp=function(w,z){if(w===void 0&&z===void 0){var y=this.getExtInfo("adobeTimeStamp");if(y===void 0){return}w=b(this.hex,y.vidx);z=y.critical}var t={extname:"adobeTimeStamp"};if(z){t.critical=!0}var v=n(w,0);if(1<v.length){var A=b(w,v[1]),u=this.getGeneralName(A);if(u.uri!=void 0){t.uri=u.uri}}if(2<v.length){var x=b(w,v[2]);if("0101ff"==x){t.reqauth=!0}if("010100"==x){t.reqauth=!1}}return t};this.getX500NameRule=function(t){for(var G=null,B=[],w=0,y;w<t.length;w++){y=t[w];for(var v=0;v<y.length;v++){B.push(y[v])}}for(var w=0;w<B.length;w++){var F=B[w],H=F.ds,C=F.value,z=F.type;if("prn"!=H&&"utf8"!=H&&"ia5"!=H){return"mixed"}if("ia5"==H){if("CN"!=z){return"mixed"}else{if(!KJUR.lang.String.isMail(C)){return"mixed"}else{continue}}}if("C"==z){if("prn"==H){continue}else{return"mixed"}}if(null==G){G=H}else{if(G!==H){return"mixed"}}}if(null==G){return"prn"}else{return G}};this.getX500Name=function(v){var t=this.getX500NameArray(v),u=this.dnarraytostr(t);return{array:t,str:u}};this.getX500NameArray=function(w){for(var t=[],u=n(w,0),v=0;v<u.length;v++){t.push(this.getRDN(b(w,u[v])))}return t};this.getRDN=function(w){for(var t=[],u=n(w,0),v=0;v<u.length;v++){t.push(this.getAttrTypeAndValue(b(w,u[v])))}return t};this.getAttrTypeAndValue=function(v){var t={type:null,value:null,ds:null},u=n(v,0),y=c(v,u[0],[],"06"),x=c(v,u[1],[]),w=KJUR.asn1.ASN1Util.oidHexToInt(y);t.type=KJUR.asn1.x509.OID.oid2atype(w);t.ds=this.HEX2STAG[v.substr(u[1],2)];if("bmp"!=t.ds){t.value=hextoutf8(x)}else{t.value=ucs2hextoutf8(x)}return t};this.readCertPEM=function(t){this.readCertHex(pemtohex(t))};this.readCertHex=function(t){this.hex=t;this.getVersion();try{h(this.hex,0,[0,7],"a3");this.parseExt()}catch(u){}};this.getParam=function(){var t={version:this.getVersion(),serial:{hex:this.getSerialNumberHex()},sigalg:this.getSignatureAlgorithmField(),issuer:this.getIssuer(),notbefore:this.getNotBefore(),notafter:this.getNotAfter(),subject:this.getSubject(),sbjpubkey:hextopem(this.getPublicKeyHex(),"PUBLIC KEY")};if(0<this.aExtInfo.length){t.ext=this.getExtParamArray()}t.sighex=this.getSignatureValueHex();return t};this.getExtParamArray=function(u){if(u==void 0){var w=e(this.hex,0,[0,"[3]"]);if(-1!=w){u=l(this.hex,0,[0,"[3]",0],"30")}}for(var t=[],v=n(u,0),x=0;x<v.length;x++){var z=b(u,v[x]),y=this.getExtParam(z);if(null!=y){t.push(y)}}return t};this.getExtParam=function(u){var w=n(u,0),x=w.length;if(2!=x&&3!=x){throw new Error("wrong number elements in Extension: "+x+" "+u)}var v=m(c(u,0,[0],"06")),z=!1;if(3==x&&"0101ff"==a(u,0,[1])){z=!0}var A=a(u,0,[x-1,0]),y=void 0;if("2.5.29.14"==v){y=this.getExtSubjectKeyIdentifier(A,z)}else{if("2.5.29.15"==v){y=this.getExtKeyUsage(A,z)}else{if("2.5.29.17"==v){y=this.getExtSubjectAltName(A,z)}else{if("2.5.29.18"==v){y=this.getExtIssuerAltName(A,z)}else{if("2.5.29.19"==v){y=this.getExtBasicConstraints(A,z)}else{if("2.5.29.31"==v){y=this.getExtCRLDistributionPoints(A,z)}else{if("2.5.29.32"==v){y=this.getExtCertificatePolicies(A,z)}else{if("2.5.29.35"==v){y=this.getExtAuthorityKeyIdentifier(A,z)}else{if("2.5.29.37"==v){y=this.getExtExtKeyUsage(A,z)}else{if("1.3.6.1.5.5.7.1.1"==v){y=this.getExtAuthorityInfoAccess(A,z)}else{if("2.5.29.20"==v){y=this.getExtCRLNumber(A,z)}else{if("2.5.29.21"==v){y=this.getExtCRLReason(A,z)}else{if("1.3.6.1.5.5.7.48.1.2"==v){y=this.getExtOcspNonce(A,z)}else{if("1.3.6.1.5.5.7.48.1.5"==v){y=this.getExtOcspNoCheck(A,z)}else{if("1.2.840.113583.1.1.9.1"==v){y=this.getExtAdobeTimeStamp(A,z)}}}}}}}}}}}}}}}if(y!=void 0){return y}var t={extname:v,extn:A};if(z){t.critical=!0}return t};this.findExt=function(u,v){for(var t=0;t<u.length;t++){if(u[t].extname==v){return u[t]}}return null};this.updateExtCDPFullURI=function(x,t){var w=this.findExt(x,"cRLDistributionPoints");if(null==w){return}if(w.array==void 0){return}for(var z=w.array,v=0;v<z.length;v++){if(z[v].dpname==void 0){continue}if(z[v].dpname.full==void 0){continue}for(var A=z[v].dpname.full,u=0,y;u<A.length;u++){y=A[v];if(y.uri==void 0){continue}y.uri=t}}};this.updateExtAIAOCSP=function(x,u){var w=this.findExt(x,"authorityInfoAccess");if(null==w){return}if(w.array==void 0){return}for(var t=w.array,v=0;v<t.length;v++){if(t[v].ocsp!=void 0){t[v].ocsp=u}}};this.updateExtAIACAIssuer=function(x,u){var w=this.findExt(x,"authorityInfoAccess");if(null==w){return}if(w.array==void 0){return}for(var t=w.array,v=0;v<t.length;v++){if(t[v].caissuer!=void 0){t[v].caissuer=u}}};this.dnarraytostr=function(v){function t(w){return w.map(function(y){return u(y).replace(/\+/,"\\+")}).join("+")}function u(w){return w.type+"="+w.value}return"/"+v.map(function(w){return t(w).replace(/\//,"\\/")}).join("/")};this.getInfo=function(){var u=function(M){var L=JSON.stringify(M.array).replace(/[\[\]\{\}\"]/g,"");return L},A=function(R){for(var P="",L=R.array,O=0,Q;O<L.length;O++){Q=L[O];P+="    policy oid: "+Q.policyoid+"\n";if(Q.array===void 0){continue}for(var N=0,M;N<Q.array.length;N++){M=Q.array[N];if(M.cps!==void 0){P+="    cps: "+M.cps+"\n"}}}return P},D=function(P){for(var O="",L=P.array,N=0,Q;N<L.length;N++){Q=L[N];try{if(Q.dpname.full[0].uri!==void 0){O+="    "+Q.dpname.full[0].uri+"\n"}}catch(M){}try{if(Q.dname.full[0].dn.hex!==void 0){O+="    "+X509.hex2dn(Q.dpname.full[0].dn.hex)+"\n"}}catch(M){}}return O},B=function(P){for(var O="",L=P.array,M=0,N;M<L.length;M++){N=L[M];if(N.caissuer!==void 0){O+="    caissuer: "+N.caissuer+"\n"}if(N.ocsp!==void 0){O+="    ocsp: "+N.ocsp+"\n"}}return O},F,E,K;F="Basic Fields\n";F+="  serial number: "+this.getSerialNumberHex()+"\n";F+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";F+="  issuer: "+this.getIssuerString()+"\n";F+="  notBefore: "+this.getNotBefore()+"\n";F+="  notAfter: "+this.getNotAfter()+"\n";F+="  subject: "+this.getSubjectString()+"\n";F+="  subject public key info: \n";E=this.getPublicKey();F+="    key algorithm: "+E.type+"\n";if("RSA"===E.type){F+="    n="+hextoposhex(E.n.toString(16)).substr(0,16)+"...\n";F+="    e="+hextoposhex(E.e.toString(16))+"\n"}K=this.aExtInfo;if(K!==void 0&&null!==K){F+="X509v3 Extensions:\n";for(var H=0;H<K.length;H++){var J=K[H],t=KJUR.asn1.x509.OID.oid2name(J.oid);if(""===t){t=J.oid}var G="";if(!0===J.critical){G="CRITICAL"}F+="  "+t+" "+G+":\n";if("basicConstraints"===t){var w=this.getExtBasicConstraints();if(w.cA===void 0){F+="    {}\n"}else{F+="    cA=true";if(w.pathLen!==void 0){F+=", pathLen="+w.pathLen}F+="\n"}}else{if("keyUsage"===t){F+="    "+this.getExtKeyUsageString()+"\n"}else{if("subjectKeyIdentifier"===t){F+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n"}else{if("authorityKeyIdentifier"===t){var x=this.getExtAuthorityKeyIdentifier();if(x.kid!==void 0){F+="    kid="+x.kid.hex+"\n"}}else{if("extKeyUsage"===t){var I=this.getExtExtKeyUsage().array;F+="    "+I.join(", ")+"\n"}else{if("subjectAltName"===t){var y=u(this.getExtSubjectAltName());F+="    "+y+"\n"}else{if("cRLDistributionPoints"===t){var C=this.getExtCRLDistributionPoints();F+=D(C)}else{if("authorityInfoAccess"===t){var z=this.getExtAuthorityInfoAccess();F+=B(z)}else{if("certificatePolicies"===t){F+=A(this.getExtCertificatePolicies())}}}}}}}}}}}F+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n";F+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n";return F};if("string"==typeof q){if(-1!=q.indexOf("-----BEGIN")){this.readCertPEM(q)}else{if(KJUR.lang.String.isHex(q)){this.readCertHex(q)}}}}X509.hex2dn=function(e,b){if(b===void 0){b=0}var a=new X509,c=ASN1HEX.getTLV(e,b),d=a.getX500Name(e);return d.str};X509.hex2rdn=function(f,b){if(b===void 0){b=0}if("31"!==f.substr(b,2)){throw new Error("malformed RDN")}for(var c=[],d=ASN1HEX.getChildIdx(f,b),e=0;e<d.length;e++){c.push(X509.hex2attrTypeValue(f,d[e]))}c=c.map(function(a){return a.replace("+","\\+")});return c.join("+")};X509.hex2attrTypeValue=function(d,i){var j=ASN1HEX,h=j.getV;if(i===void 0){i=0}if("30"!==d.substr(i,2)){throw new Error("malformed attribute type and value")}var g=j.getChildIdx(d,i);if(2!==g.length||"06"!==d.substr(g[0],2)){}var b=h(d,g[0]),f=KJUR.asn1.ASN1Util.oidHexToInt(b),e=KJUR.asn1.x509.OID.oid2atype(f),a=h(d,g[1]),c=hextorstr(a);return e+"="+c};X509.getPublicKeyFromCertHex=function(b){var a=new X509;a.readCertHex(b);return a.getPublicKey()};X509.getPublicKeyFromCertPEM=function(b){var a=new X509;a.readCertPEM(b);return a.getPublicKey()};X509.getPublicKeyInfoPropOfCertPEM=function(c){var g=ASN1HEX.getVbyList,b={},a,f;b.algparam=null;a=new X509;a.readCertPEM(c);f=a.getPublicKeyHex();b.keyhex=g(f,0,[1],"03").substr(2);b.algoid=g(f,0,[0,0],"06");if("2a8648ce3d0201"===b.algoid){b.algparam=g(f,0,[0,1],"06")}return b};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var X509CRL=function(e){var a=KJUR,f=a.lang.String.isHex,m=ASN1HEX,k=m.getV,b=m.getTLV,h=m.getVbyList,c=m.getTLVbyList,d=m.getTLVbyListEx,i=m.getIdxbyList,g=m.getIdxbyListEx,l=m.getChildIdx,j=new X509;this.hex=null;this.posSigAlg=null;this.posRevCert=null;this._setPos=function(){var o=i(this.hex,0,[0,0]),n=this.hex.substr(o,2);if("02"==n){this.posSigAlg=1}else{if("30"==n){this.posSigAlg=0}else{throw new Error("malformed 1st item of TBSCertList: "+n)}}var s=i(this.hex,0,[0,this.posSigAlg+3]),r=this.hex.substr(s,2);if("17"==r||"18"==r){var q,p;q=i(this.hex,0,[0,this.posSigAlg+4]);this.posRevCert=null;if(-1!=q){p=this.hex.substr(q,2);if("30"==p){this.posRevCert=this.posSigAlg+4}}}else{if("30"==r){this.posRevCert=this.posSigAlg+3}else{if("a0"==r){this.posRevCert=null}else{throw new Error("malformed nextUpdate or revCert tag: "+r)}}}};this.getVersion=function(){if(0==this.posSigAlg){return null}return parseInt(h(this.hex,0,[0,0],"02"),16)+1};this.getSignatureAlgorithmField=function(){var n=c(this.hex,0,[0,this.posSigAlg],"30");return j.getAlgorithmIdentifierName(n)};this.getIssuer=function(){var n=c(this.hex,0,[0,this.posSigAlg+1],"30");return j.getX500Name(n)};this.getThisUpdate=function(){var n=h(this.hex,0,[0,this.posSigAlg+2]);return result=hextorstr(n)};this.getNextUpdate=function(){var o=i(this.hex,0,[0,this.posSigAlg+3]),n=this.hex.substr(o,2);if("17"!=n&&"18"!=n){return null}return hextorstr(k(this.hex,o))};this.getRevCertArray=function(){if(null==this.posRevCert){return null}for(var o=[],n=i(this.hex,0,[0,this.posRevCert]),p=l(this.hex,n),q=0,r;q<p.length;q++){r=b(this.hex,p[q]);o.push(this.getRevCert(r))}return o};this.getRevCert=function(p){var o={},n=l(p,0);o.sn={hex:h(p,0,[0],"02")};o.date=hextorstr(h(p,0,[1]));if(3==n.length){o.ext=j.getExtParamArray(c(p,0,[2]))}return o};this.getSignatureValueHex=function(){return h(this.hex,0,[2],"03",!0)};this.verifySignature=function(o){var p=this.getSignatureAlgorithmField(),n=this.getSignatureValueHex(),q=c(this.hex,0,[0],"30"),r=new KJUR.crypto.Signature({alg:p});r.init(o);r.updateHex(q);return r.verify(n)};this.getParam=function(){var n={},p=this.getVersion();if(null!=p){n.version=p}n.sigalg=this.getSignatureAlgorithmField();n.issuer=this.getIssuer();n.thisupdate=this.getThisUpdate();var q=this.getNextUpdate();if(null!=q){n.nextupdate=q}var s=this.getRevCertArray();if(null!=s){n.revcert=s}var r=g(this.hex,0,[0,"[0]"]);if(-1!=r){var o=d(this.hex,0,[0,"[0]",0]);n.ext=j.getExtParamArray(o)}n.sighex=this.getSignatureValueHex();return n};if("string"==typeof e){if(f(e)){this.hex=e}else{if(e.match(/-----BEGIN X509 CRL/)){this.hex=pemtohex(e)}}this._setPos()}};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.jws||!KJUR.jws){KJUR.jws={}}KJUR.jws.JWS=function(){var b=KJUR,a=b.jws.JWS,c=a.isSafeJSONString;this.parseJWS=function(g,j){if(this.parsedJWS!==void 0&&(j||this.parsedJWS.sigvalH!==void 0)){return}var i=g.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==i){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}var k=i[1],e=i[2],l=i[3];this.parsedJWS={};this.parsedJWS.headB64U=k;this.parsedJWS.payloadB64U=e;this.parsedJWS.sigvalB64U=l;this.parsedJWS.si=k+"."+e;if(!j){var h=b64utohex(l),f=parseBigInt(h,16);this.parsedJWS.sigvalH=h;this.parsedJWS.sigvalBI=f}var d=b64utoutf8(k),m=b64utoutf8(e);this.parsedJWS.headS=d;this.parsedJWS.payloadS=m;if(!c(d,this.parsedJWS,"headP")){throw"malformed JSON string for JWS Head: "+d}}};KJUR.jws.JWS.sign=function(j,w,z,A,a){var x=KJUR,n=x.jws,r=n.JWS,h=r.readSafeJSONString,q=r.isSafeJSONString,d=x.crypto,l=d.ECDSA,p=d.Mac,c=d.Signature,u=JSON,t,k,o;if("string"!=typeof w&&"object"!=typeof w){throw"spHeader must be JSON string or object: "+w}if("object"==typeof w){k=w;t=u.stringify(k)}if("string"==typeof w){t=w;if(!q(t)){throw"JWS Head is not safe JSON string: "+t}k=h(t)}o=z;if("object"==typeof z){o=u.stringify(z)}if((""==j||null==j)&&k.alg!==void 0){j=k.alg}if(""!=j&&null!=j&&k.alg===void 0){k.alg=j;t=u.stringify(k)}if(j!==k.alg){throw"alg and sHeader.alg doesn't match: "+j+"!="+k.alg}var s=null;if(r.jwsalg2sigalg[j]===void 0){throw"unsupported alg name: "+j}else{s=r.jwsalg2sigalg[j]}var e=utf8tob64u(t),m=utf8tob64u(o),b=e+"."+m,y="";if("Hmac"==s.substr(0,4)){if(A===void 0){throw"mac key shall be specified for HS* alg"}var i=new p({alg:s,prov:"cryptojs",pass:A});i.updateString(b);y=i.doFinal()}else{if(-1!=s.indexOf("withECDSA")){var f=new c({alg:s});f.init(A,a);f.updateString(b);var g=f.sign();y=KJUR.crypto.ECDSA.asn1SigToConcatSig(g)}else{if("none"!=s){var f=new c({alg:s});f.init(A,a);f.updateString(b);y=f.sign()}}}var v=hextob64u(y);return b+"."+v};KJUR.jws.JWS.verify=function(w,B,n){var x=KJUR,q=x.jws,t=q.JWS,i=t.readSafeJSONString,e=x.crypto,p=e.ECDSA,s=e.Mac,d=e.Signature,m;if(typeof RSAKey!==void 0){m=RSAKey}var y=w.split(".");if(3!==y.length){return!1}var f=y[0],r=y[1],c=f+"."+r,A=b64utohex(y[2]),l=i(b64utoutf8(y[0])),k=null,z=null;if(l.alg===void 0){throw"algorithm not specified in header"}else{k=l.alg;z=k.substr(0,2)}if(null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&0<n.length){var b=":"+n.join(":")+":";if(-1==b.indexOf(":"+k+":")){throw"algorithm '"+k+"' not accepted in the list"}}if("none"!=k&&null===B){throw"key shall be specified to verify."}if("string"==typeof B&&-1!=B.indexOf("-----BEGIN ")){B=KEYUTIL.getKey(B)}if("RS"==z||"PS"==z){if(!(B instanceof m)){throw"key shall be a RSAKey obj for RS* and PS* algs"}}if("ES"==z){if(!(B instanceof p)){throw"key shall be a ECDSA obj for ES* algs"}}if("none"==k){}var u=null;if(t.jwsalg2sigalg[l.alg]===void 0){throw"unsupported alg name: "+k}else{u=t.jwsalg2sigalg[k]}if("none"==u){throw"not supported"}else{if("Hmac"==u.substr(0,4)){var o=null;if(B===void 0){throw"hexadecimal key shall be specified for HMAC"}var j=new s({alg:u,pass:B});j.updateString(c);o=j.doFinal();return A==o}else{if(-1!=u.indexOf("withECDSA")){var h=null;try{h=p.concatSigToASN1Sig(A)}catch(v){return!1}var g=new d({alg:u});g.init(B);g.updateString(c);return g.verify(h)}else{var g=new d({alg:u});g.init(B);g.updateString(c);return g.verify(A)}}}};KJUR.jws.JWS.parse=function(g){var c=g.split("."),b={},f,e,d;if(2!=c.length&&3!=c.length){throw"malformed sJWS: wrong number of '.' splitted elements"}f=c[0];e=c[1];if(3==c.length){d=c[2]}b.headerObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(f));b.payloadObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(e));b.headerPP=JSON.stringify(b.headerObj,null,"  ");if(null==b.payloadObj){b.payloadPP=b64utoutf8(e)}else{b.payloadPP=JSON.stringify(b.payloadObj,null,"  ")}if(d!==void 0){b.sigHex=b64utohex(d)}return b};KJUR.jws.JWS.verifyJWT=function(e,l,r){var d=KJUR,j=d.jws,o=j.JWS,n=o.readSafeJSONString,p=o.inArray,f=o.includedArray,k=e.split("."),c=k[0],i=k[1],m=b64utohex(k[2]),h=n(b64utoutf8(c)),g=n(b64utoutf8(i));if(h.alg===void 0){return!1}if(r.alg===void 0){throw"acceptField.alg shall be specified"}if(!p(h.alg,r.alg)){return!1}if(g.iss!==void 0&&"object"===typeof r.iss){if(!p(g.iss,r.iss)){return!1}}if(g.sub!==void 0&&"object"===typeof r.sub){if(!p(g.sub,r.sub)){return!1}}if(g.aud!==void 0&&"object"===typeof r.aud){if("string"==typeof g.aud){if(!p(g.aud,r.aud)){return!1}}else{if("object"==typeof g.aud){if(!f(g.aud,r.aud)){return!1}}}}var b=j.IntDate.getNow();if(r.verifyAt!==void 0&&"number"===typeof r.verifyAt){b=r.verifyAt}if(r.gracePeriod===void 0||"number"!==typeof r.gracePeriod){r.gracePeriod=0}if(g.exp!==void 0&&"number"==typeof g.exp){if(g.exp+r.gracePeriod<b){return!1}}if(g.nbf!==void 0&&"number"==typeof g.nbf){if(b<g.nbf-r.gracePeriod){return!1}}if(g.iat!==void 0&&"number"==typeof g.iat){if(b<g.iat-r.gracePeriod){return!1}}if(g.jti!==void 0&&r.jti!==void 0){if(g.jti!==r.jti){return!1}}if(!o.verify(e,l,r.alg)){return!1}return!0};KJUR.jws.JWS.includedArray=function(b,a){var c=KJUR.jws.JWS.inArray;if(null===b){return!1}if("object"!==typeof b){return!1}if("number"!==typeof b.length){return!1}for(var d=0;d<b.length;d++){if(!c(b[d],a)){return!1}}return!0};KJUR.jws.JWS.inArray=function(d,b){if(null===b){return!1}if("object"!==typeof b){return!1}if("number"!==typeof b.length){return!1}for(var c=0;c<b.length;c++){if(b[c]==d){return!0}}return!1};KJUR.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};KJUR.jws.JWS.isSafeJSONString=function(c,b,d){var e=null;try{e=jsonParse(c);if("object"!=typeof e){return 0}if(e.constructor===Array){return 0}if(b){b[d]=e}return 1}catch(a){return 0}};KJUR.jws.JWS.readSafeJSONString=function(b){var c=null;try{c=jsonParse(b);if("object"!=typeof c){return null}if(c.constructor===Array){return null}return c}catch(a){return null}};KJUR.jws.JWS.getEncodedSignatureValueFromJWS=function(b){var a=b.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==a){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}return a[1]};KJUR.jws.JWS.getJWKthumbprint=function(d){if("RSA"!==d.kty&&"EC"!==d.kty&&"oct"!==d.kty){throw"unsupported algorithm for JWK Thumprint"}var a="{";if("RSA"===d.kty){if("string"!=typeof d.n||"string"!=typeof d.e){throw"wrong n and e value for RSA key"}a+="\"e\":\""+d.e+"\",";a+="\"kty\":\""+d.kty+"\",";a+="\"n\":\""+d.n+"\"}"}else{if("EC"===d.kty){if("string"!=typeof d.crv||"string"!=typeof d.x||"string"!=typeof d.y){throw"wrong crv, x and y value for EC key"}a+="\"crv\":\""+d.crv+"\",";a+="\"kty\":\""+d.kty+"\",";a+="\"x\":\""+d.x+"\",";a+="\"y\":\""+d.y+"\"}"}else{if("oct"===d.kty){if("string"!=typeof d.k){throw"wrong k value for oct(symmetric) key"}a+="\"kty\":\""+d.kty+"\",";a+="\"k\":\""+d.k+"\"}"}}}var b=rstrtohex(a),c=KJUR.crypto.Util.hashHex(b,"sha256"),e=hextob64u(c);return e};KJUR.jws.IntDate={};KJUR.jws.IntDate.get=function(c){var b=KJUR.jws.IntDate,d=b.getNow,a=b.getZulu;if("now"==c){return d()}else{if("now + 1hour"==c){return d()+60*60}else{if("now + 1day"==c){return d()+24*(60*60)}else{if("now + 1month"==c){return d()+30*(24*(60*60))}else{if("now + 1year"==c){return d()+365*(24*(60*60))}else{if(c.match(/Z$/)){return a(c)}else{if(c.match(/^[0-9]+$/)){return parseInt(c)}}}}}}}throw"unsupported format: "+c};KJUR.jws.IntDate.getZulu=function(a){return zulutosec(a)};KJUR.jws.IntDate.getNow=function(){var a=~~(new Date/1e3);return a};KJUR.jws.IntDate.intDate2UTCString=function(a){var b=new Date(1e3*a);return b.toUTCString()};KJUR.jws.IntDate.intDate2Zulu=function(e){var i=new Date(1e3*e),h=("0000"+i.getUTCFullYear()).slice(-4),g=("00"+(i.getUTCMonth()+1)).slice(-2),b=("00"+i.getUTCDate()).slice(-2),a=("00"+i.getUTCHours()).slice(-2),c=("00"+i.getUTCMinutes()).slice(-2),f=("00"+i.getUTCSeconds()).slice(-2);return h+g+b+a+c+f+"Z"};if("undefined"==typeof KJUR||!KJUR){KJUR={}}if("undefined"==typeof KJUR.jws||!KJUR.jws){KJUR.jws={}}KJUR.jws.JWSJS=function(){var c=KJUR,b=c.jws,a=b.JWS,d=a.readSafeJSONString;this.aHeader=[];this.sPayload="";this.aSignature=[];this.init=function(){this.aHeader=[];this.sPayload=void 0;this.aSignature=[]};this.initWithJWS=function(f){this.init();var e=f.split(".");if(3!=e.length){throw"malformed input JWS"}this.aHeader.push(e[0]);this.sPayload=e[1];this.aSignature.push(e[2])};this.addSignature=function(e,h,m,k){if(this.sPayload===void 0||null===this.sPayload){throw"there's no JSON-JS signature to add."}var l=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length){throw"aHeader.length != aSignature.length"}try{var f=KJUR.jws.JWS.sign(e,h,this.sPayload,m,k),j=f.split("."),n=j[0],g=j[2];this.aHeader.push(j[0]);this.aSignature.push(j[2])}catch(i){if(this.aHeader.length>l){this.aHeader.pop()}if(this.aSignature.length>l){this.aSignature.pop()}throw"addSignature failed: "+i}};this.verifyAll=function(h){if(this.aHeader.length!==h.length||this.aSignature.length!==h.length){return!1}for(var g=0,f;g<h.length;g++){f=h[g];if(2!==f.length){return!1}var e=this.verifyNth(g,f[0],f[1]);if(!1===e){return!1}}return!0};this.verifyNth=function(f,j,g){if(this.aHeader.length<=f||this.aSignature.length<=f){return!1}var h=this.aHeader[f],k=this.aSignature[f],l=h+"."+this.sPayload+"."+k,e=!1;try{e=a.verify(l,j,g)}catch(i){return!1}return e};this.readJWSJS=function(g){if("string"===typeof g){var f=d(g);if(null==f){throw"argument is not safe JSON object string"}this.aHeader=f.headers;this.sPayload=f.payload;this.aSignature=f.signatures}else{try{if(0<g.headers.length){this.aHeader=g.headers}else{throw"malformed header"}if("string"===typeof g.payload){this.sPayload=g.payload}else{throw"malformed signatures"}if(0<g.signatures.length){this.aSignature=g.signatures}else{throw"malformed signatures"}}catch(e){throw"malformed JWS-JS JSON object: "+e}}};this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}};this.isEmpty=function(){if(0==this.aHeader.length){return 1}return 0}};